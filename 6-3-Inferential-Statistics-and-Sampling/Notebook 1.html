

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Inferential Statistics &amp; Sampling &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '6-3-Inferential-Statistics-and-Sampling/Notebook 1';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Exploratory Data Analysis Basics" href="../7-Exploratory-Data-Analysis-EDA/Notebook%201.html" />
    <link rel="prev" title="Distribuciones de Probabilidad" href="../6-2-Probabilidad/Notebook%201.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Libraries for data manipulation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../1-Numpy/1_Numpy.html">Numpy</a></li>






<li class="toctree-l1"><a class="reference internal" href="../2-Pandas/2_Pandas.html">Pandas</a></li>












<li class="toctree-l1"><a class="reference internal" href="../3-Matplotlib/3_Matplotlib.html">Matplotlib</a></li>








<li class="toctree-l1"><a class="reference internal" href="../4-Seaborn/Notebook%201.html">Seaborn</a></li>










</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Math and Statistics Fundamentals</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../5-Mathematical-Functions-for-data-science/Notebook%201.html">Mathematical functions for data science &amp; artificial intelligence</a></li>





<li class="toctree-l1"><a class="reference internal" href="../6-Statistics-For-Data-Science/Estadistica%20descriptiva.html">Intro to Statistics for Data Science</a></li>






<li class="toctree-l1"><a class="reference internal" href="../6-1-Algebra-Lineal-aplicada-a-Machine-Learning/contenido.html"></a></li>









<li class="toctree-l1"><a class="reference internal" href="../6-2-Probabilidad/Notebook%201.html">Distribuciones de Probabilidad</a></li>




<li class="toctree-l1 current active"><a class="current reference internal" href="#">Inferential Statistics &amp; Sampling</a></li>













</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exploratory Data Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../7-Exploratory-Data-Analysis-EDA/Notebook%201.html">Exploratory Data Analysis Basics</a></li>


<li class="toctree-l1"><a class="reference internal" href="../8-Deteccion-de-valores-faltantes/live-exploration-missing-values.html">Manejo de Datos Faltantes: Detección</a></li>

<li class="toctree-l1"><a class="reference internal" href="../8-1-Imputacion-de-datos-faltantes/live-imputation-missing-values.html">Manejo de Datos Faltantes: Imputación</a></li>

<li class="toctree-l1"><a class="reference internal" href="../8-0-1-pandas-missing-extension/pandas-missing-extension.html">Extensión de la API de Pandas</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F6-3-Inferential-Statistics-and-Sampling/Notebook 1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/6-3-Inferential-Statistics-and-Sampling/Notebook 1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Inferential Statistics & Sampling</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Inferential Statistics &amp; Sampling</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling">Sampling</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#database-to-work">Database to work</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#types-of-sampling">Types of sampling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-random-sampling">Simple random sampling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#systematic-sampling">Systematic sampling</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#samples-equally-distanced">Samples equally distanced</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stratified-sampling">Stratified sampling</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#proportional-stratified-sample">Proportional stratified sample</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#equal-count-stratified-sampling">Equal count stratified sampling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#weighted-random-sampling">Weighted random sampling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#proportional-stratified-sample-given-a-proportion">Proportional stratified sample (given a proportion)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-sampling">Cluster sampling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-calculate-mean-per-categories">Bonus: Calculate mean per categories</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relative-error">Relative error</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-relative-error">Calculate relative error</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relative-error-vs-sample-size">Relative error vs sample size</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distribution">Sampling distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#approximating-sampling-distributions">Approximating sampling distributions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapping">Bootstrapping</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concept">Concept</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#actually-bootstrapping">Actually Bootstrapping</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-statistics-to-estimate-population-parameters">Bootstrap statistics to estimate population parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean">Mean</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-deviation">Standard Deviation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapping-vs-sampling-distribution-to-estimate-the-mean">Bootstrapping vs sampling distribution to estimate the mean</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-random-sample">simple random sample</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">sampling distribution</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-distribution">bootstrap distribution</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals">Confidence intervals</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantile-method-for-confidence-intervals">Quantile method for confidence intervals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-error-method-for-confidence-intervals">standard error method for confidence intervals</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hypotesis-testing">Hypotesis testing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Concept</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions">Assumptions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sanity-check">Sanity check</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-test-mean">Hypothesis test (mean)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-to-perform-hypothesis-testing">Steps to perform hypothesis testing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-null-hypothesis-and-alternative-hypothesis">1. Define the null hypothesis and alternative hypothesis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-z-score">2. Calculate the Z-score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-p-value">3. Calculate the P-value</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#finally-if-the-p-value-is-less-than-0-05-for-a-0-05-significance-level-you-can-reject-the-null-hypothesis-otherwise-you-fail-to-reject-the-null-hypothesis"><em><strong>Finally, if the p-value is less than 0.05 (for a 0.05 significance level), you can reject the null hypothesis. Otherwise, you fail to reject the null hypothesis</strong></em></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example1-two-tailed-test">Example1.  TWO TAILED TEST</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#context">context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-z-score">Calculating Z-score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-p-value">Calculating P-value</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example2-right-tailed-test">Example2. RIGHT TAILED TEST</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Calculating Z score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Calculating P-value</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-right-tailed-test">Example 3: RIGHT TAILED TEST</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Calculating Z score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Calculating P-value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confirming-the-results-with-a-confidence-interval">Confirming the results with a confidence interval</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-test-difference-of-means">Hypothesis test (difference of means)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-for-sample-size">Assumptions for sample size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-difference-of-means-right-tailed">Example 1. Difference of means (right tailed)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-t-statistic">Calculating T statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Calculating P value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-with-pengouin">Solving with pengouin</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-difference-of-means-left-tailed">Example 2. Difference of means (left tailed)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Calculating T statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Calculating P-value</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-testing-paired-data">Hypothesis testing (paired data)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Assumptions for sample size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-difference-of-means-left-tailed">Example 1. Difference of means (left tailed)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Calculating T statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Calculating P value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-with-pingouin">solving with pingouin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pingouin-variation-of-t-test-for-paired-data">pingouin variation of t-test for paired data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-difference-of-means-two-tailed">Example 2. Difference of means (two-tailed)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Solving with pingouin</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-test-anova">Hypothesis test (ANOVA)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Assumptions for sample size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-use-anova">When to use ANOVA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pingouin-anova-method">pingouin.anova() method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pairwise-tests">pairwise tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#false-positive-danger">false positive danger</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#p-value-adjustment-bonferroni">p -value adjustment (bonferroni)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-anova-three-categories">Example 2 ANOVA (three categories)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-sample-size-assumptions">Checking sample size assumptions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis-per-group">Exploratory Data Analysis per Group</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conducting-anova">Conducting ANOVA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Pairwise tests</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">P-value adjustment (bonferroni)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-test-tests-for-proportions">Hypothesis test (tests for proportions)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">Assumptions for sample size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-two-tailed-test">Example 1 (two-tailed test)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-z-score">Calculate z score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">Calculating p-value</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-right-tailed-test">Example 2 (right tailed test)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-for-sample-size-assumptions">Checking for sample size assumptions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">Calculating z-score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">Calculating p-value</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-test-tests-for-differences-of-proportions">Hypothesis test (tests for differences of proportions)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">Assumptions for sample size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-two-tailed">Example 1 (two-tailed)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">Context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-z-score">Calculating the Z score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">Calculating p-value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-with-statsmodels">Calculating with statsmodels</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-right-tailed">Example 2 (right tailed)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">Context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">Calculating Z score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">Calculating p value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-with-statmodels">Calculating with statmodels</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-squared-tests-of-independance">Chi Squared Tests of independance</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id34">Assumptions for sample size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1">Example 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2">Example 2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3">Example 3</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-sample-size-assumption">Checking sample size assumption</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-variable-independance">Exploring variable independance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performing-chi-squared-test">Performing chi squared test</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-squared-goodness-of-fit-tests">Chi squared goodness of fit tests</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id35">Example 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id36">Example 2</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#non-parametric-tests">NON Parametric tests</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wilcoxon-signed-rank-test-paired-data">Wilcoxon-signed rank test  (Paired data)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wicoxon-test-process">Wicoxon test process</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pingouin-wilcoxon">pingouin.wilcoxon</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wilcoxon-mann-whitney-test-independent-data">Wilcoxon-Mann-Whitney test (Independent data)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kruskal-wallis-test">Kruskal-Wallis test</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="inferential-statistics-sampling">
<h1>Inferential Statistics &amp; Sampling<a class="headerlink" href="#inferential-statistics-sampling" title="Permalink to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="sampling">
<h1>Sampling<a class="headerlink" href="#sampling" title="Permalink to this heading">#</a></h1>
<p>Samples are extracted from the population and must meet two requirements:</p>
<ul class="simple">
<li><p><em>Must be statistically significant (big enough to take conclusion)</em></p></li>
<li><p><em>not biased</em></p></li>
</ul>
<p>There are 3 types of sampling:</p>
<ul class="simple">
<li><p>simple random sampling</p></li>
<li><p>systematic sampling</p></li>
<li><p>stratified sampling</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>^C
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting pingouin==0.5.3 (from -r requirements.txt (line 1))
  Using cached pingouin-0.5.3-py3-none-any.whl (198 kB)
Requirement already satisfied: numpy&gt;=1.19 in c:\users\admin\miniconda3\lib\site-packages (from pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (1.25.2)
Requirement already satisfied: scipy&gt;=1.7 in c:\users\admin\miniconda3\lib\site-packages (from pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (1.11.2)
Requirement already satisfied: pandas&gt;=1.0 in c:\users\admin\miniconda3\lib\site-packages (from pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (2.1.0)
Collecting matplotlib&gt;=3.0.2 (from pingouin==0.5.3-&gt;-r requirements.txt (line 1))
  Using cached matplotlib-3.7.2-cp311-cp311-win_amd64.whl (7.5 MB)
Collecting seaborn&gt;=0.11 (from pingouin==0.5.3-&gt;-r requirements.txt (line 1))
  Using cached seaborn-0.12.2-py3-none-any.whl (293 kB)
Collecting statsmodels&gt;=0.13 (from pingouin==0.5.3-&gt;-r requirements.txt (line 1))
  Using cached statsmodels-0.14.0-cp311-cp311-win_amd64.whl (9.2 MB)
Requirement already satisfied: scikit-learn in c:\users\admin\miniconda3\lib\site-packages (from pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (1.3.0)
Collecting pandas-flavor&gt;=0.2.0 (from pingouin==0.5.3-&gt;-r requirements.txt (line 1))
  Using cached pandas_flavor-0.6.0-py3-none-any.whl (7.2 kB)
Collecting outdated (from pingouin==0.5.3-&gt;-r requirements.txt (line 1))
  Using cached outdated-0.2.2-py2.py3-none-any.whl (7.5 kB)
Requirement already satisfied: tabulate in c:\users\admin\miniconda3\lib\site-packages (from pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (0.9.0)
Requirement already satisfied: contourpy&gt;=1.0.1 in c:\users\admin\miniconda3\lib\site-packages (from matplotlib&gt;=3.0.2-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (1.1.0)
Requirement already satisfied: cycler&gt;=0.10 in c:\users\admin\miniconda3\lib\site-packages (from matplotlib&gt;=3.0.2-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (0.11.0)
Requirement already satisfied: fonttools&gt;=4.22.0 in c:\users\admin\miniconda3\lib\site-packages (from matplotlib&gt;=3.0.2-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (4.42.1)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in c:\users\admin\miniconda3\lib\site-packages (from matplotlib&gt;=3.0.2-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (1.4.5)
Requirement already satisfied: packaging&gt;=20.0 in c:\users\admin\miniconda3\lib\site-packages (from matplotlib&gt;=3.0.2-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (23.0)
Requirement already satisfied: pillow&gt;=6.2.0 in c:\users\admin\miniconda3\lib\site-packages (from matplotlib&gt;=3.0.2-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (10.0.0)
Requirement already satisfied: pyparsing&lt;3.1,&gt;=2.3.1 in c:\users\admin\miniconda3\lib\site-packages (from matplotlib&gt;=3.0.2-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (3.0.9)
Requirement already satisfied: python-dateutil&gt;=2.7 in c:\users\admin\miniconda3\lib\site-packages (from matplotlib&gt;=3.0.2-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in c:\users\admin\miniconda3\lib\site-packages (from pandas&gt;=1.0-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (2023.3.post1)
Requirement already satisfied: tzdata&gt;=2022.1 in c:\users\admin\miniconda3\lib\site-packages (from pandas&gt;=1.0-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (2023.3)
Collecting xarray (from pandas-flavor&gt;=0.2.0-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1))
  Using cached xarray-2023.8.0-py3-none-any.whl (1.0 MB)
Requirement already satisfied: patsy&gt;=0.5.2 in c:\users\admin\miniconda3\lib\site-packages (from statsmodels&gt;=0.13-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (0.5.3)
Requirement already satisfied: setuptools&gt;=44 in c:\users\admin\miniconda3\lib\site-packages (from outdated-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (67.8.0)
Requirement already satisfied: littleutils in c:\users\admin\miniconda3\lib\site-packages (from outdated-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (0.2.2)
Requirement already satisfied: requests in c:\users\admin\miniconda3\lib\site-packages (from outdated-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (2.29.0)
Requirement already satisfied: joblib&gt;=1.1.1 in c:\users\admin\miniconda3\lib\site-packages (from scikit-learn-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (1.3.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in c:\users\admin\miniconda3\lib\site-packages (from scikit-learn-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (3.2.0)
Requirement already satisfied: six in c:\users\admin\miniconda3\lib\site-packages (from patsy&gt;=0.5.2-&gt;statsmodels&gt;=0.13-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (1.16.0)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in c:\users\admin\miniconda3\lib\site-packages (from requests-&gt;outdated-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (2.0.4)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in c:\users\admin\miniconda3\lib\site-packages (from requests-&gt;outdated-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (3.4)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in c:\users\admin\miniconda3\lib\site-packages (from requests-&gt;outdated-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (1.26.16)
Requirement already satisfied: certifi&gt;=2017.4.17 in c:\users\admin\miniconda3\lib\site-packages (from requests-&gt;outdated-&gt;pingouin==0.5.3-&gt;-r requirements.txt (line 1)) (2023.5.7)
Installing collected packages: outdated, matplotlib, xarray, statsmodels, seaborn, pandas-flavor, pingouin
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="kn">import</span> <span class="nn">pingouin</span>
</pre></div>
</div>
</div>
</div>
<section id="database-to-work">
<h2>Database to work<a class="headerlink" href="#database-to-work" title="Permalink to this heading">#</a></h2>
<p>Database of the mexican government, contains information about hotels, museums and marketplaces at “El centro historico de la Ciudad de Mexico”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">econdata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;econdata.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">econdata</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>geo_point_2d</th>
      <th>geo_shape</th>
      <th>clave_cat</th>
      <th>delegacion</th>
      <th>perimetro</th>
      <th>tipo</th>
      <th>nom_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>19.424781053,-99.1327537959</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1332...</td>
      <td>307_130_11</td>
      <td>Cuauhtémoc</td>
      <td>B</td>
      <td>Mercado</td>
      <td>Pino Suárez</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>19.4346139576,-99.1413808393</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_008_01</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Museo</td>
      <td>Museo Nacional de Arquitectura Palacio de Bell...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>19.4340695945,-99.1306348409</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>006_002_12</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Museo</td>
      <td>Santa Teresa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>19.42489472,-99.12073393</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>323_102_06</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Balbuena</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>19.42358238,-99.12451093</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>323_115_12</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Hotel</td>
      <td>real</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="types-of-sampling">
<h2>Types of sampling<a class="headerlink" href="#types-of-sampling" title="Permalink to this heading">#</a></h2>
<section id="simple-random-sampling">
<h3>Simple random sampling<a class="headerlink" href="#simple-random-sampling" title="Permalink to this heading">#</a></h3>
<p>This technique consists of just extracting completely random samples</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rand1</span> <span class="o">=</span> <span class="n">econdata</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">rand1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>geo_point_2d</th>
      <th>geo_shape</th>
      <th>clave_cat</th>
      <th>delegacion</th>
      <th>perimetro</th>
      <th>tipo</th>
      <th>nom_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>30</th>
      <td>30</td>
      <td>19.427530818,-99.1479200065</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_068_13</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Villa Pal</td>
    </tr>
    <tr>
      <th>103</th>
      <td>103</td>
      <td>19.4370810464,-99.1361494106</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>004_091_27</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Cuba</td>
    </tr>
    <tr>
      <th>145</th>
      <td>145</td>
      <td>19.4340221684,-99.1358187396</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>001_012_11</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Rioja</td>
    </tr>
    <tr>
      <th>65</th>
      <td>65</td>
      <td>19.425466805,-99.1380880561</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>001_073_20</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Mar</td>
    </tr>
    <tr>
      <th>125</th>
      <td>125</td>
      <td>19.4342350395,-99.1354548065</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>001_007_06</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Zamora</td>
    </tr>
    <tr>
      <th>25</th>
      <td>25</td>
      <td>19.42477346,-99.12881894</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>307_123_30</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Madrid</td>
    </tr>
    <tr>
      <th>111</th>
      <td>111</td>
      <td>19.4430614318,-99.1353793874</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>004_107_02</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Embajadores</td>
    </tr>
    <tr>
      <th>59</th>
      <td>59</td>
      <td>19.4275850427,-99.1397624613</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>001_061_03</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Señorial</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can do it by specifying a seed</p>
<p>Example:</p>
<p>set a seed: 18900217</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rand2</span> <span class="o">=</span> <span class="n">econdata</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">18900217</span><span class="p">)</span>
<span class="n">rand2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>geo_point_2d</th>
      <th>geo_shape</th>
      <th>clave_cat</th>
      <th>delegacion</th>
      <th>perimetro</th>
      <th>tipo</th>
      <th>nom_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>69</th>
      <td>69</td>
      <td>19.43558625,-99.12965746</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>005_129_08</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Templo Mayor</td>
    </tr>
    <tr>
      <th>180</th>
      <td>180</td>
      <td>19.4357633849,-99.1330511805</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>004_094_32</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Catedral, S.A. DE C.V.</td>
    </tr>
    <tr>
      <th>25</th>
      <td>25</td>
      <td>19.42477346,-99.12881894</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>307_123_30</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Madrid</td>
    </tr>
    <tr>
      <th>83</th>
      <td>83</td>
      <td>19.4342251093,-99.1449434443</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_018_03</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>San Francisco</td>
    </tr>
    <tr>
      <th>27</th>
      <td>27</td>
      <td>19.4348360773,-99.1463945583</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_016_01</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Hilton Centro Histórico</td>
    </tr>
    <tr>
      <th>181</th>
      <td>181</td>
      <td>19.4451852396,-99.1478597989</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>012_103_01</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Yale</td>
    </tr>
    <tr>
      <th>117</th>
      <td>117</td>
      <td>19.4253041176,-99.1405962735</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>001_078_03</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Mazatlán</td>
    </tr>
    <tr>
      <th>182</th>
      <td>182</td>
      <td>19.42407591,-99.1424737531</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>001_094_26</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Macao</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract a random 25% of your population</span>

<span class="n">prop_25</span> <span class="o">=</span> <span class="n">econdata</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span> <span class="o">=</span> <span class="mf">.25</span><span class="p">)</span>
<span class="n">prop_25</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>geo_point_2d</th>
      <th>geo_shape</th>
      <th>clave_cat</th>
      <th>delegacion</th>
      <th>perimetro</th>
      <th>tipo</th>
      <th>nom_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>61</th>
      <td>61</td>
      <td>19.4343847692,-99.125125489</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1257...</td>
      <td>005_140_01</td>
      <td>Cuauhtémoc</td>
      <td>B</td>
      <td>Mercado</td>
      <td>Mixcalco</td>
    </tr>
    <tr>
      <th>138</th>
      <td>138</td>
      <td>19.4330991176,-99.1423784309</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_024_08</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Marlowe</td>
    </tr>
    <tr>
      <th>33</th>
      <td>33</td>
      <td>19.4341938751,-99.1352210651</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>001_007_04</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Washingtonw</td>
    </tr>
    <tr>
      <th>178</th>
      <td>178</td>
      <td>19.4457531395,-99.1485982115</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>012_069_11</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Norte</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>19.42489472,-99.12073393</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>323_102_06</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Balbuena</td>
    </tr>
    <tr>
      <th>161</th>
      <td>161</td>
      <td>19.4356652812,-99.1386591361</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>001_003_12</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Museo</td>
      <td>La Tortura</td>
    </tr>
    <tr>
      <th>190</th>
      <td>190</td>
      <td>19.43311885,-99.14512643</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_019_02</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Metropol</td>
    </tr>
    <tr>
      <th>124</th>
      <td>124</td>
      <td>19.4297560476,-99.1253498219</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>006_052_01</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Universo</td>
    </tr>
    <tr>
      <th>63</th>
      <td>63</td>
      <td>19.4339116282,-99.1468371035</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_015_07</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Calvin</td>
    </tr>
    <tr>
      <th>229</th>
      <td>229</td>
      <td>19.4346765421,-99.1318394918</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>005_145_14</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Museo</td>
      <td>Templo Mayor</td>
    </tr>
    <tr>
      <th>70</th>
      <td>70</td>
      <td>19.43712772,-99.1378899</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>004_090_02</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Congreso</td>
    </tr>
    <tr>
      <th>195</th>
      <td>195</td>
      <td>19.4414840739,-99.1394736635</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>004_050_13</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Emperador</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
      <td>19.43990186,-99.14813347</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>003_079_16</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>La Paz</td>
    </tr>
    <tr>
      <th>191</th>
      <td>191</td>
      <td>19.43985567,-99.14782916</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>003_079_12</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Ferrol</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
      <td>19.4219963186,-99.1437414652</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_103_18</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Faro</td>
    </tr>
    <tr>
      <th>113</th>
      <td>113</td>
      <td>19.43374405,-99.13550135</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>001_012_13</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>San Antonio</td>
    </tr>
    <tr>
      <th>149</th>
      <td>149</td>
      <td>19.43031663,-99.12465191</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>323_035_01</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Liverpool</td>
    </tr>
    <tr>
      <th>26</th>
      <td>26</td>
      <td>19.4262321913,-99.1238893146</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1241...</td>
      <td>323_064_01</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Mercado</td>
      <td>La Merced Nave Mayor</td>
    </tr>
    <tr>
      <th>78</th>
      <td>78</td>
      <td>19.4430578017,-99.13614342</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1368...</td>
      <td>004_107_01</td>
      <td>Cuauhtémoc</td>
      <td>B</td>
      <td>Mercado</td>
      <td>La Lagunilla</td>
    </tr>
    <tr>
      <th>37</th>
      <td>37</td>
      <td>19.4271233834,-99.125111772</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1251...</td>
      <td>323_065_01</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Mercado</td>
      <td>Dulceria</td>
    </tr>
    <tr>
      <th>42</th>
      <td>42</td>
      <td>19.4368553413,-99.1196435872</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.11...</td>
      <td>018_337_01</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Hotel</td>
      <td>HOTEL RRO MI1O</td>
    </tr>
    <tr>
      <th>146</th>
      <td>146</td>
      <td>19.4373584031,-99.1383047535</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>004_090_14</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Congreso Garage</td>
    </tr>
    <tr>
      <th>130</th>
      <td>130</td>
      <td>19.4351458312,-99.1282270238</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>005_114_34</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Museo</td>
      <td>Sinagoga Histórica de Justo Sierra</td>
    </tr>
    <tr>
      <th>81</th>
      <td>81</td>
      <td>19.42262452,-99.15107339</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.15...</td>
      <td>002_096_02</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Imperio</td>
    </tr>
    <tr>
      <th>82</th>
      <td>82</td>
      <td>19.4220369889,-99.120775543</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>423_013_18</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Cordoba</td>
    </tr>
    <tr>
      <th>142</th>
      <td>142</td>
      <td>19.4263681354,-99.1327278126</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>006_127_14</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Ambar</td>
    </tr>
    <tr>
      <th>226</th>
      <td>226</td>
      <td>19.4416748524,-99.1365878489</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1370...</td>
      <td>004_052_01</td>
      <td>Cuauhtémoc</td>
      <td>B</td>
      <td>Mercado</td>
      <td>De Muebles</td>
    </tr>
    <tr>
      <th>175</th>
      <td>175</td>
      <td>19.4291934671,-99.1323328561</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>006_073_11</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Museo</td>
      <td>La Ciudad de México</td>
    </tr>
    <tr>
      <th>123</th>
      <td>123</td>
      <td>19.4378770032,-99.1358867181</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>004_086_36</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Florida</td>
    </tr>
    <tr>
      <th>68</th>
      <td>68</td>
      <td>19.4273142523,-99.1255788881</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>006_082_02</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Anpudia</td>
    </tr>
    <tr>
      <th>126</th>
      <td>126</td>
      <td>19.42774805,-99.12796532</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>006_078_04</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>San Marcos</td>
    </tr>
    <tr>
      <th>136</th>
      <td>136</td>
      <td>19.4263840955,-99.1429192037</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_084_14</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Miguel Ángel</td>
    </tr>
    <tr>
      <th>153</th>
      <td>153</td>
      <td>19.4241764183,-99.1254198454</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>323_133_29</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Navio</td>
    </tr>
    <tr>
      <th>39</th>
      <td>39</td>
      <td>19.4369818158,-99.1426877718</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>003_095_04</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Museo</td>
      <td>Museo Nacional de La Estampa</td>
    </tr>
    <tr>
      <th>194</th>
      <td>194</td>
      <td>19.4288786806,-99.1456731565</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_060_04</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>San Diego, S.A. DE C.V.</td>
    </tr>
    <tr>
      <th>107</th>
      <td>107</td>
      <td>19.4248237343,-99.1311696681</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1313...</td>
      <td>307_128_04</td>
      <td>Cuauhtémoc</td>
      <td>B</td>
      <td>Mercado</td>
      <td>San Lucas</td>
    </tr>
    <tr>
      <th>135</th>
      <td>135</td>
      <td>19.4300009578,-99.1430773295</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1431...</td>
      <td>002_045_01</td>
      <td>Cuauhtémoc</td>
      <td>B</td>
      <td>Mercado</td>
      <td>Centro Artesanal "San Juan"</td>
    </tr>
    <tr>
      <th>50</th>
      <td>50</td>
      <td>19.427412415,-99.1425547699</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1427...</td>
      <td>002_064_05</td>
      <td>Cuauhtémoc</td>
      <td>B</td>
      <td>Mercado</td>
      <td>San Juan No.78</td>
    </tr>
    <tr>
      <th>99</th>
      <td>99</td>
      <td>19.4438918423,-99.1402516182</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>003_052_18</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Drigales</td>
    </tr>
    <tr>
      <th>211</th>
      <td>211</td>
      <td>19.4325804122,-99.146356862</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_032_01</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Fleming</td>
    </tr>
    <tr>
      <th>159</th>
      <td>159</td>
      <td>19.4337392469,-99.1311991819</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>006_001_06</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Museo</td>
      <td>Arte de la Secretaria de Hacienda y Credito Pu...</td>
    </tr>
    <tr>
      <th>207</th>
      <td>207</td>
      <td>19.4344738803,-99.1305689118</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>006_002_13</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Museo</td>
      <td>Autonomía Universitaria</td>
    </tr>
    <tr>
      <th>179</th>
      <td>179</td>
      <td>19.421906236,-99.1246612487</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1250...</td>
      <td>423_006_01</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Mercado</td>
      <td>Mercado Sonora</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>19.43553422,-99.12324801</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>318_116_11</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Hotel</td>
      <td>San Antonio Tomatlan</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>19.436244494,-99.1477350326</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_004-03</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Fontan Reforma</td>
    </tr>
    <tr>
      <th>65</th>
      <td>65</td>
      <td>19.425466805,-99.1380880561</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>001_073_20</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Mar</td>
    </tr>
    <tr>
      <th>215</th>
      <td>215</td>
      <td>19.4383767258,-99.1331865203</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>004_082_16</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>La Fontelina , S.A. DE C.V.</td>
    </tr>
    <tr>
      <th>223</th>
      <td>223</td>
      <td>19.4285106481,-99.1367967407</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>001_055_10</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Niza</td>
    </tr>
    <tr>
      <th>91</th>
      <td>91</td>
      <td>19.42981826,-99.14607091</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_059_01</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Pugibet</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
      <td>19.4317119617,-99.1269115285</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>006_026_28</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Museo</td>
      <td>Alondiga La Merced</td>
    </tr>
    <tr>
      <th>221</th>
      <td>221</td>
      <td>19.4386933829,-99.1481075783</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>003_103_26</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>San Fernando</td>
    </tr>
    <tr>
      <th>137</th>
      <td>137</td>
      <td>19.4421185698,-99.1482841686</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>012_108_03</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Lepanto</td>
    </tr>
    <tr>
      <th>32</th>
      <td>32</td>
      <td>19.4369607249,-99.1354098031</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>004_101_20</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Habana, S.A.</td>
    </tr>
    <tr>
      <th>121</th>
      <td>121</td>
      <td>19.4303083246,-99.1405735286</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>001_043_15</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>El Salvador</td>
    </tr>
    <tr>
      <th>210</th>
      <td>210</td>
      <td>19.43082385,-99.12366058</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>323_029_08</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Hispano</td>
    </tr>
    <tr>
      <th>168</th>
      <td>168</td>
      <td>19.4349726565,-99.147766133</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_014_23</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>One Alameda</td>
    </tr>
    <tr>
      <th>100</th>
      <td>100</td>
      <td>19.4337759404,-99.1378211234</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>001_014_06</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Ritz Ciudada de México</td>
    </tr>
    <tr>
      <th>196</th>
      <td>196</td>
      <td>19.4437017048,-99.1325438818</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>004_043_06</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Boston</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="systematic-sampling">
<h3>Systematic sampling<a class="headerlink" href="#systematic-sampling" title="Permalink to this heading">#</a></h3>
<p>This technique extracts samples based on a condition or rule</p>
<p>example:</p>
<p><em>Let’s define a function to take samples each <span class="math notranslate nohighlight">\(n\)</span> rows</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s take samples each 3 rows</span>

<span class="k">def</span> <span class="nf">systematic_sampling</span><span class="p">(</span><span class="n">econdata</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
    <span class="n">indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">econdata</span><span class="p">),</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>
    <span class="n">systematic_sample</span> <span class="o">=</span> <span class="n">econdata</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">indexes</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">systematic_sample</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">systematic_sample</span> <span class="o">=</span> <span class="n">systematic_sampling</span><span class="p">(</span><span class="n">econdata</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">systematic_sample</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>geo_point_2d</th>
      <th>geo_shape</th>
      <th>clave_cat</th>
      <th>delegacion</th>
      <th>perimetro</th>
      <th>tipo</th>
      <th>nom_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>19.424781053,-99.1327537959</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1332...</td>
      <td>307_130_11</td>
      <td>Cuauhtémoc</td>
      <td>B</td>
      <td>Mercado</td>
      <td>Pino Suárez</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>19.42489472,-99.12073393</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>323_102_06</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Balbuena</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>19.43553422,-99.12324801</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>318_116_11</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Hotel</td>
      <td>San Antonio Tomatlan</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>19.4407152937,-99.1498060057</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>012_146_22</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Detroit</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
      <td>19.43990186,-99.14813347</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>003_079_16</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>La Paz</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
      <td>19.42413788,-99.1324515</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>307_153_11</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>San Lucas</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
      <td>19.4331161255,-99.1309438719</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>006_021_01</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Museo</td>
      <td>Museo Nacional de las Culturas</td>
    </tr>
    <tr>
      <th>21</th>
      <td>21</td>
      <td>19.43614459,-99.13945267</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>004_098_01</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Museo</td>
      <td>Telégrafo</td>
    </tr>
    <tr>
      <th>24</th>
      <td>24</td>
      <td>19.4285279152,-99.147008562</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_067_19</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Fornos</td>
    </tr>
    <tr>
      <th>27</th>
      <td>27</td>
      <td>19.4348360773,-99.1463945583</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_016_01</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Hilton Centro Histórico</td>
    </tr>
    <tr>
      <th>30</th>
      <td>30</td>
      <td>19.427530818,-99.1479200065</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_068_13</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Villa Pal</td>
    </tr>
    <tr>
      <th>33</th>
      <td>33</td>
      <td>19.4341938751,-99.1352210651</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>001_007_04</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Washingtonw</td>
    </tr>
    <tr>
      <th>36</th>
      <td>36</td>
      <td>19.4425777264,-99.1292760518</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1288...</td>
      <td>005_077_01</td>
      <td>Cuauhtémoc</td>
      <td>B</td>
      <td>Mercado</td>
      <td>Granaditas</td>
    </tr>
    <tr>
      <th>39</th>
      <td>39</td>
      <td>19.4369818158,-99.1426877718</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>003_095_04</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Museo</td>
      <td>Museo Nacional de La Estampa</td>
    </tr>
    <tr>
      <th>42</th>
      <td>42</td>
      <td>19.4368553413,-99.1196435872</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.11...</td>
      <td>018_337_01</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Hotel</td>
      <td>HOTEL RRO MI1O</td>
    </tr>
    <tr>
      <th>45</th>
      <td>45</td>
      <td>19.4438839913,-99.1361724518</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>004_040_11</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Guadalajara</td>
    </tr>
    <tr>
      <th>48</th>
      <td>48</td>
      <td>19.4454876095,-99.1454023878</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1457...</td>
      <td>003_045_01</td>
      <td>Cuauhtémoc</td>
      <td>B</td>
      <td>Mercado</td>
      <td>Martínez de la Torre Anexo</td>
    </tr>
    <tr>
      <th>51</th>
      <td>51</td>
      <td>19.4357182545,-99.1308788314</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>005_129_16</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Museo</td>
      <td>Antiguo Colegio de San Idelfonso</td>
    </tr>
    <tr>
      <th>54</th>
      <td>54</td>
      <td>19.4263645964,-99.1399088724</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>001_076_12</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Cadillac, S.A. DE C.V.</td>
    </tr>
    <tr>
      <th>57</th>
      <td>57</td>
      <td>19.4303913751,-99.1465372648</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_048_10</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Conde</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="samples-equally-distanced">
<h4>Samples equally distanced<a class="headerlink" href="#samples-equally-distanced" title="Permalink to this heading">#</a></h4>
<p><em>Now, Let’s take 10 samples equally distanced</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">interval</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span><span class="n">econdata</span><span class="p">)</span> <span class="o">/</span> <span class="n">sample_size</span> <span class="p">)</span>

<span class="n">econdata</span><span class="o">.</span><span class="n">iloc</span><span class="p">[::</span><span class="n">interval</span><span class="p">]</span><span class="c1">#.reset_index()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>geo_point_2d</th>
      <th>geo_shape</th>
      <th>clave_cat</th>
      <th>delegacion</th>
      <th>perimetro</th>
      <th>tipo</th>
      <th>nom_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>19.424781053,-99.1327537959</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1332...</td>
      <td>307_130_11</td>
      <td>Cuauhtémoc</td>
      <td>B</td>
      <td>Mercado</td>
      <td>Pino Suárez</td>
    </tr>
    <tr>
      <th>23</th>
      <td>23</td>
      <td>19.4390916028,-99.1493421468</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>012_147_01</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>La Fuente</td>
    </tr>
    <tr>
      <th>46</th>
      <td>46</td>
      <td>19.426941681,-99.1326869759</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>006_090_12</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Castropol</td>
    </tr>
    <tr>
      <th>69</th>
      <td>69</td>
      <td>19.43558625,-99.12965746</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>005_129_08</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Templo Mayor</td>
    </tr>
    <tr>
      <th>92</th>
      <td>92</td>
      <td>19.4383554723,-99.1327563513</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>004_082_19</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>Tuxpan</td>
    </tr>
    <tr>
      <th>115</th>
      <td>115</td>
      <td>19.4336966991,-99.1237253904</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.12...</td>
      <td>323_010_09</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Antas</td>
    </tr>
    <tr>
      <th>138</th>
      <td>138</td>
      <td>19.4330991176,-99.1423784309</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.14...</td>
      <td>002_024_08</td>
      <td>Cuautémoc</td>
      <td>B</td>
      <td>Hotel</td>
      <td>Marlowe</td>
    </tr>
    <tr>
      <th>161</th>
      <td>161</td>
      <td>19.4356652812,-99.1386591361</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>001_003_12</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Museo</td>
      <td>La Tortura</td>
    </tr>
    <tr>
      <th>184</th>
      <td>184</td>
      <td>19.4306993983,-99.1389056387</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>001_043_01</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Hotel</td>
      <td>La Casa de la Luna, S.A. DE C.V.</td>
    </tr>
    <tr>
      <th>207</th>
      <td>207</td>
      <td>19.4344738803,-99.1305689118</td>
      <td>{"type": "MultiPoint", "coordinates": [[-99.13...</td>
      <td>006_002_13</td>
      <td>Cuautémoc</td>
      <td>A</td>
      <td>Museo</td>
      <td>Autonomía Universitaria</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="stratified-sampling">
<h3>Stratified sampling<a class="headerlink" href="#stratified-sampling" title="Permalink to this heading">#</a></h3>
<p>This type of sampling consists in creating <em>homogeneus exclusive groups</em> and from there, create a random sample</p>
<section id="proportional-stratified-sample">
<h4>Proportional stratified sample<a class="headerlink" href="#proportional-stratified-sample" title="Permalink to this heading">#</a></h4>
<p>Suppose you have a dataset and you would like to take a sample that has the same proportions as the population</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;penguins&quot;</span><span class="p">)</span>

<span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Adelie       0.441860
Gentoo       0.360465
Chinstrap    0.197674
Name: species, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>In that case you have:</p>
<ol class="arabic simple">
<li><p>Group by the column that contains the proportion</p></li>
<li><p>Sample using the frac= argument, to base in a proportion</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prop_sample</span> <span class="o">=</span> <span class="n">penguins</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;species&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">prop_sample</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Adelie       0.441176
Gentoo       0.352941
Chinstrap    0.205882
Name: species, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Note that the sample still contains the same proportion than the original dataset does. In addition, it contains a random 10% of the original data</p>
</section>
<section id="equal-count-stratified-sampling">
<h4>Equal count stratified sampling<a class="headerlink" href="#equal-count-stratified-sampling" title="Permalink to this heading">#</a></h4>
<p>This process allows to take an equal number of samples based on a variable</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">equal_sample</span> <span class="o">=</span> <span class="n">penguins</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;species&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="n">equal_sample</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chinstrap    0.333333
Gentoo       0.333333
Adelie       0.333333
Name: species, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="weighted-random-sampling">
<h4>Weighted random sampling<a class="headerlink" href="#weighted-random-sampling" title="Permalink to this heading">#</a></h4>
<p>this one adjusts the relative probability of a row being sampled</p>
<p>Example:</p>
<p>Let’s take samples so that <strong>Adelie</strong> has the double of probability</p>
<p>first you must create a column, assign 2 if the specie is Adelie, otherwise assign 1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">condition</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Adelie&quot;</span>

<span class="n">penguins</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now take the sample with the argument weight</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penguins_weight</span> <span class="o">=</span> <span class="n">penguins</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="s2">&quot;weight&quot;</span><span class="p">)</span>

<span class="n">penguins_weight</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Adelie       0.676471
Gentoo       0.205882
Chinstrap    0.117647
Name: species, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="proportional-stratified-sample-given-a-proportion">
<h4>Proportional stratified sample (given a proportion)<a class="headerlink" href="#proportional-stratified-sample-given-a-proportion" title="Permalink to this heading">#</a></h4>
<p>In this case, we are not neccesarily sampling based on a dataset proportion. Now we are going to provide the proportion to our funtion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1st step: Create your stratification variable</span>

<span class="n">econdata</span><span class="p">[</span><span class="s2">&quot;estratificado&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">econdata</span><span class="p">[</span><span class="s2">&quot;delegacion&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">econdata</span><span class="p">[</span><span class="s2">&quot;tipo&quot;</span><span class="p">]</span>
<span class="p">(</span><span class="n">econdata</span><span class="p">[</span><span class="s2">&quot;estratificado&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">econdata</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cuautémoc, Hotel                0.643478
Cuautémoc, Museo                0.156522
Venustiano Carranza, Hotel      0.078261
Cuauhtémoc, Mercado             0.073913
Venustiano Carranza, Mercado    0.047826
Name: estratificado, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The output above shows the proportion of the variables in the dataset.</p>
<p><strong>Suppose now you want to extract a sample with the following proportion:</strong></p>
<p>Cuautémoc,Hotel                0.5
Cuautémoc,Museo                0.2
Venustiano Carranza,Hotel      0.1
Cuauhtémoc,Mercado             0.1
Venustiano Carranza,Mercado    0.1</p>
<p><em>Let’s create a function that can extract a sample with that given proportion.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">stratified_data</span><span class="p">(</span><span class="n">econdata</span><span class="p">,</span> <span class="n">strat_cols</span><span class="p">,</span> <span class="n">strat_values</span><span class="p">,</span> <span class="n">strat_prop</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">df_strat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">econdata</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

    <span class="n">pos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">strat_values</span><span class="p">)):</span>
        <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">strat_values</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ratio_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">econdata</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_strat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ratio_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">econdata</span><span class="p">)</span> <span class="o">*</span> <span class="n">strat_prop</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">df_filtered</span> <span class="o">=</span> <span class="n">econdata</span><span class="p">[</span><span class="n">econdata</span><span class="p">[</span><span class="n">strat_cols</span><span class="p">]</span> <span class="o">==</span> <span class="n">strat_values</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">df_temp</span> <span class="o">=</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">ratio_len</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>

        <span class="n">df_strat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_strat</span><span class="p">,</span> <span class="n">df_temp</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">df_strat</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">strat_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">econdata</span><span class="p">[</span><span class="s2">&quot;estratificado&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">strat_prop</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>

<span class="c1"># Using the function with the given parameters</span>
<span class="n">df_strat</span> <span class="o">=</span> <span class="n">stratified_data</span><span class="p">(</span><span class="n">econdata</span><span class="p">,</span> <span class="s2">&quot;estratificado&quot;</span><span class="p">,</span> <span class="n">strat_values</span><span class="p">,</span> <span class="n">strat_prop</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">df_strat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>geo_point_2d</th>
      <th>geo_shape</th>
      <th>clave_cat</th>
      <th>delegacion</th>
      <th>perimetro</th>
      <th>tipo</th>
      <th>nom_id</th>
      <th>estratificado</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>78</th>
      <td>78</td>
      <td>19.4430578017,-99.13614342</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1368...</td>
      <td>004_107_01</td>
      <td>Cuauhtémoc</td>
      <td>B</td>
      <td>Mercado</td>
      <td>La Lagunilla</td>
      <td>Cuauhtémoc, Mercado</td>
    </tr>
    <tr>
      <th>162</th>
      <td>162</td>
      <td>19.4452741596,-99.1443205075</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1448...</td>
      <td>003_044_01</td>
      <td>Cuauhtémoc</td>
      <td>B</td>
      <td>Mercado</td>
      <td>Martínez de la Torre</td>
      <td>Cuauhtémoc, Mercado</td>
    </tr>
    <tr>
      <th>129</th>
      <td>129</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>005_125_01</td>
      <td>Cuauhtémoc</td>
      <td>A</td>
      <td>Mercado</td>
      <td>Abelardo</td>
      <td>Cuauhtémoc, Mercado</td>
    </tr>
    <tr>
      <th>79</th>
      <td>79</td>
      <td>19.4299360348,-99.1445730919</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1450...</td>
      <td>002_047_11</td>
      <td>Cuauhtémoc</td>
      <td>B</td>
      <td>Mercado</td>
      <td>San Juan</td>
      <td>Cuauhtémoc, Mercado</td>
    </tr>
    <tr>
      <th>78</th>
      <td>78</td>
      <td>19.4430578017,-99.13614342</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1368...</td>
      <td>004_107_01</td>
      <td>Cuauhtémoc</td>
      <td>B</td>
      <td>Mercado</td>
      <td>La Lagunilla</td>
      <td>Cuauhtémoc, Mercado</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>128</th>
      <td>128</td>
      <td>19.4270781084,-99.1210175514</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1214...</td>
      <td>323_061_04(123)</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Mercado</td>
      <td>San Ciprian</td>
      <td>Venustiano Carranza, Mercado</td>
    </tr>
    <tr>
      <th>37</th>
      <td>37</td>
      <td>19.4271233834,-99.125111772</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1251...</td>
      <td>323_065_01</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Mercado</td>
      <td>Dulceria</td>
      <td>Venustiano Carranza, Mercado</td>
    </tr>
    <tr>
      <th>163</th>
      <td>163</td>
      <td>19.4265454033,-99.1224859032</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1231...</td>
      <td>323_063_05</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Mercado</td>
      <td>NaN</td>
      <td>Venustiano Carranza, Mercado</td>
    </tr>
    <tr>
      <th>156</th>
      <td>156</td>
      <td>19.4255480371,-99.1249308096</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1253...</td>
      <td>323_138_04 (3)</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Mercado</td>
      <td>Mariscos</td>
      <td>Venustiano Carranza, Mercado</td>
    </tr>
    <tr>
      <th>37</th>
      <td>37</td>
      <td>19.4271233834,-99.125111772</td>
      <td>{"type": "Polygon", "coordinates": [[[-99.1251...</td>
      <td>323_065_01</td>
      <td>Venustiano Carranza</td>
      <td>B</td>
      <td>Mercado</td>
      <td>Dulceria</td>
      <td>Venustiano Carranza, Mercado</td>
    </tr>
  </tbody>
</table>
<p>230 rows × 9 columns</p>
</div></div></div>
</div>
<p><em>let’s confirm if the proportion is the desired</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="p">(</span><span class="n">df_strat</span><span class="p">[</span><span class="s2">&quot;estratificado&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">econdata</span><span class="p">))</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cuauhtémoc, Mercado             0.5
Cuautémoc, Museo                0.2
Venustiano Carranza, Hotel      0.1
Venustiano Carranza, Mercado    0.1
Cuautémoc, Hotel                0.1
Name: estratificado, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="cluster-sampling">
<h3>Cluster sampling<a class="headerlink" href="#cluster-sampling" title="Permalink to this heading">#</a></h3>
<p>Cluster sampling consists in taking some subgroups using random sampling</p>
<p>And then use simple random sampling in those groups</p>
<img src="image-20230205-201756.png"  width="600" height="300"></section>
<section id="bonus-calculate-mean-per-categories">
<h3>Bonus: Calculate mean per categories<a class="headerlink" href="#bonus-calculate-mean-per-categories" title="Permalink to this heading">#</a></h3>
<p>Whenever you want to calculate an average for a variable bases on a category, you can use the pandas function groupby(). The expression is:</p>
<p><strong>DataFrame.Groupby(“categorical_variable”)[“Numerical_variable”].mean()</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">attrition_pop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;HR-Employee-Attrition.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This database contains some data from Human Resources.</p>
<p>Let’s calculate the average hourly rate based on the field of study:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">attrition_pop</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;EducationField&quot;</span><span class="p">)[</span><span class="s2">&quot;HourlyRate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EducationField
Human Resources     60.888889
Life Sciences       66.831683
Marketing           66.150943
Medical             65.280172
Other               62.365854
Technical Degree    66.621212
Name: HourlyRate, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="relative-error">
<h2>Relative error<a class="headerlink" href="#relative-error" title="Permalink to this heading">#</a></h2>
<p>This measure calculates the error of our sample compared to the population</p>
<section id="calculate-relative-error">
<h3>Calculate relative error<a class="headerlink" href="#calculate-relative-error" title="Permalink to this heading">#</a></h3>
<p>let’s compare the error of the <em><strong>average hourly rate of all the employees</strong></em> vs the <em><strong>average hourly rate of a random 50 employees sample</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># take a 50 rows sample, set the seed to 2022</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">attrition_pop</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">202</span><span class="p">)</span>

<span class="c1"># mean of the population</span>
<span class="n">pop_mean</span> <span class="o">=</span> <span class="n">attrition_pop</span><span class="p">[</span><span class="s2">&quot;HourlyRate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="c1"># mean of the sample</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s2">&quot;HourlyRate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Relative error</span>
<span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pop_mean</span><span class="o">-</span><span class="n">sample_mean</span><span class="p">)</span><span class="o">/</span><span class="n">pop_mean</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.7435473879826704
</pre></div>
</div>
</div>
</div>
</section>
<section id="relative-error-vs-sample-size">
<h3>Relative error vs sample size<a class="headerlink" href="#relative-error-vs-sample-size" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population_mean</span> <span class="o">=</span> <span class="n">attrition_pop</span><span class="p">[</span><span class="s2">&quot;HourlyRate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">attrition_pop</span><span class="p">[</span><span class="s2">&quot;HourlyRate&quot;</span><span class="p">])):</span>
    <span class="n">sample_mean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attrition_pop</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)[</span><span class="s2">&quot;HourlyRate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#Turn sample_mean into a numpy array</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sample_mean</span><span class="p">)</span>

<span class="c1">#Calculate the relative error (%)</span>
<span class="n">rel_error_pct</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">population_mean</span><span class="o">-</span><span class="n">sample_mean</span><span class="p">)</span><span class="o">/</span><span class="n">population_mean</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">rel_error_pct</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Sample size (n)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Relative error (%)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3634aa217aa019b1273fbaa0c215eea631fbf1fd07fa2c040e464b0754fec361.png" src="../_images/3634aa217aa019b1273fbaa0c215eea631fbf1fd07fa2c040e464b0754fec361.png" />
</div>
</div>
</section>
</section>
<section id="sampling-distribution">
<h2>Sampling distribution<a class="headerlink" href="#sampling-distribution" title="Permalink to this heading">#</a></h2>
<p>Each time you perform a simple random sampling, you will obtain different values for your statistics.</p>
<p>In this example, the sample mean is different each time you repeat the sampling process.</p>
<p>A distribution of replicates of sample means (or other point estimates, is known as a sampling distribution)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_hourlyrate</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">):</span>
    <span class="n">mean_hourlyrate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">attrition_pop</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">60</span><span class="p">)[</span><span class="s2">&quot;HourlyRate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mean_hourlyrate</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/39f4660c7af73db79d5b2b503567578676429c3ff03e96dd467fbd3ea80dcad9.png" src="../_images/39f4660c7af73db79d5b2b503567578676429c3ff03e96dd467fbd3ea80dcad9.png" />
</div>
</div>
<section id="approximating-sampling-distributions">
<h3>Approximating sampling distributions<a class="headerlink" href="#approximating-sampling-distributions" title="Permalink to this heading">#</a></h3>
<p>Sometimes it is computationally imposible to calculate statistics based on a population because it is huge. In those cases, instead of considering all the population, you just take a sample.</p>
<p>In this case, let’s consider the mean value obtained from roll</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_dice</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">))</span>
<span class="n">n_outcomes</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n_dice</span><span class="p">:</span>
    <span class="n">n_outcomes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">6</span><span class="o">**</span><span class="n">n</span><span class="p">)</span>

<span class="n">outcomes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;n_dice&quot;</span> <span class="p">:</span> <span class="n">n_dice</span><span class="p">,</span>
        <span class="s2">&quot;n_outcomes&quot;</span> <span class="p">:</span> <span class="n">n_outcomes</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">outcomes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;n_dice&quot;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;n_outcomes&quot;</span><span class="p">,</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;scatter&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/shared-libs/python3.9/py/lib/python3.9/site-packages/pandas/plotting/_matplotlib/core.py:1041: UserWarning: No data for colormapping provided via &#39;c&#39;. Parameters &#39;cmap&#39; will be ignored
  scatter = ax.scatter(
</pre></div>
</div>
<img alt="../_images/33077d458e07b4f79d2fd4167f3dcb9aaf69e09d237f85f4e3643e2eac18f661.png" src="../_images/33077d458e07b4f79d2fd4167f3dcb9aaf69e09d237f85f4e3643e2eac18f661.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="bootstrapping">
<h1>Bootstrapping<a class="headerlink" href="#bootstrapping" title="Permalink to this heading">#</a></h1>
<section id="concept">
<h2>Concept<a class="headerlink" href="#concept" title="Permalink to this heading">#</a></h2>
<p>When you have a dataset, which clearly doesn’t represent the hold population. You can treat the dataset as a sample and use it to build a theoretical population. <em><strong>this is possible by using a resampling technique whith replacement</strong></em></p>
<p>Example:</p>
<p>Let’s use the coffee rating dataset. This dataset contains information about professional ratings for different brands of coffees coming from many countries.</p>
<p>Let’s suposse</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_ratings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-07-07/coffee_ratings.csv&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s use just three columns to make it simple (<em>and store the indexes</em>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_focus</span> <span class="o">=</span> <span class="n">coffee_ratings</span><span class="p">[[</span><span class="s2">&quot;variety&quot;</span><span class="p">,</span> <span class="s2">&quot;country_of_origin&quot;</span><span class="p">,</span> <span class="s2">&quot;flavor&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>and now let’s take a sample</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_resamp</span> <span class="o">=</span> <span class="n">coffee_focus</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#frac=1 makes the sample size as big as the dataset</span>
</pre></div>
</div>
</div>
</div>
<p>Now see that there are some repeated values, and some others were not even sampled</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_resamp</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>822     5
906     5
809     5
1235    5
1284    4
       ..
537     1
539     1
541     1
542     1
1337    1
Name: index, Length: 850, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>How many records didn’t end up in the resample dataset?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">coffee_ratings</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">coffee_resamp</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>489
</pre></div>
</div>
</div>
</div>
<p>☝️☝️☝️☝️ this is the amount of samples that didn’t end up in the resample (for this random resample)</p>
<p>Now, what if we extract the <em><strong>mean of this resample</strong></em>, it would be</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">coffee_resamp</span><span class="p">[</span><span class="s2">&quot;flavor&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.514794622852876
</pre></div>
</div>
</div>
</div>
<section id="actually-bootstrapping">
<h3>Actually Bootstrapping<a class="headerlink" href="#actually-bootstrapping" title="Permalink to this heading">#</a></h3>
<p>AND NOW LET’S REPEAT THIS PROCESS 1000 TIMES AND SAVE THE MEAN VALUES THAT WE GET FOR EACH RESAMPLE</p>
<p>AND THEN LET’S PLOT THAT TO SEE WHAT HAPPENS</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">means</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
            <span class="n">coffee_focus</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s2">&quot;flavor&quot;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">means</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a2657275768f7001cf8b75e0148d6ce1c87ffe646ee8800d92b400c748a4568b.png" src="../_images/a2657275768f7001cf8b75e0148d6ce1c87ffe646ee8800d92b400c748a4568b.png" />
</div>
</div>
<p><em><strong>What we have calculated is known as the Bootstrap distribution for the sample mean</strong></em></p>
<ol class="arabic simple">
<li><p>Make a resample of the same size as the original sample</p></li>
<li><p>Calculate the statistic of interest for this bootstrap sample</p></li>
<li><p>PUT THAT INTO A FOR TO DO IT A LOT OF TIMES</p></li>
</ol>
<p>The resulting statistics are <em>bootstrap statistics</em> and they form <em>a bootstrap distribution</em></p>
</section>
</section>
<section id="bootstrap-statistics-to-estimate-population-parameters">
<h2>Bootstrap statistics to estimate population parameters<a class="headerlink" href="#bootstrap-statistics-to-estimate-population-parameters" title="Permalink to this heading">#</a></h2>
<p>You can extract two main statistics from the bootstrap distribution</p>
<p><strong>Mean</strong></p>
<p><strong>Standard deviation</strong></p>
<section id="mean">
<h3>Mean<a class="headerlink" href="#mean" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Tipically, the bootstrap mean <em><strong>will be almost identical</strong></em> to the sample mean</p></li>
<li><p>The sample mean <em><strong>is not neccesarily similar</strong></em> to the population mean</p></li>
<li><p>Therefore, <em><strong>the bootstrap mean is not a good estimation of the population mean</strong></em></p></li>
</ul>
</section>
<section id="standard-deviation">
<h3>Standard Deviation<a class="headerlink" href="#standard-deviation" title="Permalink to this heading">#</a></h3>
<p>The standard deviation of the bootstrap distribution (AKA standard error) is very useful to estimate the population standard deviation</p>
<p><span class="math notranslate nohighlight">\(Population std.dev \approx Std.Error * \sqrt{n}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Population Standard deviation</span>
<span class="n">coffee_ratings</span><span class="p">[</span><span class="s2">&quot;flavor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3982932757401295
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample Standard deviation</span>
<span class="n">coffee_sample</span> <span class="o">=</span> <span class="n">coffee_ratings</span><span class="p">[</span><span class="s2">&quot;flavor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">coffee_sample</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.33832690787637093
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimated population stantard deviation</span>

<span class="c1"># 1. Bootstrapping the sample</span>

<span class="n">bootstrapped_means</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5000</span><span class="p">):</span>
    <span class="n">bootstrapped_means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">coffee_sample</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="p">)</span>

<span class="c1"># 2. Calculating standard error</span>

<span class="n">standard_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bootstrapped_means</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>        <span class="c1"># ddof=1 because it&#39;s a sample std</span>

<span class="c1"># 3. Calculating n</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coffee_sample</span><span class="p">)</span>

<span class="c1"># 4, population stantard deviation = to std_error * sqrt(n)</span>
<span class="n">standard_error</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3365273584545509
</pre></div>
</div>
</div>
</div>
</section>
<section id="bootstrapping-vs-sampling-distribution-to-estimate-the-mean">
<h3>Bootstrapping vs sampling distribution to estimate the mean<a class="headerlink" href="#bootstrapping-vs-sampling-distribution-to-estimate-the-mean" title="Permalink to this heading">#</a></h3>
<section id="simple-random-sample">
<h4>simple random sample<a class="headerlink" href="#simple-random-sample" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spotify_population</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="s2">&quot;spotify_2000_2020.feather&quot;</span><span class="p">)</span>

<span class="n">spotify_sample</span> <span class="o">=</span> <span class="n">spotify_population</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h5>sampling distribution<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_popularity_2000_samp</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Generate a sampling distribution of 2000 replicates</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">):</span>
    <span class="n">mean_popularity_2000_samp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    	<span class="c1"># Sample 500 rows and calculate the mean popularity </span>
    	<span class="n">spotify_population</span><span class="p">[</span><span class="s2">&quot;popularity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">)</span>

<span class="c1"># Print the sampling distribution results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mean_popularity_2000_samp</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fb476ddcc49d9db4995079541c229dd23b8191859668599cc4fa74051125e7a1.png" src="../_images/fb476ddcc49d9db4995079541c229dd23b8191859668599cc4fa74051125e7a1.png" />
</div>
</div>
</section>
<section id="bootstrap-distribution">
<h5>bootstrap distribution<a class="headerlink" href="#bootstrap-distribution" title="Permalink to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_popularity_2000_boot</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Generate a bootstrap distribution of 2000 replicates</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">):</span>
    <span class="n">mean_popularity_2000_boot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    	<span class="c1"># Resample 500 rows and calculate the mean popularity     </span>
    	<span class="n">spotify_sample</span><span class="p">[</span><span class="s2">&quot;popularity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">)</span>

<span class="c1"># Print the bootstrap distribution results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mean_popularity_2000_boot</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e996fe02e75e09fe13d765323ee16b59c08645091e50c402efd15ca4b35eefd9.png" src="../_images/e996fe02e75e09fe13d765323ee16b59c08645091e50c402efd15ca4b35eefd9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the population mean popularity</span>
<span class="n">pop_mean</span> <span class="o">=</span> <span class="n">spotify_population</span><span class="p">[</span><span class="s2">&quot;popularity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Calculate the original sample mean popularity</span>
<span class="n">samp_mean</span> <span class="o">=</span> <span class="n">spotify_sample</span><span class="p">[</span><span class="s2">&quot;popularity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Calculate the sampling dist&#39;n estimate of mean popularity</span>
<span class="n">samp_distn_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mean_popularity_2000_samp</span><span class="p">)</span>

<span class="c1"># Calculate the bootstrap dist&#39;n estimate of mean popularity</span>
<span class="n">boot_distn_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mean_popularity_2000_boot</span><span class="p">)</span>

<span class="c1"># Print the means</span>
<span class="nb">print</span><span class="p">([</span><span class="n">pop_mean</span><span class="p">,</span> <span class="n">samp_mean</span><span class="p">,</span> <span class="n">samp_distn_mean</span><span class="p">,</span> <span class="n">boot_distn_mean</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[54.837142308430955, 54.8411, 54.824535000000004, 54.8397755]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist_media_muestral</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Generate a sampling distribution of 2000 replicates</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">):</span>
    <span class="n">dist_media_muestral</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    	<span class="c1"># Sample 500 rows and calculate the mean popularity </span>
    	<span class="n">coffee_ratings</span><span class="p">[</span><span class="s2">&quot;flavor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dist_media_muestral</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3169816193457466
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Population Standard deviation</span>
<span class="n">coffee_ratings</span><span class="p">[</span><span class="s2">&quot;flavor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3982932757401295
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="confidence-intervals">
<h1>Confidence intervals<a class="headerlink" href="#confidence-intervals" title="Permalink to this heading">#</a></h1>
<p>Confidence intervals define a range within the parameter or an statistic should be with a given certainty percentage.</p>
<p>Given a dataset, there are two ways of calculating confidence intervals (tipically 95%)</p>
<ul class="simple">
<li><p>Search from 2.5% to 97.5% of the dataset <strong>(Quantile method)</strong></p></li>
<li><p>Use the inverse of the cumulative density function and adjust it’s parameters <strong>(standard error method)</strong></p></li>
</ul>
<section id="quantile-method-for-confidence-intervals">
<h2>Quantile method for confidence intervals<a class="headerlink" href="#quantile-method-for-confidence-intervals" title="Permalink to this heading">#</a></h2>
<p>To provide a 95% confidence interval for the normal distribution. We take the data contained within the 2.5 and 97.5 quantiles</p>
<p><img alt="Picture title" src="../_images/image-20230209-211411.png" /></p>
<p>Let’s do an example with the standard normal distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generating a standard normal distribution</span>

<span class="n">standard_normal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>for the normal standard distribution:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">standard_normal</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.9557793224830742
</pre></div>
</div>
</div>
</div>
<p>for the normal standard distribution:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">standard_normal</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.9647666250156202
</pre></div>
</div>
</div>
</div>
</section>
<section id="standard-error-method-for-confidence-intervals">
<h2>standard error method for confidence intervals<a class="headerlink" href="#standard-error-method-for-confidence-intervals" title="Permalink to this heading">#</a></h2>
<p>This method uses the Inverse Cumulative Distribution Function</p>
<p>First, let’s remember the Cumulative Distribution Function for a normal standard distribution</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cumulative_density_function</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1001</span><span class="p">):</span>
    <span class="n">cumulative_density_function</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1001</span><span class="p">),</span> <span class="n">cumulative_density_function</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/50d37f7d7cffbcd701649b75a095f37ed1656b6f369250567a2f88bf0e322a57.png" src="../_images/50d37f7d7cffbcd701649b75a095f37ed1656b6f369250567a2f88bf0e322a57.png" />
</div>
</div>
<p>Now, if you flip the x and y axis, you obtain the <em><strong>inverse of the cumulative density function</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inverse_cumulative_density_function</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1001</span><span class="p">):</span>
    <span class="n">inverse_cumulative_density_function</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1001</span><span class="p">),</span> <span class="n">inverse_cumulative_density_function</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e7fa97430183e4f9dad884f4780762d3df30c12a7fc2ce5e26082c7b0096e4ca.png" src="../_images/e7fa97430183e4f9dad884f4780762d3df30c12a7fc2ce5e26082c7b0096e4ca.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.9599639845400545
</pre></div>
</div>
</div>
</div>
<p>the method consists of:</p>
<ol class="arabic simple">
<li><p>Calculate the <strong>point estimate</strong>:
Which is the mean of the bootstrap distribution.</p></li>
<li><p>Calculate the <strong>standard error</strong>:
Which is the standard deviation of the bootstrap distribution</p></li>
<li><p>Use the <strong>Inverse of the cumulative density function</strong>:
Finally, call the norm.ppf() using the paramers</p></li>
</ol>
<ul class="simple">
<li><p>the mean should be the <strong>point estimate</strong> of your distribution</p></li>
<li><p>the standard deviation must be the <strong>standard error</strong> of your distribution</p></li>
</ul>
<p><strong>sources:</strong></p>
<p>Datacamp: Sampling in python
Platzi: Estadistica Inferencial</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="hypotesis-testing">
<h1>Hypotesis testing<a class="headerlink" href="#hypotesis-testing" title="Permalink to this heading">#</a></h1>
<section id="id2">
<h2>Concept<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<p>HYPOTHESIS TESTS DETERMINE WETHER THE SAMPLE STATISTICS LIE IN THE TAILS OF THE NULL DISTRIBUION</p>
<p>NULL DISTRIBUION: distribution of the statistic if the null hypothesis was true.</p>
<p>There are three types of tests. And the phrasing of the alternative hypothesis determines which type we should use</p>
<ul class="simple">
<li><p>If we are checking for a <em><strong>difference compared to a hypothesized value</strong></em>, we look for <em><strong>extreme values in either tail</strong></em> and perform a <em><strong>two-tailed test</strong></em></p></li>
<li><p>If the <em><strong>alternative hypothesis</strong></em> (<span class="math notranslate nohighlight">\(H_1\)</span>) uses language like <em><strong>“less” or “fewer”</strong></em>, we perform a left tailed test</p></li>
<li><p>If the <em><strong>alternative hypothesis</strong></em> (<span class="math notranslate nohighlight">\(H_1\)</span>) uses language like <em><strong>“greater” or “exceeds”</strong></em>, correspond to a right tailed test</p></li>
</ul>
<p><img alt="Picture title" src="../_images/image-20230215-112430.png" /></p>
</section>
<section id="assumptions">
<h2>Assumptions<a class="headerlink" href="#assumptions" title="Permalink to this heading">#</a></h2>
<p>Every hypothesis has the following assumptions:</p>
<ul class="simple">
<li><p><em><strong>each sample is randomly sourced from its population</strong></em></p></li>
</ul>
<p>this assumption exists because <em><strong>if the sample is not random, then it won’t be representative of the population</strong></em></p>
<ul class="simple">
<li><p><em><strong>each observation is independent</strong></em></p></li>
</ul>
<p>the only exception for this rule is the paired t-test (section 7) just because the data measures the same observation at a different time.</p>
<p>the fact than observations are dependent or independent change the calculations, not accounting for dependencies when they exist results in an increased chance of false negative or false positive error. Also, not accounting for dependencies is a problem hard to detect, and ideally needs to be discussed before data collection</p>
<p>to verify this assumption, you have to know your data source, there are no statistical tests to verify this assumption. The best way to onboard this problem is to ask people involved in the data collection, or a domain expert that understands the population being sampled.</p>
<ul class="simple">
<li><p><em><strong>large sample size</strong></em></p></li>
</ul>
<p>These tests also assume that the sample is big enough that the <em><strong>central limit theorem</strong></em> applies and we can assume that the <em><strong>sample distribution is normal</strong></em>.</p>
<p>smaller samples incur greater uncertainty, implicating that central limith theorem does not apply and the sampling distributions might not be normally distributed</p>
<p>Also, the uncertainty generated by small sample means we get wider confidence intervals on the parameter we are trying to estimate</p>
<p>Now, <em><strong>How big our sample needs to be?</strong></em> depends on the test and will be shown across the upcoming chapters</p>
<ul class="simple">
<li><p><em><strong>If the sample size is small</strong></em>
In case of having small sample sizes not everything is lost, we can still work with them if the null distribution seems normal</p></li>
</ul>
</section>
<section id="sanity-check">
<h2>Sanity check<a class="headerlink" href="#sanity-check" title="Permalink to this heading">#</a></h2>
<p>One more check we can perform is to calcuate a bootstrap distribution and visualize it with a histogram, if we don’t see a bell shaped normal curve, then one of the assumptions hasn’t been met, in that case revisit the data collection process and check for</p>
<ul class="simple">
<li><p>randomness</p></li>
<li><p>independence</p></li>
<li><p>sample size</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="hypothesis-test-mean">
<h1>Hypothesis test (mean)<a class="headerlink" href="#hypothesis-test-mean" title="Permalink to this heading">#</a></h1>
<section id="steps-to-perform-hypothesis-testing">
<h2>Steps to perform hypothesis testing<a class="headerlink" href="#steps-to-perform-hypothesis-testing" title="Permalink to this heading">#</a></h2>
<section id="define-the-null-hypothesis-and-alternative-hypothesis">
<h3>1. Define the null hypothesis and alternative hypothesis<a class="headerlink" href="#define-the-null-hypothesis-and-alternative-hypothesis" title="Permalink to this heading">#</a></h3>
</section>
<section id="calculate-the-z-score">
<h3>2. Calculate the Z-score<a class="headerlink" href="#calculate-the-z-score" title="Permalink to this heading">#</a></h3>
<p>since variables have arbitrary units and ranges, before we test our hypotesis, we need to standardize the values:</p>
<p><span class="math notranslate nohighlight">\(standardizedvalue = \frac{value - mean}{standard deviation}\)</span></p>
<p>But for hypotesis testing, we use a variation</p>
<p>z_score = <span class="math notranslate nohighlight">\(\frac{sample statistic - hypoth.param.value}{standard error}\)</span></p>
<p>note:</p>
<p><strong>sample statistic:</strong> is the statistic taken from your dataset or from the information you have</p>
<p><strong>hypothesis parameter value:</strong> is the parameter that you define in your alternative hypothesis <span class="math notranslate nohighlight">\(H_1\)</span></p>
<p><strong>standard error:</strong> is the standard deviation of the bootstrap distribution</p>
</section>
<section id="calculate-the-p-value">
<h3>3. Calculate the P-value<a class="headerlink" href="#calculate-the-p-value" title="Permalink to this heading">#</a></h3>
<p>Once you get the Z-score, you can now calculate the P-value. The calculation of the P-value depends on the test that you are performing</p>
<ul class="simple">
<li><p><strong>for left-tailed test</strong></p></li>
</ul>
<p>p_value = norm.cdf(z_score, loc=0, scale=1)</p>
<ul class="simple">
<li><p><strong>for right-tailed test</strong></p></li>
</ul>
<p>p_value = 1 - norm.cdf(z_score, loc=0, scale=1)</p>
<ul class="simple">
<li><p><strong>for two-tailed test</strong></p></li>
</ul>
<p>p_value = 2 * norm.cdf(z_score, loc=0, scale=1)</p>
<ul class="simple">
<li><p>Note:
<em>norm.cdf() is a function of the scipy.stats library</em></p></li>
</ul>
<p><em>to run it properly, run: <strong>from scipy.stats import norm</strong></em></p>
<section id="finally-if-the-p-value-is-less-than-0-05-for-a-0-05-significance-level-you-can-reject-the-null-hypothesis-otherwise-you-fail-to-reject-the-null-hypothesis">
<h4><em><strong>Finally, if the p-value is less than 0.05 (for a 0.05 significance level), you can reject the null hypothesis. Otherwise, you fail to reject the null hypothesis</strong></em><a class="headerlink" href="#finally-if-the-p-value-is-less-than-0-05-for-a-0-05-significance-level-you-can-reject-the-null-hypothesis-otherwise-you-fail-to-reject-the-null-hypothesis" title="Permalink to this heading">#</a></h4>
</section>
</section>
</section>
<section id="example1-two-tailed-test">
<h2>Example1.  TWO TAILED TEST<a class="headerlink" href="#example1-two-tailed-test" title="Permalink to this heading">#</a></h2>
<section id="context">
<h3>context<a class="headerlink" href="#context" title="Permalink to this heading">#</a></h3>
<p>The dataset below contains information about the stack overflow yearly survey filtered to get answers only from people who consider theirselves as data scientist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stack_overflow</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="s2">&quot;stack_overflow.feather&quot;</span><span class="p">)</span>

<span class="n">stack_overflow</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>respondent</th>
      <th>main_branch</th>
      <th>hobbyist</th>
      <th>age</th>
      <th>age_1st_code</th>
      <th>age_first_code_cut</th>
      <th>comp_freq</th>
      <th>comp_total</th>
      <th>converted_comp</th>
      <th>country</th>
      <th>...</th>
      <th>survey_length</th>
      <th>trans</th>
      <th>undergrad_major</th>
      <th>webframe_desire_next_year</th>
      <th>webframe_worked_with</th>
      <th>welcome_change</th>
      <th>work_week_hrs</th>
      <th>years_code</th>
      <th>years_code_pro</th>
      <th>age_cat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>36.0</td>
      <td>I am not primarily a developer, but I write co...</td>
      <td>Yes</td>
      <td>34.0</td>
      <td>30.0</td>
      <td>adult</td>
      <td>Yearly</td>
      <td>60000.0</td>
      <td>77556.0</td>
      <td>United Kingdom</td>
      <td>...</td>
      <td>Appropriate in length</td>
      <td>No</td>
      <td>Computer science, computer engineering, or sof...</td>
      <td>Express;React.js</td>
      <td>Express;React.js</td>
      <td>Just as welcome now as I felt last year</td>
      <td>40.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>At least 30</td>
    </tr>
    <tr>
      <th>1</th>
      <td>47.0</td>
      <td>I am a developer by profession</td>
      <td>Yes</td>
      <td>53.0</td>
      <td>10.0</td>
      <td>child</td>
      <td>Yearly</td>
      <td>58000.0</td>
      <td>74970.0</td>
      <td>United Kingdom</td>
      <td>...</td>
      <td>Appropriate in length</td>
      <td>No</td>
      <td>A natural science (such as biology, chemistry,...</td>
      <td>Flask;Spring</td>
      <td>Flask;Spring</td>
      <td>Just as welcome now as I felt last year</td>
      <td>40.0</td>
      <td>43.0</td>
      <td>28.0</td>
      <td>At least 30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>69.0</td>
      <td>I am a developer by profession</td>
      <td>Yes</td>
      <td>25.0</td>
      <td>12.0</td>
      <td>child</td>
      <td>Yearly</td>
      <td>550000.0</td>
      <td>594539.0</td>
      <td>France</td>
      <td>...</td>
      <td>Too short</td>
      <td>No</td>
      <td>Computer science, computer engineering, or sof...</td>
      <td>Django;Flask</td>
      <td>Django;Flask</td>
      <td>Just as welcome now as I felt last year</td>
      <td>40.0</td>
      <td>13.0</td>
      <td>3.0</td>
      <td>Under 30</td>
    </tr>
    <tr>
      <th>3</th>
      <td>125.0</td>
      <td>I am not primarily a developer, but I write co...</td>
      <td>Yes</td>
      <td>41.0</td>
      <td>30.0</td>
      <td>adult</td>
      <td>Monthly</td>
      <td>200000.0</td>
      <td>2000000.0</td>
      <td>United States</td>
      <td>...</td>
      <td>Appropriate in length</td>
      <td>No</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Just as welcome now as I felt last year</td>
      <td>40.0</td>
      <td>11.0</td>
      <td>11.0</td>
      <td>At least 30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>147.0</td>
      <td>I am not primarily a developer, but I write co...</td>
      <td>No</td>
      <td>28.0</td>
      <td>15.0</td>
      <td>adult</td>
      <td>Yearly</td>
      <td>50000.0</td>
      <td>37816.0</td>
      <td>Canada</td>
      <td>...</td>
      <td>Appropriate in length</td>
      <td>No</td>
      <td>Another engineering discipline (such as civil,...</td>
      <td>None</td>
      <td>Express;Flask</td>
      <td>Just as welcome now as I felt last year</td>
      <td>40.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>Under 30</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 63 columns</p>
</div></div></div>
</div>
<p>Let’s hypothesize that <em><strong>the mean anual compensation of the population of data scientists is 110.000 dollars</strong></em></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(H_0\)</span> : The mean anual compensation of the population of data scientists is different from 110.000 dollars</p></li>
<li><p><span class="math notranslate nohighlight">\(H_1\)</span> : The mean anual compensation of the population of data scientists is 110.000 dollars</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;converted_comp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>119574.71738168952
</pre></div>
</div>
</div>
</div>
<p>The result is different from our hypotesis, but, <em><strong>is it meaningfully different?</strong></em></p>
<p>To answer that, we generate a bootstrap distribution of sample means</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">so_boot_distn</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5000</span><span class="p">):</span>
    <span class="n">so_boot_distn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
            <span class="n">stack_overflow</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s2">&quot;converted_comp&quot;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">so_boot_distn</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/54d8a7aa20f57911d5e2a5a370e0529c648cea1ed1247a73c8196bd8b8bc5a9a.png" src="../_images/54d8a7aa20f57911d5e2a5a370e0529c648cea1ed1247a73c8196bd8b8bc5a9a.png" />
</div>
</div>
<p>Notice that 110.000 is on the left of the distribution</p>
<p>Now, if we calculate the standard error (a.k.a standard deviation of the bootstrap distribution):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">so_boot_distn</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5671.35937802767
</pre></div>
</div>
</div>
</div>
<p>since variables have arbitrary units and ranges, before we test our hypotesis, we need to standardize the values:</p>
<p><span class="math notranslate nohighlight">\(standardizedvalue = \frac{value - mean}{standard deviation}\)</span></p>
<p>But for hypotesis testing, we use a variation</p>
<p><span class="math notranslate nohighlight">\(z = \frac{sample statistic - hypoth.param.value}{standard error}\)</span></p>
<p><em><strong>the result is called Z score</strong></em></p>
</section>
<section id="calculating-z-score">
<h3>Calculating Z-score<a class="headerlink" href="#calculating-z-score" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z_score</span> <span class="o">=</span> <span class="p">(</span> <span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;converted_comp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="mi">110000</span> <span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">so_boot_distn</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">z_score</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.6882579190422111
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculating-p-value">
<h3>Calculating P-value<a class="headerlink" href="#calculating-p-value" title="Permalink to this heading">#</a></h3>
<p>Since this is a two-tailed test, the pvalue is:</p>
<p><em><strong>p_value = norm.cdf(z_score, loc=0, scale=1) * 2</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_value</span> <span class="o">=</span>  <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z_score</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>

<span class="n">p_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.09136172933530817
</pre></div>
</div>
</div>
</div>
<p>And with this p-value and a significance level of 0.05, we failed to reject the null hypothesis and can conclude that the <em><strong>mean anual compensation of the population of data scientists is different from 110.000 dollars</strong></em></p>
</section>
</section>
<section id="example2-right-tailed-test">
<h2>Example2. RIGHT TAILED TEST<a class="headerlink" href="#example2-right-tailed-test" title="Permalink to this heading">#</a></h2>
<section id="id3">
<h3>context<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<p>For this example, we will use the same dataframe of the stackoverflow survey for data scientists.</p>
<p>The variable <em>age_first_code_cut</em> classifies when Stack Overflow user first started programming</p>
<ul class="simple">
<li><p>“adult” means they started at 14 or older</p></li>
<li><p>“child” means they started before 14</p></li>
</ul>
<p>Let’s perform a hypothesis testing</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(H_0\)</span> : The proportion of data scientists starting programming as children is 35%</p></li>
<li><p><span class="math notranslate nohighlight">\(H_1\)</span> : The proportion of data scientists starting programming as children is greater than 35%</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;age_first_code_cut&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    adult
1    child
2    child
3    adult
4    adult
Name: age_first_code_cut, dtype: object
</pre></div>
</div>
</div>
</div>
<p>We initially assume that the null hypothesis <span class="math notranslate nohighlight">\(H_0\)</span> is true. This only changes if the sample provides enough evidence to reject it.</p>
<p>Now let’s calculate the Zscore</p>
</section>
<section id="id4">
<h3>Calculating Z score<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Point estimate</span>
<span class="n">prop_child_samp</span> <span class="o">=</span> <span class="p">(</span><span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;age_first_code_cut&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;child&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">prop_child_samp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.39141972578505085
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># hypothesized statistic</span>
<span class="n">prop_child_hyp</span> <span class="o">=</span> <span class="mf">0.35</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># std_error</span>
<span class="n">first_code_boot_distn</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># bootstrap distribution</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">5000</span><span class="p">):</span>
    <span class="n">first_code_boot_distn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="p">(</span><span class="n">stack_overflow</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s2">&quot;age_first_code_cut&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;child&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">)</span>

<span class="n">std_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">first_code_boot_distn</span><span class="p">,</span> <span class="n">ddof</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">std_error</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0104640957859478
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Z-score</span>

<span class="n">z_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">prop_child_samp</span> <span class="o">-</span> <span class="n">prop_child_hyp</span><span class="p">)</span> <span class="o">/</span> <span class="n">std_error</span>

<span class="n">z_score</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.958270894335017
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h3>Calculating P-value<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p>Now, pass the z-score to the standard normal CDF (cumulative density function for standard normal distribution)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z_score</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9999622528463471
</pre></div>
</div>
</div>
</div>
<p>And for final, as we are performing a right tail test, the P-value is calculated by taking</p>
<p><span class="math notranslate nohighlight">\(1 - norm.cdf()\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_value</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z_score</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">p_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.77471536529006e-05
</pre></div>
</div>
</div>
</div>
<p>Therefore with a significance level of 0.05, we reject the null hypothesis and we can state that</p>
<p><em><strong>The proportion of data scientists starting programming as children is greater than 35%</strong></em></p>
</section>
</section>
<section id="example-3-right-tailed-test">
<h2>Example 3: RIGHT TAILED TEST<a class="headerlink" href="#example-3-right-tailed-test" title="Permalink to this heading">#</a></h2>
<section id="id6">
<h3>context<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h3>
<p>The late_shipments dataset contains supply chain data on the delivery of medical supplies. Each row represents one delivery of a part. The late columns denotes whether or not the part was delivered late.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">late_shipments</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="s2">&quot;late_shipments.feather&quot;</span><span class="p">)</span>

<span class="n">late_shipments</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>country</th>
      <th>managed_by</th>
      <th>fulfill_via</th>
      <th>vendor_inco_term</th>
      <th>shipment_mode</th>
      <th>late_delivery</th>
      <th>late</th>
      <th>product_group</th>
      <th>sub_classification</th>
      <th>...</th>
      <th>line_item_quantity</th>
      <th>line_item_value</th>
      <th>pack_price</th>
      <th>unit_price</th>
      <th>manufacturing_site</th>
      <th>first_line_designation</th>
      <th>weight_kilograms</th>
      <th>freight_cost_usd</th>
      <th>freight_cost_groups</th>
      <th>line_item_insurance_usd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>36203.0</td>
      <td>Nigeria</td>
      <td>PMO - US</td>
      <td>Direct Drop</td>
      <td>EXW</td>
      <td>Air</td>
      <td>1.0</td>
      <td>Yes</td>
      <td>HRDT</td>
      <td>HIV test</td>
      <td>...</td>
      <td>2996.0</td>
      <td>266644.00</td>
      <td>89.00</td>
      <td>0.89</td>
      <td>Alere Medical Co., Ltd.</td>
      <td>Yes</td>
      <td>1426.0</td>
      <td>33279.83</td>
      <td>expensive</td>
      <td>373.83</td>
    </tr>
    <tr>
      <th>1</th>
      <td>30998.0</td>
      <td>Botswana</td>
      <td>PMO - US</td>
      <td>Direct Drop</td>
      <td>EXW</td>
      <td>Air</td>
      <td>0.0</td>
      <td>No</td>
      <td>HRDT</td>
      <td>HIV test</td>
      <td>...</td>
      <td>25.0</td>
      <td>800.00</td>
      <td>32.00</td>
      <td>1.60</td>
      <td>Trinity Biotech, Plc</td>
      <td>Yes</td>
      <td>10.0</td>
      <td>559.89</td>
      <td>reasonable</td>
      <td>1.72</td>
    </tr>
    <tr>
      <th>2</th>
      <td>69871.0</td>
      <td>Vietnam</td>
      <td>PMO - US</td>
      <td>Direct Drop</td>
      <td>EXW</td>
      <td>Air</td>
      <td>0.0</td>
      <td>No</td>
      <td>ARV</td>
      <td>Adult</td>
      <td>...</td>
      <td>22925.0</td>
      <td>110040.00</td>
      <td>4.80</td>
      <td>0.08</td>
      <td>Hetero Unit III Hyderabad IN</td>
      <td>Yes</td>
      <td>3723.0</td>
      <td>19056.13</td>
      <td>expensive</td>
      <td>181.57</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17648.0</td>
      <td>South Africa</td>
      <td>PMO - US</td>
      <td>Direct Drop</td>
      <td>DDP</td>
      <td>Ocean</td>
      <td>0.0</td>
      <td>No</td>
      <td>ARV</td>
      <td>Adult</td>
      <td>...</td>
      <td>152535.0</td>
      <td>361507.95</td>
      <td>2.37</td>
      <td>0.04</td>
      <td>Aurobindo Unit III, India</td>
      <td>Yes</td>
      <td>7698.0</td>
      <td>11372.23</td>
      <td>expensive</td>
      <td>779.41</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5647.0</td>
      <td>Uganda</td>
      <td>PMO - US</td>
      <td>Direct Drop</td>
      <td>EXW</td>
      <td>Air</td>
      <td>0.0</td>
      <td>No</td>
      <td>HRDT</td>
      <td>HIV test - Ancillary</td>
      <td>...</td>
      <td>850.0</td>
      <td>8.50</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>Inverness Japan</td>
      <td>Yes</td>
      <td>56.0</td>
      <td>360.00</td>
      <td>reasonable</td>
      <td>0.01</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 27 columns</p>
</div></div></div>
</div>
<p><em><strong>1. Calculate the proportion of late shipments</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prop</span> <span class="o">=</span> <span class="p">(</span><span class="n">late_shipments</span><span class="p">[</span><span class="s2">&quot;late&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Yes&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">prop</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.061
</pre></div>
</div>
</div>
</div>
<p>So, now we know that 0.061 or 6.1% of the sipments were late.</p>
<p><em><strong>Let’s hipothesize that the proportion of late shipments is 6%</strong></em></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(H_0\)</span>: The proportion of late shipments is 6%</p></li>
<li><p><span class="math notranslate nohighlight">\(H_1\)</span>: The proportion of late shipments is greater that 6%</p></li>
</ul>
<p>and calculate a z score based on that hypothesis</p>
</section>
<section id="id7">
<h3>Calculating Z score<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">late_shipments_boot_distn</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># bootstrap distribution</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">5000</span><span class="p">):</span>
    <span class="n">late_shipments_boot_distn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="p">(</span><span class="n">late_shipments</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s2">&quot;late&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Yes&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">)</span>

<span class="c1"># standard error</span>
<span class="n">std_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">late_shipments_boot_distn</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># remember: </span>
<span class="c1"># z_score = (sample statistc - hypothesized statistic) / standard error</span>

<span class="n">z_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">prop</span> <span class="o">-</span> <span class="mf">0.06</span><span class="p">)</span> <span class="o">/</span> <span class="n">std_error</span>

<span class="n">z_score</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.1318317224271221
</pre></div>
</div>
</div>
</div>
<p>And we got a z score of 0.13.</p>
<p>Now let’s calculate the pvalue</p>
</section>
<section id="id8">
<h3>Calculating P-value<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remember</span>
<span class="c1"># For right tailed test, p_value = 1 - norm.cdf(...)</span>

<span class="n">p_value</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z_score</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">p_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4475586973291411
</pre></div>
</div>
</div>
</div>
<p>Since the P-value is greater that 0.05, at a significance level of 0.05, we failed to reject the null hypothesis and the conclusion is: The proportion of late shipments is not greater than 6%</p>
</section>
<section id="confirming-the-results-with-a-confidence-interval">
<h3>Confirming the results with a confidence interval<a class="headerlink" href="#confirming-the-results-with-a-confidence-interval" title="Permalink to this heading">#</a></h3>
<p>Let’s calculate a confidence interval of 95%</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate 95% confidence interval using quantile method</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">late_shipments_boot_distn</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">)</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">late_shipments_boot_distn</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">)</span>

<span class="c1"># Print the confidence interval</span>
<span class="nb">print</span><span class="p">((</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.047, 0.076)
</pre></div>
</div>
</div>
</div>
<p>Note:</p>
<p>Since 0.06 is included in the 95% confidence interval and we failed to reject due to a large p-value, the results are similar.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="hypothesis-test-difference-of-means">
<h1>Hypothesis test (difference of means)<a class="headerlink" href="#hypothesis-test-difference-of-means" title="Permalink to this heading">#</a></h1>
<section id="assumptions-for-sample-size">
<h2>Assumptions for sample size<a class="headerlink" href="#assumptions-for-sample-size" title="Permalink to this heading">#</a></h2>
<p>These tests fall in the category of <em><strong>Two-sample t-tests</strong></em>, and we need <em><strong>at least 30 observations in each sample</strong></em> to fulfill the assumption</p>
<p><span class="math notranslate nohighlight">\(n_1 \geq 30, n_2 \geq 30\)</span></p>
<p><span class="math notranslate nohighlight">\(n_i\)</span>: sample size for group <span class="math notranslate nohighlight">\(i\)</span></p>
</section>
<section id="example-1-difference-of-means-right-tailed">
<h2>Example 1. Difference of means (right tailed)<a class="headerlink" href="#example-1-difference-of-means-right-tailed" title="Permalink to this heading">#</a></h2>
<section id="id9">
<h3>Context<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h3>
<p>The dataset below contains information about the stack overflow yearly survey filtered to get answers only from people who consider theirselves as data scientist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stack_overflow</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="s2">&quot;stack_overflow.feather&quot;</span><span class="p">)</span>

<span class="n">stack_overflow</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>respondent</th>
      <th>main_branch</th>
      <th>hobbyist</th>
      <th>age</th>
      <th>age_1st_code</th>
      <th>age_first_code_cut</th>
      <th>comp_freq</th>
      <th>comp_total</th>
      <th>converted_comp</th>
      <th>country</th>
      <th>...</th>
      <th>survey_length</th>
      <th>trans</th>
      <th>undergrad_major</th>
      <th>webframe_desire_next_year</th>
      <th>webframe_worked_with</th>
      <th>welcome_change</th>
      <th>work_week_hrs</th>
      <th>years_code</th>
      <th>years_code_pro</th>
      <th>age_cat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>36.0</td>
      <td>I am not primarily a developer, but I write co...</td>
      <td>Yes</td>
      <td>34.0</td>
      <td>30.0</td>
      <td>adult</td>
      <td>Yearly</td>
      <td>60000.0</td>
      <td>77556.0</td>
      <td>United Kingdom</td>
      <td>...</td>
      <td>Appropriate in length</td>
      <td>No</td>
      <td>Computer science, computer engineering, or sof...</td>
      <td>Express;React.js</td>
      <td>Express;React.js</td>
      <td>Just as welcome now as I felt last year</td>
      <td>40.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>At least 30</td>
    </tr>
    <tr>
      <th>1</th>
      <td>47.0</td>
      <td>I am a developer by profession</td>
      <td>Yes</td>
      <td>53.0</td>
      <td>10.0</td>
      <td>child</td>
      <td>Yearly</td>
      <td>58000.0</td>
      <td>74970.0</td>
      <td>United Kingdom</td>
      <td>...</td>
      <td>Appropriate in length</td>
      <td>No</td>
      <td>A natural science (such as biology, chemistry,...</td>
      <td>Flask;Spring</td>
      <td>Flask;Spring</td>
      <td>Just as welcome now as I felt last year</td>
      <td>40.0</td>
      <td>43.0</td>
      <td>28.0</td>
      <td>At least 30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>69.0</td>
      <td>I am a developer by profession</td>
      <td>Yes</td>
      <td>25.0</td>
      <td>12.0</td>
      <td>child</td>
      <td>Yearly</td>
      <td>550000.0</td>
      <td>594539.0</td>
      <td>France</td>
      <td>...</td>
      <td>Too short</td>
      <td>No</td>
      <td>Computer science, computer engineering, or sof...</td>
      <td>Django;Flask</td>
      <td>Django;Flask</td>
      <td>Just as welcome now as I felt last year</td>
      <td>40.0</td>
      <td>13.0</td>
      <td>3.0</td>
      <td>Under 30</td>
    </tr>
    <tr>
      <th>3</th>
      <td>125.0</td>
      <td>I am not primarily a developer, but I write co...</td>
      <td>Yes</td>
      <td>41.0</td>
      <td>30.0</td>
      <td>adult</td>
      <td>Monthly</td>
      <td>200000.0</td>
      <td>2000000.0</td>
      <td>United States</td>
      <td>...</td>
      <td>Appropriate in length</td>
      <td>No</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>Just as welcome now as I felt last year</td>
      <td>40.0</td>
      <td>11.0</td>
      <td>11.0</td>
      <td>At least 30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>147.0</td>
      <td>I am not primarily a developer, but I write co...</td>
      <td>No</td>
      <td>28.0</td>
      <td>15.0</td>
      <td>adult</td>
      <td>Yearly</td>
      <td>50000.0</td>
      <td>37816.0</td>
      <td>Canada</td>
      <td>...</td>
      <td>Appropriate in length</td>
      <td>No</td>
      <td>Another engineering discipline (such as civil,...</td>
      <td>None</td>
      <td>Express;Flask</td>
      <td>Just as welcome now as I felt last year</td>
      <td>40.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>Under 30</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 63 columns</p>
</div></div></div>
</div>
<p>Two-sample problems compares sample statistics across groups of a variable</p>
<p>for the stack_overflow dataset:</p>
<ul class="simple">
<li><p><em><strong>converted_comp</strong></em> is a numerical variable: describes mean salary in USD</p></li>
<li><p><em><strong>age_first_code_cut</strong></em> is a categorical value: describes if people started programming as childs or adults</p></li>
</ul>
<p>The Hypothesis question is:</p>
<p><em><strong>Are those users who first programmed as childs better compensated than those that started as adults?</strong></em></p>
<p><span class="math notranslate nohighlight">\(H_0 : \)</span>  Population mean for both groups is the same
<span class="math notranslate nohighlight">\(H_1 : \)</span>  Population mean for those who started as childs is greater that for adults</p>
<p><span class="math notranslate nohighlight">\(H_0 : \mu_{child} - \mu_{adult} = 0 \)</span></p>
<p><span class="math notranslate nohighlight">\(H_1 : \mu_{child} - \mu_{adult} &gt; 0 \)</span></p>
<p><em><strong>Use a significance level of 0.05</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stack_overflow</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;age_first_code_cut&quot;</span><span class="p">)[</span><span class="s2">&quot;converted_comp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>age_first_code_cut
adult    111313.311047
child    132419.570621
Name: converted_comp, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The difference is notorius. But, <em><strong>is that increase statistically significant?</strong></em> or could it be explained by sampling variability?</p>
</section>
<section id="calculating-t-statistic">
<h3>Calculating T statistic<a class="headerlink" href="#calculating-t-statistic" title="Permalink to this heading">#</a></h3>
<p>In this case, the <em><strong>test statistic</strong></em> for the hypothesis test is <span class="math notranslate nohighlight">\(\bar{x}_{child} - \bar{x}_{adult}\)</span>, but in this case you don’t calculate the <em><strong>Z-score</strong></em> but the <em><strong>T stastictic</strong></em></p>
<p><span class="math notranslate nohighlight">\(t = \frac{(\bar{x}_{child} - \bar{x}_{adult}) - (\mu_{child} - \mu_{adult})}{SE(\bar{x}_{child} - \bar{x}_{adult})} \)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(SE(\bar{x}_{child} - \bar{x}_{adult}) \approx \sqrt{\frac{s^2_{child}}{n_{child}}+ \frac{s^2_{adult}}{n_{adult}}}\)</span></p>
<p>Now, since the null hypothesis assumes that the population means are equal, the final equation for t would be:</p>
<p><span class="math notranslate nohighlight">\(t = \frac{(\bar{x}_{child} - \bar{x}_{adult})}{\sqrt{\frac{s^2_{child}}{n_{child}}+ \frac{s^2_{adult}}{n_{adult}}}}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xbar</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;age_first_code_cut&quot;</span><span class="p">)[</span><span class="s2">&quot;converted_comp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">xbar_child</span> <span class="o">=</span> <span class="n">xbar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">xbar_adult</span> <span class="o">=</span> <span class="n">xbar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;age_first_code_cut&quot;</span><span class="p">)[</span><span class="s2">&quot;converted_comp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">s_child</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">s_adult</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;age_first_code_cut&quot;</span><span class="p">)[</span><span class="s2">&quot;converted_comp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">n_child</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">n_adult</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numerator</span> <span class="o">=</span> <span class="n">xbar_child</span> <span class="o">-</span> <span class="n">xbar_adult</span>

<span class="n">denominator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="p">((</span><span class="n">s_child</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">n_child</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">s_adult</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">n_adult</span> <span class="p">)</span> <span class="p">)</span>

<span class="n">t_stat</span> <span class="o">=</span> <span class="n">numerator</span><span class="o">/</span><span class="n">denominator</span>

<span class="n">t_stat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.8699313316221844
</pre></div>
</div>
</div>
</div>
</section>
<section id="id10">
<h3>Calculating P value<a class="headerlink" href="#id10" title="Permalink to this heading">#</a></h3>
<p>The t distribution requests a degrees of freedom parameter (degrees of freedom are the amount of independant observations in our dataset).</p>
<p>In this case, <em><strong>there are as many degrees of freedom as observations</strong></em>, minus two, because we already know two sample statistics (the means for each group)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># dof = n - 2 </span>
<span class="n">degrees_of_freedom</span> <span class="o">=</span> <span class="n">n_child</span> <span class="o">+</span> <span class="n">n_adult</span> <span class="o">-</span> <span class="mi">2</span>

<span class="c1"># since it is a right tailed test</span>
<span class="n">P_value</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">t_stat</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">degrees_of_freedom</span><span class="p">)</span>

<span class="n">P_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.030811302165157595
</pre></div>
</div>
</div>
</div>
<p>Since the P-value is less than 0.05, we reject the null hypothesis and can conclude that <em><strong>the mean salary for people who started coding as child, is higher than the mean salary for those who started as adults</strong></em></p>
</section>
<section id="solving-with-pengouin">
<h3>Solving with pengouin<a class="headerlink" href="#solving-with-pengouin" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Child compensation</span>
<span class="n">child_compensation</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">[</span>
    <span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;age_first_code_cut&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;child&quot;</span><span class="p">][</span><span class="s2">&quot;converted_comp&quot;</span><span class="p">]</span>

<span class="c1"># Adult compensation</span>
<span class="n">adult_compensation</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">[</span>
    <span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;age_first_code_cut&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;adult&quot;</span><span class="p">][</span><span class="s2">&quot;converted_comp&quot;</span><span class="p">]</span>

<span class="n">pingouin</span><span class="o">.</span><span class="n">ttest</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">child_compensation</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">adult_compensation</span><span class="p">,</span>
    <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;greater&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>1.869931</td>
      <td>1966.979249</td>
      <td>greater</td>
      <td>0.030821</td>
      <td>[2531.75, inf]</td>
      <td>0.079522</td>
      <td>0.549</td>
      <td>0.579301</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="example-2-difference-of-means-left-tailed">
<h2>Example 2. Difference of means (left tailed)<a class="headerlink" href="#example-2-difference-of-means-left-tailed" title="Permalink to this heading">#</a></h2>
<section id="id11">
<h3>Context<a class="headerlink" href="#id11" title="Permalink to this heading">#</a></h3>
<p>The late_shipments dataset contains supply chain data on the delivery of medical supplies. Each row represents one delivery of a part. The <strong>late</strong> column denotes whether or not the part was delivered late.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">late_shipments</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="s2">&quot;late_shipments.feather&quot;</span><span class="p">)</span>

<span class="n">late_shipments</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>country</th>
      <th>managed_by</th>
      <th>fulfill_via</th>
      <th>vendor_inco_term</th>
      <th>shipment_mode</th>
      <th>late_delivery</th>
      <th>late</th>
      <th>product_group</th>
      <th>sub_classification</th>
      <th>...</th>
      <th>line_item_quantity</th>
      <th>line_item_value</th>
      <th>pack_price</th>
      <th>unit_price</th>
      <th>manufacturing_site</th>
      <th>first_line_designation</th>
      <th>weight_kilograms</th>
      <th>freight_cost_usd</th>
      <th>freight_cost_groups</th>
      <th>line_item_insurance_usd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>36203.0</td>
      <td>Nigeria</td>
      <td>PMO - US</td>
      <td>Direct Drop</td>
      <td>EXW</td>
      <td>Air</td>
      <td>1.0</td>
      <td>Yes</td>
      <td>HRDT</td>
      <td>HIV test</td>
      <td>...</td>
      <td>2996.0</td>
      <td>266644.00</td>
      <td>89.00</td>
      <td>0.89</td>
      <td>Alere Medical Co., Ltd.</td>
      <td>Yes</td>
      <td>1426.0</td>
      <td>33279.83</td>
      <td>expensive</td>
      <td>373.83</td>
    </tr>
    <tr>
      <th>1</th>
      <td>30998.0</td>
      <td>Botswana</td>
      <td>PMO - US</td>
      <td>Direct Drop</td>
      <td>EXW</td>
      <td>Air</td>
      <td>0.0</td>
      <td>No</td>
      <td>HRDT</td>
      <td>HIV test</td>
      <td>...</td>
      <td>25.0</td>
      <td>800.00</td>
      <td>32.00</td>
      <td>1.60</td>
      <td>Trinity Biotech, Plc</td>
      <td>Yes</td>
      <td>10.0</td>
      <td>559.89</td>
      <td>reasonable</td>
      <td>1.72</td>
    </tr>
    <tr>
      <th>2</th>
      <td>69871.0</td>
      <td>Vietnam</td>
      <td>PMO - US</td>
      <td>Direct Drop</td>
      <td>EXW</td>
      <td>Air</td>
      <td>0.0</td>
      <td>No</td>
      <td>ARV</td>
      <td>Adult</td>
      <td>...</td>
      <td>22925.0</td>
      <td>110040.00</td>
      <td>4.80</td>
      <td>0.08</td>
      <td>Hetero Unit III Hyderabad IN</td>
      <td>Yes</td>
      <td>3723.0</td>
      <td>19056.13</td>
      <td>expensive</td>
      <td>181.57</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17648.0</td>
      <td>South Africa</td>
      <td>PMO - US</td>
      <td>Direct Drop</td>
      <td>DDP</td>
      <td>Ocean</td>
      <td>0.0</td>
      <td>No</td>
      <td>ARV</td>
      <td>Adult</td>
      <td>...</td>
      <td>152535.0</td>
      <td>361507.95</td>
      <td>2.37</td>
      <td>0.04</td>
      <td>Aurobindo Unit III, India</td>
      <td>Yes</td>
      <td>7698.0</td>
      <td>11372.23</td>
      <td>expensive</td>
      <td>779.41</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5647.0</td>
      <td>Uganda</td>
      <td>PMO - US</td>
      <td>Direct Drop</td>
      <td>EXW</td>
      <td>Air</td>
      <td>0.0</td>
      <td>No</td>
      <td>HRDT</td>
      <td>HIV test - Ancillary</td>
      <td>...</td>
      <td>850.0</td>
      <td>8.50</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>Inverness Japan</td>
      <td>Yes</td>
      <td>56.0</td>
      <td>360.00</td>
      <td>reasonable</td>
      <td>0.01</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 27 columns</p>
</div></div></div>
</div>
<p>While trying to determine why some shipments are late, you may wonder if the weight of the shipments that were on time is less than the weight of the shipments that were late.</p>
<p>the <strong>weight_kilograms</strong> variable contains information about the weight of each shipment.</p>
<p>Then the hypothesis would be</p>
<p><span class="math notranslate nohighlight">\(H_0\)</span>: The mean weight of shipments that weren’t late is the same as the mean weight of shipments that were late.
-&gt; <span class="math notranslate nohighlight">\(H_0: \mu_{late} = \mu_{on time}\)</span>
-&gt; <span class="math notranslate nohighlight">\(H_0: \mu_{late} - \mu_{on time} = 0\)</span></p>
<p><span class="math notranslate nohighlight">\(H_1\)</span>: The mean weight of shipments that weren’t late is less than the mean weight of shipments that were late.
-&gt; <span class="math notranslate nohighlight">\(H_1: \mu_{on time} &lt; \mu_{late} \)</span>
-&gt; <span class="math notranslate nohighlight">\(H_1: \mu_{on time} - \mu_{late} &lt; 0\)</span></p>
</section>
<section id="id12">
<h3>Calculating T statistic<a class="headerlink" href="#id12" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xbar</span> <span class="o">=</span> <span class="n">late_shipments</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;late&quot;</span><span class="p">)[</span><span class="s2">&quot;weight_kilograms&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">xbar_no</span> <span class="o">=</span> <span class="n">xbar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">xbar_yes</span> <span class="o">=</span> <span class="n">xbar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">late_shipments</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;late&quot;</span><span class="p">)[</span><span class="s2">&quot;weight_kilograms&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">s_no</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">s_yes</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">late_shipments</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;late&quot;</span><span class="p">)[</span><span class="s2">&quot;weight_kilograms&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">n_no</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">n_yes</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the numerator of the test statistic</span>
<span class="n">numerator</span> <span class="o">=</span> <span class="n">xbar_no</span> <span class="o">-</span> <span class="n">xbar_yes</span>

<span class="c1"># Calculate the denominator of the test statistic</span>
<span class="n">denominator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="p">((</span><span class="n">s_no</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">n_no</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">s_yes</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">n_yes</span><span class="p">)</span> <span class="p">)</span>

<span class="c1"># Calculate the test statistic</span>
<span class="n">t_stat</span> <span class="o">=</span> <span class="n">numerator</span><span class="o">/</span><span class="n">denominator</span>

<span class="n">t_stat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.3936661778766433
</pre></div>
</div>
</div>
</div>
</section>
<section id="id13">
<h3>Calculating P-value<a class="headerlink" href="#id13" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the degrees of freedom</span>
<span class="n">degrees_of_freedom</span> <span class="o">=</span> <span class="n">n_no</span> <span class="o">+</span> <span class="n">n_yes</span> <span class="o">-</span> <span class="mi">2</span>

<span class="c1"># Calculate the p-value from the test stat</span>
<span class="n">p_value</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">t_stat</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="n">degrees_of_freedom</span><span class="p">)</span>

<span class="n">p_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.008432382146249523
</pre></div>
</div>
</div>
</div>
<p>In fact, we can now reject the null hypothesis and conclude that the mean weight for those shipments that were delivered late is higher</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="hypothesis-testing-paired-data">
<h1>Hypothesis testing (paired data)<a class="headerlink" href="#hypothesis-testing-paired-data" title="Permalink to this heading">#</a></h1>
<section id="id14">
<h2>Assumptions for sample size<a class="headerlink" href="#id14" title="Permalink to this heading">#</a></h2>
<p>This tests falls into the category of <em><strong>paired-sample t-tests</strong></em> and the assumptions for this category are that we have <em><strong>at least 30 pairs of observations across the samples</strong></em></p>
<p>No. of rows in our data <span class="math notranslate nohighlight">\(\geq 30\)</span></p>
</section>
<section id="example-1-difference-of-means-left-tailed">
<h2>Example 1. Difference of means (left tailed)<a class="headerlink" href="#example-1-difference-of-means-left-tailed" title="Permalink to this heading">#</a></h2>
<section id="id15">
<h3>Context<a class="headerlink" href="#id15" title="Permalink to this heading">#</a></h3>
<p>The dataset below, refers to the results for republicans in 2008 and 2012 presidential elections, each row represents a republicans result for presidential elections at a county level</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">republicans</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="s2">&quot;repub_votes_potus_08_12.feather&quot;</span><span class="p">)</span>

<span class="n">republicans</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>county</th>
      <th>repub_percent_08</th>
      <th>repub_percent_12</th>
      <th>diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alabama</td>
      <td>Hale</td>
      <td>38.957877</td>
      <td>37.139882</td>
      <td>1.817995</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Arkansas</td>
      <td>Nevada</td>
      <td>56.726272</td>
      <td>58.983452</td>
      <td>-2.257179</td>
    </tr>
    <tr>
      <th>2</th>
      <td>California</td>
      <td>Lake</td>
      <td>38.896719</td>
      <td>39.331367</td>
      <td>-0.434648</td>
    </tr>
    <tr>
      <th>3</th>
      <td>California</td>
      <td>Ventura</td>
      <td>42.923190</td>
      <td>45.250693</td>
      <td>-2.327503</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Colorado</td>
      <td>Lincoln</td>
      <td>74.522569</td>
      <td>73.764757</td>
      <td>0.757812</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Wisconsin</td>
      <td>Burnett</td>
      <td>48.342541</td>
      <td>52.437478</td>
      <td>-4.094937</td>
    </tr>
    <tr>
      <th>96</th>
      <td>Wisconsin</td>
      <td>La Crosse</td>
      <td>37.490904</td>
      <td>40.577038</td>
      <td>-3.086134</td>
    </tr>
    <tr>
      <th>97</th>
      <td>Wisconsin</td>
      <td>Lafayette</td>
      <td>38.104967</td>
      <td>41.675050</td>
      <td>-3.570083</td>
    </tr>
    <tr>
      <th>98</th>
      <td>Wyoming</td>
      <td>Weston</td>
      <td>76.684241</td>
      <td>83.983328</td>
      <td>-7.299087</td>
    </tr>
    <tr>
      <th>99</th>
      <td>Alaska</td>
      <td>District 34</td>
      <td>77.063259</td>
      <td>40.789626</td>
      <td>36.273633</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 5 columns</p>
</div></div></div>
</div>
<p>Given this dataset, the question is:</p>
<p>Was the percentage of republican candidate votes <em><strong>lower in 2008 than in 2012?</strong></em></p>
<p><span class="math notranslate nohighlight">\(H_{0}: \mu_{2008} - \mu_{2012} = 0\)</span></p>
<p><span class="math notranslate nohighlight">\(H_{1}: \mu_{2008} - \mu_{2012} &lt; 0\)</span></p>
<p>let´s use a significance level of 0.05</p>
<p>One detail of this dataset is that 2008 and 2012 votes are <em><strong>paired</strong></em> meaning they are <em><strong>not independant</strong></em></p>
<p>and we want to capture voting patterns in the model</p>
<p>now, for paired analysis, rather than considering the two variables separatedly, we can consider a single variable of the difference. Let´s store that difference in a dataframe called <em><strong>sample_data</strong></em> and the variable called <em><strong>diff</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_data</span> <span class="o">=</span> <span class="n">republicans</span>

<span class="n">sample_data</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_data</span><span class="p">[</span><span class="s2">&quot;repub_percent_08&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">sample_data</span><span class="p">[</span><span class="s2">&quot;repub_percent_12&quot;</span><span class="p">]</span>

<span class="n">sample_data</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: &gt;
</pre></div>
</div>
<img alt="../_images/c2d68b3cab85c78d47008073a198c20d85d80101abc41c1a8f5173bd7873e655.png" src="../_images/c2d68b3cab85c78d47008073a198c20d85d80101abc41c1a8f5173bd7873e655.png" />
</div>
</div>
<p>in the histogram, you can notice that most values are between -10 and 0, including an outlier</p>
<p>now let´s calculate the <em><strong>sample mean</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xbar_diff</span> <span class="o">=</span> <span class="n">sample_data</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">xbar_diff</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.877109041242944
</pre></div>
</div>
</div>
</div>
<p>now, we can restate the hypothesis in terms of <span class="math notranslate nohighlight">\(\mu_{diff}\)</span></p>
<p><span class="math notranslate nohighlight">\(H_{0}: \mu_{diff} = 0\)</span></p>
<p><span class="math notranslate nohighlight">\(H_{1}: \mu_{diff} &lt; 0\)</span></p>
</section>
<section id="id16">
<h3>Calculating T statistic<a class="headerlink" href="#id16" title="Permalink to this heading">#</a></h3>
<p>the t statistic in this case has a slightly variation, the equation in this case would be</p>
<p><span class="math notranslate nohighlight">\(t = \frac{\bar{x}_{diff} - \mu_{diff}}{\sqrt{\frac{s^2_{diff}}{n_{diff}}}}\)</span></p>
<p>and also, in this case we know one statistic. Then, the numbers of degrees of freedoms would be the number of records minus one</p>
<p>dof = ndiff - 1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculating t</span>

<span class="n">n_diff</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_data</span><span class="p">)</span>

<span class="n">s_diff</span> <span class="o">=</span> <span class="n">sample_data</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="n">t_stat</span> <span class="o">=</span> <span class="p">(</span><span class="n">xbar_diff</span> <span class="o">-</span> <span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">s_diff</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">n_diff</span><span class="p">)</span>

<span class="n">t_stat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-5.601043121928489
</pre></div>
</div>
</div>
</div>
</section>
<section id="id17">
<h3>Calculating P value<a class="headerlink" href="#id17" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_value</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">t_stat</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="n">n_diff</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">p_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.572537285272411e-08
</pre></div>
</div>
</div>
</div>
<p>This means we can reject the null hypothesis and can conclude that the percentage of votes for republicans was lower in 2008 compared to 2012.</p>
</section>
<section id="solving-with-pingouin">
<h3>solving with pingouin<a class="headerlink" href="#solving-with-pingouin" title="Permalink to this heading">#</a></h3>
<p>The pingouin package provides methods for hypothesis testing and provides an output as a pandas dataframe.</p>
<p>The method that we will use is ttest</p>
<ul class="simple">
<li><p>The first argument is the series of differences</p></li>
<li><p>The argument y specifies the hypothesized difference value from the null hypothesis (in this case is zero)</p></li>
<li><p>The alternative hypothesis can be specified as “two-sided” for two tailed tests, “less” for left tailed tests or “greater” for right tailed tests</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pingouin</span><span class="o">.</span><span class="n">ttest</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">sample_data</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">],</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="s2">&quot;less&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>-5.601043</td>
      <td>99</td>
      <td>less</td>
      <td>9.572537e-08</td>
      <td>[-inf, -2.02]</td>
      <td>0.560104</td>
      <td>1.323e+05</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>And you can see that the result is the same, null hypothesis is rejected</p>
</section>
<section id="pingouin-variation-of-t-test-for-paired-data">
<h3>pingouin variation of t-test for paired data<a class="headerlink" href="#pingouin-variation-of-t-test-for-paired-data" title="Permalink to this heading">#</a></h3>
<p>pingouin offers a variation that requires even less work, which is useful for paired data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pingouin</span><span class="o">.</span><span class="n">ttest</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">sample_data</span><span class="p">[</span><span class="s2">&quot;repub_percent_08&quot;</span><span class="p">],</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">sample_data</span><span class="p">[</span><span class="s2">&quot;repub_percent_12&quot;</span><span class="p">],</span>
    <span class="n">paired</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>    <span class="c1">#this argument is very important for paired data</span>
    <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;less&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>-5.601043</td>
      <td>99</td>
      <td>less</td>
      <td>9.572537e-08</td>
      <td>[-inf, -2.02]</td>
      <td>0.217364</td>
      <td>1.323e+05</td>
      <td>0.696338</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="example-2-difference-of-means-two-tailed">
<h2>Example 2. Difference of means (two-tailed)<a class="headerlink" href="#example-2-difference-of-means-two-tailed" title="Permalink to this heading">#</a></h2>
<section id="id18">
<h3>Context<a class="headerlink" href="#id18" title="Permalink to this heading">#</a></h3>
<p>The dataset below, refers to the results for democrats in 2012 and 2016 presidential elections, each row represents democrats result for presidential elections at a county level</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">democrats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="s2">&quot;dem_votes_potus_12_16.feather&quot;</span><span class="p">)</span>

<span class="n">democrats</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>county</th>
      <th>dem_percent_12</th>
      <th>dem_percent_16</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alabama</td>
      <td>Bullock</td>
      <td>76.305900</td>
      <td>74.946921</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alabama</td>
      <td>Chilton</td>
      <td>19.453671</td>
      <td>15.847352</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Alabama</td>
      <td>Clay</td>
      <td>26.673672</td>
      <td>18.674517</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Alabama</td>
      <td>Cullman</td>
      <td>14.661752</td>
      <td>10.028252</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Alabama</td>
      <td>Escambia</td>
      <td>36.915731</td>
      <td>31.020546</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You’ll explore the difference between the proportion of county-level votes for the Democratic candidate in 2012 and 2016 to identify if the difference is significant. The hypotheses are as follows:</p>
<p><span class="math notranslate nohighlight">\(H_0\)</span> : The proportion of democratic votes in 2012 and 2016 were the same.
<span class="math notranslate nohighlight">\(H_1\)</span> : The proportion of democratic votes in 2012 and 2016 were different.</p>
</section>
<section id="id19">
<h3>Solving with pingouin<a class="headerlink" href="#id19" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pingouin</span><span class="o">.</span><span class="n">ttest</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">democrats</span><span class="p">[</span><span class="s1">&#39;dem_percent_12&#39;</span><span class="p">],</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">democrats</span><span class="p">[</span><span class="s1">&#39;dem_percent_16&#39;</span><span class="p">],</span>
    <span class="n">paired</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="s2">&quot;two-sided&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>30.298384</td>
      <td>499</td>
      <td>two-sided</td>
      <td>3.600634e-115</td>
      <td>[6.39, 7.27]</td>
      <td>0.454202</td>
      <td>2.246e+111</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>then, you can reject the null hypothesis</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="hypothesis-test-anova">
<h1>Hypothesis test (ANOVA)<a class="headerlink" href="#hypothesis-test-anova" title="Permalink to this heading">#</a></h1>
<section id="id20">
<h2>Assumptions for sample size<a class="headerlink" href="#id20" title="Permalink to this heading">#</a></h2>
<p>Since ANOVA compares a numerical value across multiple categories (three or more), we need <em><strong>at least 30 observations in each sample</strong></em> to fulfill the assumption</p>
<p><span class="math notranslate nohighlight">\(n_i \geq 30\)</span> for all values of <span class="math notranslate nohighlight">\(i\)</span></p>
</section>
<section id="when-to-use-anova">
<h2>When to use ANOVA<a class="headerlink" href="#when-to-use-anova" title="Permalink to this heading">#</a></h2>
<p>ANOVA tests are used when you want to compare the behavior of a numerical variable between three or more groups</p>
<p>let’s analyze two variables from the stack_overflow dataset</p>
<ul class="simple">
<li><p><em><strong>job_sat:</strong></em> describes how satisfied are people with their jobs</p></li>
<li><p><em><strong>converted_comp</strong></em> shows compensation in USD</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stack_overflow</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="s2">&quot;stack_overflow.feather&quot;</span><span class="p">)</span>

<span class="n">stack_overflow</span><span class="p">[[</span><span class="s2">&quot;job_sat&quot;</span><span class="p">,</span> <span class="s2">&quot;converted_comp&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>job_sat</th>
      <th>converted_comp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Slightly satisfied</td>
      <td>77556.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Very satisfied</td>
      <td>74970.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Very satisfied</td>
      <td>594539.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Very satisfied</td>
      <td>2000000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Very satisfied</td>
      <td>37816.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A hypothesis question could be:</p>
<p>Is compensation different across the levels of satisfaction?</p>
<p>The first step is to visualize it in a boxplot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;converted_comp&quot;</span><span class="p">],</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;job_sat&quot;</span><span class="p">],</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">stack_overflow</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8c6ff1035cb71952420e29145cfa483983c707a0653477de7eac737733a253f5.png" src="../_images/8c6ff1035cb71952420e29145cfa483983c707a0653477de7eac737733a253f5.png" />
</div>
</div>
<p>And it looks nice, but let’s remove the outliers to see the distribution better</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;converted_comp&quot;</span><span class="p">],</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;job_sat&quot;</span><span class="p">],</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">,</span>
    <span class="n">showfliers</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8711d2325cfe3e17fbb934e587bf4d91fde46454c9852e1725b4628874d65487.png" src="../_images/8711d2325cfe3e17fbb934e587bf4d91fde46454c9852e1725b4628874d65487.png" />
</div>
</div>
<p>And looks like there are differences, but are these statistically significant?</p>
<p>Let’s test it using the <em><strong>pingouin.anova method</strong></em>, using a <em><strong>significance level of 0.2</strong></em></p>
</section>
<section id="pingouin-anova-method">
<h2>pingouin.anova() method<a class="headerlink" href="#pingouin-anova-method" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pingouin</span><span class="o">.</span><span class="n">anova</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">,</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="s2">&quot;converted_comp&quot;</span><span class="p">,</span>              <span class="c1">#Dependant Variable</span>
    <span class="n">between</span><span class="o">=</span> <span class="s2">&quot;job_sat&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source</th>
      <th>ddof1</th>
      <th>ddof2</th>
      <th>F</th>
      <th>p-unc</th>
      <th>np2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>job_sat</td>
      <td>4</td>
      <td>2256</td>
      <td>4.480485</td>
      <td>0.001315</td>
      <td>0.007882</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This p-value is 0.0013, which is less than 0.2, that indicates that at least two categories of <em><strong>job satisfaction</strong></em> have significant differences between their compensation levels</p>
<p><em><strong>BUT THIS DOESN’T TELL US WHICH TWO CATEGORIES THEY ARE</strong></em></p>
<p>to identify which categories are different, you have to compare all the categories as shown below:</p>
<p><img alt="Picture title" src="../_images/image-20230220-080955.png" /></p>
</section>
<section id="pairwise-tests">
<h2>pairwise tests<a class="headerlink" href="#pairwise-tests" title="Permalink to this heading">#</a></h2>
<p>To do this, let’s use a pairwise test</p>
<p><em>notice that the three first arguments are the same as ANOVA test, we will discuss the p-adjust shortly</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pingouin</span><span class="o">.</span><span class="n">pairwise_tests</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">,</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="s2">&quot;converted_comp&quot;</span><span class="p">,</span>
    <span class="n">between</span><span class="o">=</span> <span class="s2">&quot;job_sat&quot;</span><span class="p">,</span>
    <span class="n">padjust</span><span class="o">=</span> <span class="s2">&quot;none&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Contrast</th>
      <th>A</th>
      <th>B</th>
      <th>Paired</th>
      <th>Parametric</th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-unc</th>
      <th>BF10</th>
      <th>hedges</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>job_sat</td>
      <td>Slightly satisfied</td>
      <td>Very satisfied</td>
      <td>False</td>
      <td>True</td>
      <td>-4.009935</td>
      <td>1478.622799</td>
      <td>two-sided</td>
      <td>0.000064</td>
      <td>158.564</td>
      <td>-0.192931</td>
    </tr>
    <tr>
      <th>1</th>
      <td>job_sat</td>
      <td>Slightly satisfied</td>
      <td>Neither</td>
      <td>False</td>
      <td>True</td>
      <td>-0.700752</td>
      <td>258.204546</td>
      <td>two-sided</td>
      <td>0.484088</td>
      <td>0.114</td>
      <td>-0.068513</td>
    </tr>
    <tr>
      <th>2</th>
      <td>job_sat</td>
      <td>Slightly satisfied</td>
      <td>Very dissatisfied</td>
      <td>False</td>
      <td>True</td>
      <td>-1.243665</td>
      <td>187.153329</td>
      <td>two-sided</td>
      <td>0.215179</td>
      <td>0.208</td>
      <td>-0.145624</td>
    </tr>
    <tr>
      <th>3</th>
      <td>job_sat</td>
      <td>Slightly satisfied</td>
      <td>Slightly dissatisfied</td>
      <td>False</td>
      <td>True</td>
      <td>-0.038264</td>
      <td>569.926329</td>
      <td>two-sided</td>
      <td>0.969491</td>
      <td>0.074</td>
      <td>-0.002719</td>
    </tr>
    <tr>
      <th>4</th>
      <td>job_sat</td>
      <td>Very satisfied</td>
      <td>Neither</td>
      <td>False</td>
      <td>True</td>
      <td>1.662901</td>
      <td>328.326639</td>
      <td>two-sided</td>
      <td>0.097286</td>
      <td>0.337</td>
      <td>0.120115</td>
    </tr>
    <tr>
      <th>5</th>
      <td>job_sat</td>
      <td>Very satisfied</td>
      <td>Very dissatisfied</td>
      <td>False</td>
      <td>True</td>
      <td>0.747379</td>
      <td>221.666205</td>
      <td>two-sided</td>
      <td>0.455627</td>
      <td>0.126</td>
      <td>0.063479</td>
    </tr>
    <tr>
      <th>6</th>
      <td>job_sat</td>
      <td>Very satisfied</td>
      <td>Slightly dissatisfied</td>
      <td>False</td>
      <td>True</td>
      <td>3.076222</td>
      <td>821.303063</td>
      <td>two-sided</td>
      <td>0.002166</td>
      <td>7.43</td>
      <td>0.173247</td>
    </tr>
    <tr>
      <th>7</th>
      <td>job_sat</td>
      <td>Neither</td>
      <td>Very dissatisfied</td>
      <td>False</td>
      <td>True</td>
      <td>-0.545948</td>
      <td>321.165726</td>
      <td>two-sided</td>
      <td>0.585481</td>
      <td>0.135</td>
      <td>-0.058537</td>
    </tr>
    <tr>
      <th>8</th>
      <td>job_sat</td>
      <td>Neither</td>
      <td>Slightly dissatisfied</td>
      <td>False</td>
      <td>True</td>
      <td>0.602209</td>
      <td>367.730081</td>
      <td>two-sided</td>
      <td>0.547406</td>
      <td>0.118</td>
      <td>0.055707</td>
    </tr>
    <tr>
      <th>9</th>
      <td>job_sat</td>
      <td>Very dissatisfied</td>
      <td>Slightly dissatisfied</td>
      <td>False</td>
      <td>True</td>
      <td>1.129951</td>
      <td>247.570187</td>
      <td>two-sided</td>
      <td>0.259590</td>
      <td>0.197</td>
      <td>0.119131</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If we analyze the output, in the p-unc column, we will notice that <em><strong>three of them are less than our significance level of 0.2</strong></em></p>
<p>Note that for pairwise tests, as the number of groups increase, the number of pairs increase cuadratically (in this case we got 10 pairs out of 5 groups)</p>
<img src="image-20230220-082222.png"  width="500" height="300"><section id="false-positive-danger">
<h3>false positive danger<a class="headerlink" href="#false-positive-danger" title="Permalink to this heading">#</a></h3>
<p>And if the pairs increases cuadratically, the number of hypothesis tests we must perform increases cuadratically.</p>
<p>Now, performing a lot of hypothesis tests increase the <em><strong>probability of getting a false positive</strong></em> significant result, the chart below shows the probability of a false positive vs the amount of hypothesis tests ran</p>
<p><img alt="Picture title" src="../_images/image-20230220-083226.png" /></p>
<p>Note that:</p>
<ul class="simple">
<li><p>with a significance level of 0.2, running one test, the probability of a false positive is approximately 0.2!</p></li>
<li><p>with 5 groups (which means 10 tests), the probability of false positive is around 0.7!</p></li>
<li><p>with 20 groups, it’s almost guaranteed that you will have at least one false positive!</p></li>
</ul>
<p><em><strong>The solution to this problem</strong></em></p>
<p>The solution for this problem of getting a false positive is to apply an adjustment to increase the p-values (and therefore reducing the probability of false positive)</p>
<ul class="simple">
<li><p>one common adjustment is the bonferroni correction</p></li>
</ul>
</section>
<section id="p-value-adjustment-bonferroni">
<h3>p -value adjustment (bonferroni)<a class="headerlink" href="#p-value-adjustment-bonferroni" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pingouin</span><span class="o">.</span><span class="n">pairwise_tests</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">,</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="s2">&quot;converted_comp&quot;</span><span class="p">,</span>
    <span class="n">between</span><span class="o">=</span> <span class="s2">&quot;job_sat&quot;</span><span class="p">,</span>
    <span class="n">padjust</span><span class="o">=</span> <span class="s2">&quot;bonf&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Contrast</th>
      <th>A</th>
      <th>B</th>
      <th>Paired</th>
      <th>Parametric</th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-unc</th>
      <th>p-corr</th>
      <th>p-adjust</th>
      <th>BF10</th>
      <th>hedges</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>job_sat</td>
      <td>Slightly satisfied</td>
      <td>Very satisfied</td>
      <td>False</td>
      <td>True</td>
      <td>-4.009935</td>
      <td>1478.622799</td>
      <td>two-sided</td>
      <td>0.000064</td>
      <td>0.000638</td>
      <td>bonf</td>
      <td>158.564</td>
      <td>-0.192931</td>
    </tr>
    <tr>
      <th>1</th>
      <td>job_sat</td>
      <td>Slightly satisfied</td>
      <td>Neither</td>
      <td>False</td>
      <td>True</td>
      <td>-0.700752</td>
      <td>258.204546</td>
      <td>two-sided</td>
      <td>0.484088</td>
      <td>1.000000</td>
      <td>bonf</td>
      <td>0.114</td>
      <td>-0.068513</td>
    </tr>
    <tr>
      <th>2</th>
      <td>job_sat</td>
      <td>Slightly satisfied</td>
      <td>Very dissatisfied</td>
      <td>False</td>
      <td>True</td>
      <td>-1.243665</td>
      <td>187.153329</td>
      <td>two-sided</td>
      <td>0.215179</td>
      <td>1.000000</td>
      <td>bonf</td>
      <td>0.208</td>
      <td>-0.145624</td>
    </tr>
    <tr>
      <th>3</th>
      <td>job_sat</td>
      <td>Slightly satisfied</td>
      <td>Slightly dissatisfied</td>
      <td>False</td>
      <td>True</td>
      <td>-0.038264</td>
      <td>569.926329</td>
      <td>two-sided</td>
      <td>0.969491</td>
      <td>1.000000</td>
      <td>bonf</td>
      <td>0.074</td>
      <td>-0.002719</td>
    </tr>
    <tr>
      <th>4</th>
      <td>job_sat</td>
      <td>Very satisfied</td>
      <td>Neither</td>
      <td>False</td>
      <td>True</td>
      <td>1.662901</td>
      <td>328.326639</td>
      <td>two-sided</td>
      <td>0.097286</td>
      <td>0.972864</td>
      <td>bonf</td>
      <td>0.337</td>
      <td>0.120115</td>
    </tr>
    <tr>
      <th>5</th>
      <td>job_sat</td>
      <td>Very satisfied</td>
      <td>Very dissatisfied</td>
      <td>False</td>
      <td>True</td>
      <td>0.747379</td>
      <td>221.666205</td>
      <td>two-sided</td>
      <td>0.455627</td>
      <td>1.000000</td>
      <td>bonf</td>
      <td>0.126</td>
      <td>0.063479</td>
    </tr>
    <tr>
      <th>6</th>
      <td>job_sat</td>
      <td>Very satisfied</td>
      <td>Slightly dissatisfied</td>
      <td>False</td>
      <td>True</td>
      <td>3.076222</td>
      <td>821.303063</td>
      <td>two-sided</td>
      <td>0.002166</td>
      <td>0.021659</td>
      <td>bonf</td>
      <td>7.43</td>
      <td>0.173247</td>
    </tr>
    <tr>
      <th>7</th>
      <td>job_sat</td>
      <td>Neither</td>
      <td>Very dissatisfied</td>
      <td>False</td>
      <td>True</td>
      <td>-0.545948</td>
      <td>321.165726</td>
      <td>two-sided</td>
      <td>0.585481</td>
      <td>1.000000</td>
      <td>bonf</td>
      <td>0.135</td>
      <td>-0.058537</td>
    </tr>
    <tr>
      <th>8</th>
      <td>job_sat</td>
      <td>Neither</td>
      <td>Slightly dissatisfied</td>
      <td>False</td>
      <td>True</td>
      <td>0.602209</td>
      <td>367.730081</td>
      <td>two-sided</td>
      <td>0.547406</td>
      <td>1.000000</td>
      <td>bonf</td>
      <td>0.118</td>
      <td>0.055707</td>
    </tr>
    <tr>
      <th>9</th>
      <td>job_sat</td>
      <td>Very dissatisfied</td>
      <td>Slightly dissatisfied</td>
      <td>False</td>
      <td>True</td>
      <td>1.129951</td>
      <td>247.570187</td>
      <td>two-sided</td>
      <td>0.259590</td>
      <td>1.000000</td>
      <td>bonf</td>
      <td>0.197</td>
      <td>0.119131</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now, if we analyze the p-corr column, which is the adjusted p-value, we will note that only two of the pairs have an statistically significant difference</p>
<p>Great! p-value adjustment is the solution for when you have a ton of pairs!</p>
<p>pingouin offers many other options for adjusting the p-values, some are more conservative than others.</p>
<img src="image-20230220-084003.png"  width="400">
</section>
</section>
<section id="example-2-anova-three-categories">
<h2>Example 2 ANOVA (three categories)<a class="headerlink" href="#example-2-anova-three-categories" title="Permalink to this heading">#</a></h2>
<p>Given the late shipments data, let’s analyze how the price of each package (pack_price) varies between the three shipment modes (shipment_mode): “Air”, “Air Charter”, and “Ocean”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">late_shipments</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="s2">&quot;late_shipments.feather&quot;</span><span class="p">)</span>

<span class="n">late_shipments</span><span class="p">[[</span><span class="s2">&quot;shipment_mode&quot;</span><span class="p">,</span> <span class="s2">&quot;pack_price&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>shipment_mode</th>
      <th>pack_price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Air</td>
      <td>89.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Air</td>
      <td>32.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Air</td>
      <td>4.80</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ocean</td>
      <td>2.37</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Air</td>
      <td>0.01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><span class="math notranslate nohighlight">\(H_0\)</span>: Pack prices for every category of shipment mode are the same.</p>
<p><span class="math notranslate nohighlight">\(H_1\)</span>: Pack prices for some categories of shipment mode are different.</p>
<p><span class="math notranslate nohighlight">\(\alpha = 0.1\)</span></p>
<section id="checking-sample-size-assumptions">
<h3>Checking sample size assumptions<a class="headerlink" href="#checking-sample-size-assumptions" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Count the shipment_mode values</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">late_shipments</span><span class="p">[</span><span class="s2">&quot;shipment_mode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="c1"># Print the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>

<span class="c1"># Inspect whether the counts are big enough</span>
<span class="nb">print</span><span class="p">((</span><span class="n">counts</span> <span class="o">&gt;=</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Air            905
Ocean           88
Air Charter      6
Name: shipment_mode, dtype: int64
False
</pre></div>
</div>
</div>
</div>
<p>The assumptions are not met for that Air Charter category, therefore, we should be a little cautious of the results given that small sample size.</p>
</section>
<section id="exploratory-data-analysis-per-group">
<h3>Exploratory Data Analysis per Group<a class="headerlink" href="#exploratory-data-analysis-per-group" title="Permalink to this heading">#</a></h3>
<p>let’s explore first with the average price for each group</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">late_shipments</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;shipment_mode&quot;</span><span class="p">)[</span><span class="s2">&quot;pack_price&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>shipment_mode
Air            39.712395
Air Charter     4.226667
Ocean           6.432273
Name: pack_price, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Looks like the air is way more expensive than the other two categories</p>
<p>let’s see the dispersion as well:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">late_shipments</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;shipment_mode&quot;</span><span class="p">)[</span><span class="s1">&#39;pack_price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>shipment_mode
Air            48.932861
Air Charter     0.992969
Ocean           5.303047
Name: pack_price, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>data for “air” is more dispersed</p>
<p>Now let’s see the boxplots:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">late_shipments</span><span class="p">[</span><span class="s2">&quot;pack_price&quot;</span><span class="p">],</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">late_shipments</span><span class="p">[</span><span class="s2">&quot;shipment_mode&quot;</span><span class="p">],</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">late_shipments</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9f120b895634138846e649b74a29e81d8179a9ef652b27836931eb333f279e6b.png" src="../_images/9f120b895634138846e649b74a29e81d8179a9ef652b27836931eb333f279e6b.png" />
</div>
</div>
<p>Great, now let’s see if this difference statistically significant</p>
</section>
<section id="conducting-anova">
<h3>Conducting ANOVA<a class="headerlink" href="#conducting-anova" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pingouin</span><span class="o">.</span><span class="n">anova</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">late_shipments</span><span class="p">,</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="s2">&quot;pack_price&quot;</span><span class="p">,</span>              <span class="c1">#Dependant Variable</span>
    <span class="n">between</span><span class="o">=</span> <span class="s2">&quot;shipment_mode&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source</th>
      <th>ddof1</th>
      <th>ddof2</th>
      <th>F</th>
      <th>p-unc</th>
      <th>np2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>shipment_mode</td>
      <td>2</td>
      <td>997</td>
      <td>21.8646</td>
      <td>5.089479e-10</td>
      <td>0.042018</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>the p-unc (p value) indicates that there is difference between at least one pair, let’s perform pairwise tests to confirm which pairs are these</p>
</section>
<section id="id21">
<h3>Pairwise tests<a class="headerlink" href="#id21" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pingouin</span><span class="o">.</span><span class="n">pairwise_tests</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">late_shipments</span><span class="p">,</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="s2">&quot;pack_price&quot;</span><span class="p">,</span>
    <span class="n">between</span> <span class="o">=</span> <span class="s2">&quot;shipment_mode&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Contrast</th>
      <th>A</th>
      <th>B</th>
      <th>Paired</th>
      <th>Parametric</th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-unc</th>
      <th>BF10</th>
      <th>hedges</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>shipment_mode</td>
      <td>Air</td>
      <td>Air Charter</td>
      <td>False</td>
      <td>True</td>
      <td>21.179625</td>
      <td>600.685682</td>
      <td>two-sided</td>
      <td>8.748346e-75</td>
      <td>5.809e+76</td>
      <td>0.726592</td>
    </tr>
    <tr>
      <th>1</th>
      <td>shipment_mode</td>
      <td>Air</td>
      <td>Ocean</td>
      <td>False</td>
      <td>True</td>
      <td>19.335760</td>
      <td>986.979785</td>
      <td>two-sided</td>
      <td>6.934555e-71</td>
      <td>1.129e+67</td>
      <td>0.711119</td>
    </tr>
    <tr>
      <th>2</th>
      <td>shipment_mode</td>
      <td>Air Charter</td>
      <td>Ocean</td>
      <td>False</td>
      <td>True</td>
      <td>-3.170654</td>
      <td>35.615026</td>
      <td>two-sided</td>
      <td>3.123012e-03</td>
      <td>15.277</td>
      <td>-0.423775</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>without adjustment, the p value in each test indicates that there is a significant difference between all the pairs, let’s see the results again with the adjustment</p>
</section>
<section id="id22">
<h3>P-value adjustment (bonferroni)<a class="headerlink" href="#id22" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pingouin</span><span class="o">.</span><span class="n">pairwise_tests</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">late_shipments</span><span class="p">,</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="s2">&quot;pack_price&quot;</span><span class="p">,</span>
    <span class="n">between</span> <span class="o">=</span> <span class="s2">&quot;shipment_mode&quot;</span><span class="p">,</span>
    <span class="n">padjust</span> <span class="o">=</span> <span class="s2">&quot;bonf&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Contrast</th>
      <th>A</th>
      <th>B</th>
      <th>Paired</th>
      <th>Parametric</th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-unc</th>
      <th>p-corr</th>
      <th>p-adjust</th>
      <th>BF10</th>
      <th>hedges</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>shipment_mode</td>
      <td>Air</td>
      <td>Air Charter</td>
      <td>False</td>
      <td>True</td>
      <td>21.179625</td>
      <td>600.685682</td>
      <td>two-sided</td>
      <td>8.748346e-75</td>
      <td>2.624504e-74</td>
      <td>bonf</td>
      <td>5.809e+76</td>
      <td>0.726592</td>
    </tr>
    <tr>
      <th>1</th>
      <td>shipment_mode</td>
      <td>Air</td>
      <td>Ocean</td>
      <td>False</td>
      <td>True</td>
      <td>19.335760</td>
      <td>986.979785</td>
      <td>two-sided</td>
      <td>6.934555e-71</td>
      <td>2.080367e-70</td>
      <td>bonf</td>
      <td>1.129e+67</td>
      <td>0.711119</td>
    </tr>
    <tr>
      <th>2</th>
      <td>shipment_mode</td>
      <td>Air Charter</td>
      <td>Ocean</td>
      <td>False</td>
      <td>True</td>
      <td>-3.170654</td>
      <td>35.615026</td>
      <td>two-sided</td>
      <td>3.123012e-03</td>
      <td>9.369037e-03</td>
      <td>bonf</td>
      <td>15.277</td>
      <td>-0.423775</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>adjusted p-value shows similar results, all the p-values are smaller than 0.1!</p>
<p>then we can conclude:</p>
<p>for the pairs below, we can reject the null hypothesis that the pack prices are equal:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mu_{air} &gt; \mu_{air-charter}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mu_{air} &gt; \mu_{ocean}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mu_{ocean} &gt;\mu_{air-charter}\)</span></p></li>
</ul>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="hypothesis-test-tests-for-proportions">
<h1>Hypothesis test (tests for proportions)<a class="headerlink" href="#hypothesis-test-tests-for-proportions" title="Permalink to this heading">#</a></h1>
<p>when you refer to hypothesis tests for proportions,</p>
<p><span class="math notranslate nohighlight">\(p\)</span> is the population proportion (unknown parameter)</p>
<p><span class="math notranslate nohighlight">\(\hat{p}\)</span> is the sample proportion (sample statistic)</p>
<p><span class="math notranslate nohighlight">\(p_0\)</span> is the hypothesized population proportion</p>
<p>Now, when performing the hypothesis testing, the test statistic is:</p>
<p><span class="math notranslate nohighlight">\(z = \frac{\hat{p} - p_0}{\sqrt{\frac{p_0 * (1 - p_0)}{n}}}\)</span></p>
<section id="id23">
<h2>Assumptions for sample size<a class="headerlink" href="#id23" title="Permalink to this heading">#</a></h2>
<p>Since this is a <em><strong>one-sample proportion test</strong></em>, the number of successes and the number of failures in sample is greater than or equal to 10</p>
<p><span class="math notranslate nohighlight">\(n * \hat{p} \geq 10\)</span></p>
<p><span class="math notranslate nohighlight">\(n * (1 - \hat{p}) \geq 10\)</span></p>
<p><span class="math notranslate nohighlight">\(n\)</span>: sample size
<span class="math notranslate nohighlight">\(\hat{p}\)</span>: proportion of successes in sample</p>
</section>
<section id="example-1-two-tailed-test">
<h2>Example 1 (two-tailed test)<a class="headerlink" href="#example-1-two-tailed-test" title="Permalink to this heading">#</a></h2>
<section id="id24">
<h3>Context<a class="headerlink" href="#id24" title="Permalink to this heading">#</a></h3>
<p>Returning to the stack overflow survey, let’s hypothesize that half of the users are under thirty</p>
<p><span class="math notranslate nohighlight">\(H_0\)</span> : Proportions of stackoverflow users under thirty = 0.5</p>
<p><span class="math notranslate nohighlight">\(H_1\)</span> : Proportions of stackoverflow users under thirty <span class="math notranslate nohighlight">\(\neq\)</span> 0.5</p>
<p><span class="math notranslate nohighlight">\(\alpha\)</span> = 0.01</p>
<p>let’s check the sample first</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;age_cat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Under 30       0.535604
At least 30    0.464396
Name: age_cat, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>given this information, let’s check our hypothesis</p>
</section>
<section id="calculate-z-score">
<h3>Calculate z score<a class="headerlink" href="#calculate-z-score" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_hat</span> <span class="o">=</span> <span class="p">(</span><span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;age_cat&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Under 30&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">p_0</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">stack_overflow</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_hat</span> <span class="o">-</span> <span class="n">p_0</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="p">(</span><span class="n">p_0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_0</span><span class="p">))</span><span class="o">/</span> <span class="n">n</span> <span class="p">)</span>

<span class="n">z_score</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.385911440783663
</pre></div>
</div>
</div>
</div>
</section>
<section id="id25">
<h3>Calculating p-value<a class="headerlink" href="#id25" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#substract from 1 since p-value is positive</span>
<span class="n">p_value</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z_score</span><span class="p">))</span> 

<span class="n">p_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0007094227368100725
</pre></div>
</div>
</div>
</div>
<p>Since the p_value is less than the alpha, then we can reject the null hypothesis</p>
</section>
</section>
<section id="example-2-right-tailed-test">
<h2>Example 2 (right tailed test)<a class="headerlink" href="#example-2-right-tailed-test" title="Permalink to this heading">#</a></h2>
<p>Given the late shipments dataset, let’s Hypothesize that the proportion of late shipments is greater than 6%.</p>
<p>H_0 = proportion of late shipments is 6%.</p>
<p>H_1 = proportion of late shipments is greater than 6%.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">late_shipments</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="s2">&quot;late_shipments.feather&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="checking-for-sample-size-assumptions">
<h3>Checking for sample size assumptions<a class="headerlink" href="#checking-for-sample-size-assumptions" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Count the late values</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">late_shipments</span><span class="p">[</span><span class="s2">&quot;late&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="c1"># Print the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>

<span class="c1"># Inspect whether the counts are big enough</span>
<span class="nb">print</span><span class="p">((</span><span class="n">counts</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No     939
Yes     61
Name: late, dtype: int64
True
</pre></div>
</div>
</div>
</div>
<p>Since there are more than 10 successes and failures, assumptions are fulfilled</p>
</section>
<section id="id26">
<h3>Calculating z-score<a class="headerlink" href="#id26" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hypothesize that the proportion of late shipments is 6%</span>
<span class="n">p_0</span> <span class="o">=</span> <span class="mf">0.06</span>

<span class="c1"># Calculate the sample proportion of late shipments</span>
<span class="n">p_hat</span> <span class="o">=</span> <span class="p">(</span><span class="n">late_shipments</span><span class="p">[</span><span class="s1">&#39;late&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Yes&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Calculate the sample size</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">late_shipments</span><span class="p">)</span>

<span class="c1"># Calculate the numerator and denominator of the test statistic</span>
<span class="n">numerator</span> <span class="o">=</span> <span class="n">p_hat</span> <span class="o">-</span> <span class="n">p_0</span>
<span class="n">denominator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p_0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_0</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>

<span class="c1"># Calculate the test statistic</span>
<span class="n">z_score</span> <span class="o">=</span> <span class="n">numerator</span> <span class="o">/</span> <span class="n">denominator</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id27">
<h3>Calculating p-value<a class="headerlink" href="#id27" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the p-value from the z-score</span>
<span class="n">p_value</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z_score</span><span class="p">)</span>

<span class="c1"># Print the p-value</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p_value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.44703503936503364
</pre></div>
</div>
</div>
</div>
<p>then, we failed to reject the null hypothesis</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="hypothesis-test-tests-for-differences-of-proportions">
<h1>Hypothesis test (tests for differences of proportions)<a class="headerlink" href="#hypothesis-test-tests-for-differences-of-proportions" title="Permalink to this heading">#</a></h1>
<section id="id28">
<h2>Assumptions for sample size<a class="headerlink" href="#id28" title="Permalink to this heading">#</a></h2>
<p>Since this is a <em><strong>two-sample proportion test</strong></em>, the number of successes and the number of failures in each sample is greater than or equal to 10</p>
<p><span class="math notranslate nohighlight">\(n_1 * \hat{p}_1 \geq 10\)</span>
<span class="math notranslate nohighlight">\(n_2 * \hat{p}_2 \geq 10\)</span></p>
<p><span class="math notranslate nohighlight">\(n_1 * (1 - \hat{p}_1) \geq 10\)</span>
<span class="math notranslate nohighlight">\(n_2 * (1 - \hat{p}_2) \geq 10\)</span></p>
<p><span class="math notranslate nohighlight">\(n\)</span>: sample size
<span class="math notranslate nohighlight">\(\hat{p}\)</span>: proportion of successes in sample</p>
</section>
<section id="example-1-two-tailed">
<h2>Example 1 (two-tailed)<a class="headerlink" href="#example-1-two-tailed" title="Permalink to this heading">#</a></h2>
<section id="id29">
<h3>Context<a class="headerlink" href="#id29" title="Permalink to this heading">#</a></h3>
<p>In the stack overflow dataset, there is a variable called hobbyist</p>
<p>the value “yes” indicates that the users considers themselves as a  hobbyist and “no” indicates that they consider themselves as professionals</p>
<p><span class="math notranslate nohighlight">\(H_0\)</span>: proportion of hobbyist users is the same for those under thirty as those at leats thirty
<span class="math notranslate nohighlight">\(H_0\)</span>: <span class="math notranslate nohighlight">\(p_{\geq 30} - p_{&lt; 30} = 0 \)</span></p>
<p><span class="math notranslate nohighlight">\(H_1\)</span>: proportion of hobbyist users is different for those unnder thirty as those at leats thirty
<span class="math notranslate nohighlight">\(H_0\)</span>: <span class="math notranslate nohighlight">\(p_{\geq 30} - p_{&lt; 30} \neq 0 \)</span></p>
<p><span class="math notranslate nohighlight">\(\alpha\)</span> = 0.05</p>
<p>exploring the proportions between the age categories, we get:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stack_overflow</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;age_cat&quot;</span><span class="p">)[</span><span class="s2">&quot;hobbyist&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>age_cat      hobbyist
At least 30  Yes         0.773333
             No          0.226667
Under 30     Yes         0.843105
             No          0.156895
Name: hobbyist, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>but, is it statistically significant?</p>
</section>
<section id="calculating-the-z-score">
<h3>Calculating the Z score<a class="headerlink" href="#calculating-the-z-score" title="Permalink to this heading">#</a></h3>
<p><img alt="Picture title" src="../_images/image-20230221-085439.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_hats</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;age_cat&quot;</span><span class="p">)[</span><span class="s2">&quot;hobbyist&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">p_hats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>age_cat      hobbyist
At least 30  Yes         0.773333
             No          0.226667
Under 30     Yes         0.843105
             No          0.156895
Name: hobbyist, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_hat_at_least_30</span> <span class="o">=</span> <span class="n">p_hats</span><span class="p">[(</span><span class="s2">&quot;At least 30&quot;</span><span class="p">,</span> <span class="s2">&quot;Yes&quot;</span><span class="p">)]</span>

<span class="n">p_hat_under_30</span> <span class="o">=</span> <span class="n">p_hats</span><span class="p">[(</span><span class="s2">&quot;Under 30&quot;</span><span class="p">,</span> <span class="s2">&quot;Yes&quot;</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">p_hat_at_least_30</span><span class="p">,</span> <span class="n">p_hat_under_30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7733333333333333 0.8431048720066061
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;age_cat&quot;</span><span class="p">)[</span><span class="s2">&quot;hobbyist&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

<span class="n">n</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>age_cat
At least 30    1050
Under 30       1211
Name: hobbyist, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_at_least_30</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="s2">&quot;At least 30&quot;</span><span class="p">]</span>

<span class="n">n_under_30</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="s2">&quot;Under 30&quot;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">n_at_least_30</span><span class="p">,</span> <span class="n">n_under_30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1050 1211
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculating p_hat</span>

<span class="n">p_hat</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">n_at_least_30</span> <span class="o">*</span> <span class="n">p_hat_at_least_30</span> <span class="o">+</span> <span class="n">n_under_30</span> <span class="o">*</span> <span class="n">p_hat_under_30</span><span class="p">)</span><span class="o">/</span>
    <span class="p">(</span><span class="n">n_at_least_30</span> <span class="o">+</span> <span class="n">n_under_30</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># calculating standard error</span>
<span class="n">std_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p_hat</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_hat</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_at_least_30</span> <span class="o">+</span> 
                    <span class="n">p_hat</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_hat</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_under_30</span><span class="p">)</span>

<span class="c1"># calculating z-score</span>
<span class="n">z_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_hat_at_least_30</span> <span class="o">-</span> <span class="n">p_hat_under_30</span><span class="p">)</span> <span class="o">/</span> <span class="n">std_error</span>
<span class="n">z_score</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-4.223691463320559
</pre></div>
</div>
</div>
</div>
</section>
<section id="id30">
<h3>Calculating p-value<a class="headerlink" href="#id30" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># p-value for two sided test</span>
<span class="mi">2</span> <span class="o">*</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z_score</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.403330142685068e-05
</pre></div>
</div>
</div>
</div>
<p>Therefore, we can reject the null hypothesis</p>
</section>
<section id="calculating-with-statsmodels">
<h3>Calculating with statsmodels<a class="headerlink" href="#calculating-with-statsmodels" title="Permalink to this heading">#</a></h3>
<p>This function requires two arguments:</p>
<ul class="simple">
<li><p>the number of hobbyists in each category</p></li>
<li><p>the total number of rows in each group</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stack_overflow</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;age_cat&quot;</span><span class="p">)[</span><span class="s2">&quot;hobbyist&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>age_cat      hobbyist
At least 30  Yes          812
             No           238
Under 30     Yes         1021
             No           190
Name: hobbyist, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_hobbyists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">812</span><span class="p">,</span> <span class="mi">1021</span><span class="p">])</span>

<span class="n">n_hobbyists</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 812, 1021])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">812</span> <span class="o">+</span> <span class="mi">238</span><span class="p">,</span> <span class="mi">1021</span> <span class="o">+</span> <span class="mi">190</span><span class="p">])</span>

<span class="n">n_rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1050, 1211])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.stats.proportion</span> <span class="kn">import</span> <span class="n">proportions_ztest</span>

<span class="n">z_score</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">proportions_ztest</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="n">n_hobbyists</span><span class="p">,</span>
 <span class="n">nobs</span><span class="o">=</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;two-sided&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">z_score</span><span class="p">,</span> <span class="n">p_value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-4.223691463320559 2.403330142685068e-05
</pre></div>
</div>
</div>
</div>
<p>the p-value is smaller than our alpha, meaning that we can reject the null hypothesis</p>
</section>
</section>
<section id="example-2-right-tailed">
<h2>Example 2 (right tailed)<a class="headerlink" href="#example-2-right-tailed" title="Permalink to this heading">#</a></h2>
<section id="id31">
<h3>Context<a class="headerlink" href="#id31" title="Permalink to this heading">#</a></h3>
<p>You may wonder if the amount paid for freight affects whether or not the shipment was late. Recall that in the late_shipments dataset, whether or not the shipment was late is stored in the <em><strong>late</strong></em> column. Freight costs are stored in the <em><strong>freight_cost_group</strong></em> column, and the categories are “expensive” and “reasonable”</p>
<p>The hypotheses to test, with “late” corresponding to the proportion of late shipments for that group, are</p>
<p><span class="math notranslate nohighlight">\(H_{0}: late_{expensive} - late_{reasonable} = 0\)</span>
<span class="math notranslate nohighlight">\(H_{1}: late_{expensive} - late_{reasonable} &gt; 0\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_hats</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">late_shipments</span><span class="o">.</span>
    <span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;freight_cost_groups&quot;</span><span class="p">)[</span><span class="s2">&quot;late&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">p_hats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>freight_cost_groups  late
expensive            Yes     0.079096
reasonable           Yes     0.035165
Name: late, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sample size</span>
<span class="n">ns</span> <span class="o">=</span> <span class="n">late_shipments</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;freight_cost_groups&quot;</span><span class="p">)[</span><span class="s2">&quot;late&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

<span class="n">ns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>freight_cost_groups
expensive     531
reasonable    455
Name: late, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Now that we have the p hats and the n, let’s calculate the p-hat</p>
<p><img alt="Picture title" src="../_images/image-20230221-105843.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_hat</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">p_hats</span><span class="p">[</span><span class="s2">&quot;reasonable&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">ns</span><span class="p">[</span><span class="s2">&quot;reasonable&quot;</span><span class="p">]</span> <span class="o">+</span>
     <span class="n">p_hats</span><span class="p">[</span><span class="s2">&quot;expensive&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">ns</span><span class="p">[</span><span class="s2">&quot;expensive&quot;</span><span class="p">])</span> <span class="o">/</span> 
    <span class="p">(</span><span class="n">ns</span><span class="p">[</span><span class="s2">&quot;reasonable&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">ns</span><span class="p">[</span><span class="s2">&quot;expensive&quot;</span><span class="p">])</span>
<span class="p">)</span>

<span class="n">p_hat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>late
Yes    0.058824
Name: late, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>now that we have the p_hat, let’s calculate the standard error of the sample as follows:</p>
<p><img alt="Picture title" src="../_images/image-20230221-122036.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the standard error</span>
<span class="n">std_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
    <span class="p">(</span> <span class="p">(</span> <span class="n">p_hat</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_hat</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">ns</span><span class="p">[</span><span class="s2">&quot;expensive&quot;</span><span class="p">]</span> <span class="p">)</span><span class="o">+</span>
    <span class="p">(</span> <span class="p">(</span> <span class="n">p_hat</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_hat</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">ns</span><span class="p">[</span><span class="s2">&quot;reasonable&quot;</span><span class="p">]</span> <span class="p">)</span>
<span class="p">)</span>

<span class="n">std_error</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>late
Yes    0.015031
Name: late, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="id32">
<h3>Calculating Z score<a class="headerlink" href="#id32" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_hats</span><span class="p">[</span><span class="s2">&quot;expensive&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">p_hats</span><span class="p">[</span><span class="s2">&quot;reasonable&quot;</span><span class="p">])</span><span class="o">/</span><span class="n">std_error</span>

<span class="n">z_score</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>late
Yes    2.922649
Name: late, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="id33">
<h3>Calculating p value<a class="headerlink" href="#id33" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Right tailed test</span>
<span class="n">p_value</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z_score</span><span class="p">)</span>

<span class="n">p_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.00173534])
</pre></div>
</div>
</div>
</div>
<p>With this p-value we can reject the null hypothesis and conclude that the proportion of late deliveries for expensive-priced shipments is greater than the proportion for reasonable-priced shipments</p>
</section>
<section id="calculating-with-statmodels">
<h3>Calculating with statmodels<a class="headerlink" href="#calculating-with-statmodels" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Count the late column values for each freight_cost_group</span>
<span class="n">late_by_freight_cost_group</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">late_shipments</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;freight_cost_groups&quot;</span><span class="p">)[</span><span class="s2">&quot;late&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">success_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>freight_cost_groups  late
expensive            No      489
                     Yes      42
reasonable           No      439
                     Yes      16
Name: late, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">success_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">late_by_freight_cost_group</span><span class="p">[(</span><span class="s2">&quot;expensive&quot;</span><span class="p">,</span><span class="s2">&quot;Yes&quot;</span><span class="p">)],</span>
        <span class="n">late_by_freight_cost_group</span><span class="p">[(</span><span class="s2">&quot;reasonable&quot;</span><span class="p">,</span><span class="s2">&quot;Yes&quot;</span><span class="p">)]</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">success_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([42, 16])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="n">late_by_freight_cost_group</span><span class="p">[</span><span class="s2">&quot;expensive&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
    <span class="n">late_by_freight_cost_group</span><span class="p">[</span><span class="s2">&quot;reasonable&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="p">])</span>

<span class="n">n</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([531, 455])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">proportions_ztest</span><span class="p">(</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">success_counts</span><span class="p">,</span>
    <span class="n">nobs</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="s2">&quot;larger&quot;</span>

<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="n">p_value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.922648567784529 0.001735340002359578
</pre></div>
</div>
</div>
</div>
<p>And we got the same results, same p-value!</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="chi-squared-tests-of-independance">
<h1>Chi Squared Tests of independance<a class="headerlink" href="#chi-squared-tests-of-independance" title="Permalink to this heading">#</a></h1>
<section id="id34">
<h2>Assumptions for sample size<a class="headerlink" href="#id34" title="Permalink to this heading">#</a></h2>
<p>The number of successes and failures in each group is greater that or equal to 5</p>
<p><span class="math notranslate nohighlight">\(n_1 * \hat{p}_i \geq 5\)</span></p>
<p><span class="math notranslate nohighlight">\(n_1 * (1 - \hat{p}_i) \geq 5\)</span></p>
<p><span class="math notranslate nohighlight">\(n_i\)</span>: sample size for group <span class="math notranslate nohighlight">\(i\)</span></p>
<p><span class="math notranslate nohighlight">\(\hat{p}\)</span>: proportion of successes in sample group <span class="math notranslate nohighlight">\(i\)</span></p>
</section>
<section id="example-1">
<h2>Example 1<a class="headerlink" href="#example-1" title="Permalink to this heading">#</a></h2>
<p>This test measures the <em><strong>independance between two categorical variables</strong></em></p>
<p>Two categorical variables are statistically independant when the proportion of successes in the response variable is the same across all the categories of the explanatory variable</p>
<p>let’s use the pingouin package to determine if the “hobbyist” and “age_cat” variables from the stack_overflow survey datasetare independant</p>
<p><span class="math notranslate nohighlight">\(H_0 :\)</span> Age categories are independent of hobbyist autoperception
<span class="math notranslate nohighlight">\(H_1 :\)</span> Age categories are not independent of hobbyist autoperception</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">props</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">stack_overflow</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;hobbyist&quot;</span><span class="p">)[</span><span class="s2">&quot;age_cat&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">wide_props</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>

<span class="n">wide_props</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">stacked</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: xlabel=&#39;hobbyist&#39;&gt;
</pre></div>
</div>
<img alt="../_images/9d6dbb0bc96c951dc6ebaad4a97cd6811809e0ccc39ccb988d4074678782cb84.png" src="../_images/9d6dbb0bc96c951dc6ebaad4a97cd6811809e0ccc39ccb988d4074678782cb84.png" />
</div>
</div>
<p>This chart may suggest that the variables are not indepentant, because looks like the proportion of hobbyists is higher in people under 30.</p>
<p><em><strong>Let’s confirm if these variables are statistically independant</strong></em></p>
<p><em><strong>Calculating degrees of freedom</strong></em></p>
<p>in this case, there are two categorical variables with two categories each, then the degrees of freedom are calculated:</p>
<p><span class="math notranslate nohighlight">\(dof =\)</span> (No. of response categories - 1) x (No. of explanatory categories - 1)
<span class="math notranslate nohighlight">\(dof = (2-1)*(2-1) = 1\)</span></p>
<p><em><strong>Yates’ continuity correction</strong></em></p>
<p>Is a correction only applied when the <em><strong>sample size is very small</strong></em> and the <em><strong>degrees of freedom is one</strong></em>. Carefull!, the only way to apply it is if <span class="math notranslate nohighlight">\(dof = 1\)</span>, otherwise, it won’t be applied by default</p>
<p>In this case, since <em><strong>each group has over 1000 observations, we don’t need it here</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expected</span><span class="p">,</span> <span class="n">observed</span><span class="p">,</span> <span class="n">stats</span> <span class="o">=</span> <span class="n">pingouin</span><span class="o">.</span><span class="n">chi2_independence</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;hobbyist&quot;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;age_cat&quot;</span><span class="p">,</span>
    <span class="n">correction</span><span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span>

<span class="n">stats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>test</th>
      <th>lambda</th>
      <th>chi2</th>
      <th>dof</th>
      <th>pval</th>
      <th>cramer</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>pearson</td>
      <td>1.000000</td>
      <td>17.387820</td>
      <td>1.0</td>
      <td>0.000030</td>
      <td>0.087694</td>
      <td>0.986444</td>
    </tr>
    <tr>
      <th>1</th>
      <td>cressie-read</td>
      <td>0.666667</td>
      <td>17.366950</td>
      <td>1.0</td>
      <td>0.000031</td>
      <td>0.087642</td>
      <td>0.986357</td>
    </tr>
    <tr>
      <th>2</th>
      <td>log-likelihood</td>
      <td>0.000000</td>
      <td>17.351288</td>
      <td>1.0</td>
      <td>0.000031</td>
      <td>0.087602</td>
      <td>0.986291</td>
    </tr>
    <tr>
      <th>3</th>
      <td>freeman-tukey</td>
      <td>-0.500000</td>
      <td>17.362338</td>
      <td>1.0</td>
      <td>0.000031</td>
      <td>0.087630</td>
      <td>0.986338</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mod-log-likelihood</td>
      <td>-1.000000</td>
      <td>17.392980</td>
      <td>1.0</td>
      <td>0.000030</td>
      <td>0.087707</td>
      <td>0.986466</td>
    </tr>
    <tr>
      <th>5</th>
      <td>neyman</td>
      <td>-2.000000</td>
      <td>17.513563</td>
      <td>1.0</td>
      <td>0.000029</td>
      <td>0.088011</td>
      <td>0.986958</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><em><strong>This extremely low value for p value suggests that the variables are not independent</strong></em> since the null hypothesis has been rejected</p>
</section>
<section id="example-2">
<h2>Example 2<a class="headerlink" href="#example-2" title="Permalink to this heading">#</a></h2>
<p>The stack overflow dataset contains a variable called <em><strong>job_sat</strong></em> which measures job satisfaction and another called <em><strong>age_cat</strong></em> which says if people is under 30 or not.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;age_cat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Under 30       1211
At least 30    1050
Name: age_cat, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;job_sat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Very satisfied           879
Slightly satisfied       680
Slightly dissatisfied    342
Neither                  201
Very dissatisfied        159
Name: job_sat, dtype: int64
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(H_0 :\)</span> Age categories are independent of job satisfaction levels
<span class="math notranslate nohighlight">\(H_1 :\)</span> Age categories are not independent of job satisfaction levels</p>
<p><span class="math notranslate nohighlight">\(\alpha = 0.1\)</span></p>
<p>btw age category is the response variable and job satisfaction is the explanatory variable</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">props</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">stack_overflow</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;job_sat&quot;</span><span class="p">)[</span><span class="s2">&quot;age_cat&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">wide_props</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>

<span class="n">wide_props</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">stacked</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: xlabel=&#39;job_sat&#39;&gt;
</pre></div>
</div>
<img alt="../_images/d5922a4e87e6b268ab796c7c5c6d1fc0381505ec1f8d02076fa633cc7b03406a.png" src="../_images/d5922a4e87e6b268ab796c7c5c6d1fc0381505ec1f8d02076fa633cc7b03406a.png" />
</div>
</div>
<p>From this chart we may think:</p>
<ul class="simple">
<li><p>if the proportions are too close in each category <em><strong>the variables are independent</strong></em></p></li>
<li><p>if the proportions are too different, <em><strong>the variables are not independent</strong></em></p></li>
</ul>
<p>this chart suggests that the difference is not that big, and we may consider that variables are independent</p>
<p>In this case, we have to perform the chi-squared test to see if the variables are statistically independent</p>
<p><em><strong>Calculate degrees of freedom</strong></em></p>
<p>in this case, there are two categorical variables with two categories each, then the degrees of freedom are calculated:</p>
<p><span class="math notranslate nohighlight">\(dof =\)</span> (No. of response categories - 1) x (No. of explanatory categories - 1)
<span class="math notranslate nohighlight">\(dof = (2-1)*(5-1) = 4\)</span></p>
<p><em><strong>Since we have 4 dof, we don’t care about yate’s correction,</strong></em> it is only applied by default when dof = 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expected</span><span class="p">,</span> <span class="n">observed</span><span class="p">,</span> <span class="n">stats</span> <span class="o">=</span> <span class="n">pingouin</span><span class="o">.</span><span class="n">chi2_independence</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;job_sat&quot;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;age_cat&quot;</span><span class="p">,</span>
    <span class="n">correction</span><span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span>

<span class="n">stats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>test</th>
      <th>lambda</th>
      <th>chi2</th>
      <th>dof</th>
      <th>pval</th>
      <th>cramer</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>pearson</td>
      <td>1.000000</td>
      <td>5.552373</td>
      <td>4.0</td>
      <td>0.235164</td>
      <td>0.049555</td>
      <td>0.437417</td>
    </tr>
    <tr>
      <th>1</th>
      <td>cressie-read</td>
      <td>0.666667</td>
      <td>5.554106</td>
      <td>4.0</td>
      <td>0.235014</td>
      <td>0.049563</td>
      <td>0.437545</td>
    </tr>
    <tr>
      <th>2</th>
      <td>log-likelihood</td>
      <td>0.000000</td>
      <td>5.558529</td>
      <td>4.0</td>
      <td>0.234632</td>
      <td>0.049583</td>
      <td>0.437871</td>
    </tr>
    <tr>
      <th>3</th>
      <td>freeman-tukey</td>
      <td>-0.500000</td>
      <td>5.562688</td>
      <td>4.0</td>
      <td>0.234274</td>
      <td>0.049601</td>
      <td>0.438178</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mod-log-likelihood</td>
      <td>-1.000000</td>
      <td>5.567570</td>
      <td>4.0</td>
      <td>0.233854</td>
      <td>0.049623</td>
      <td>0.438538</td>
    </tr>
    <tr>
      <th>5</th>
      <td>neyman</td>
      <td>-2.000000</td>
      <td>5.579519</td>
      <td>4.0</td>
      <td>0.232828</td>
      <td>0.049676</td>
      <td>0.439419</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Since p value is not smaller than <span class="math notranslate nohighlight">\(\alpha\)</span>, we failed to reject <span class="math notranslate nohighlight">\(H_0\)</span> and yes, variables are independent!</p>
</section>
<section id="example-3">
<h2>Example 3<a class="headerlink" href="#example-3" title="Permalink to this heading">#</a></h2>
<p>In the <em><strong>late_shipments</strong></em> dataset, there is a variable called <em><strong>vendor_inco_term</strong></em> that describes the incoterms applied to a shipment</p>
<p><em><strong>incoterms:</strong></em> Trade deals often use a form of business shorthand in order to specify the exact details of their contract. These are International Chamber of Commerce (ICC) international commercial terms, or incoterms for short.</p>
<p>The options are:</p>
<p>EXW: “Ex works”. The buyer pays for transportation of the goods.
CIP: “Carriage and insurance paid to”. The seller pays for freight and insurance until the goods board a ship.
DDP: “Delivered duty paid”. The seller pays for transportation of the goods until they reach a destination port.
FCA: “Free carrier”. The seller pays for transportation of the goods.</p>
<p>Also, remember that the <em><strong>freight_cost_group</strong></em> explains wether a shipment is expensive or not.</p>
<p><em><strong>Perhaps the incoterms affect whether or not the freight costs are expensive. Test these hypotheses with a significance level of 0.01.</strong></em></p>
<section id="checking-sample-size-assumption">
<h3>Checking sample size assumption<a class="headerlink" href="#checking-sample-size-assumption" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove that DDU for convenience (it&#39;s only one)</span>
<span class="n">late_shipments</span> <span class="o">=</span> <span class="n">late_shipments</span><span class="p">[</span><span class="n">late_shipments</span><span class="p">[</span><span class="s2">&quot;vendor_inco_term&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;DDU&quot;</span><span class="p">]</span>

<span class="c1"># Count the values of freight_cost_group grouped by vendor_inco_term</span>
<span class="n">counts</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">late_shipments</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;vendor_inco_term&quot;</span><span class="p">)[</span><span class="s2">&quot;freight_cost_groups&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="p">)</span>
<span class="c1"># Print the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>

<span class="c1"># Inspect whether the counts are big enough</span>
<span class="nb">print</span><span class="p">((</span><span class="n">counts</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vendor_inco_term  freight_cost_groups
CIP               reasonable              34
                  expensive               16
DDP               expensive               55
                  reasonable              45
EXW               expensive              423
                  reasonable             302
FCA               reasonable              73
                  expensive               37
Name: freight_cost_groups, dtype: int64
True
</pre></div>
</div>
</div>
</div>
<p>Note that each group has at least 5 successes and at least 5 failures, so the assumptions are fulfilled</p>
</section>
<section id="exploring-variable-independance">
<h3>Exploring variable independance<a class="headerlink" href="#exploring-variable-independance" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">props</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">late_shipments</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;vendor_inco_term&quot;</span><span class="p">)[</span><span class="s2">&quot;freight_cost_groups&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">wide_props</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>

<span class="n">wide_props</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">stacked</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: xlabel=&#39;vendor_inco_term&#39;&gt;
</pre></div>
</div>
<img alt="../_images/bc7bc44d5feaadd96606bd98ae50348fada6b1e7d68bfc5a9611374cc417df75.png" src="../_images/bc7bc44d5feaadd96606bd98ae50348fada6b1e7d68bfc5a9611374cc417df75.png" />
</div>
</div>
<p>Looks like these two variables are definitely not independent, but let’s test that:</p>
</section>
<section id="performing-chi-squared-test">
<h3>Performing chi squared test<a class="headerlink" href="#performing-chi-squared-test" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expected</span><span class="p">,</span> <span class="n">observed</span><span class="p">,</span> <span class="n">stats</span> <span class="o">=</span> <span class="n">pingouin</span><span class="o">.</span><span class="n">chi2_independence</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">late_shipments</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;vendor_inco_term&quot;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;freight_cost_groups&quot;</span>
<span class="p">)</span>

<span class="n">stats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>test</th>
      <th>lambda</th>
      <th>chi2</th>
      <th>dof</th>
      <th>pval</th>
      <th>cramer</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>pearson</td>
      <td>1.000000</td>
      <td>33.642600</td>
      <td>3.0</td>
      <td>2.357026e-07</td>
      <td>0.183511</td>
      <td>0.999424</td>
    </tr>
    <tr>
      <th>1</th>
      <td>cressie-read</td>
      <td>0.666667</td>
      <td>33.632598</td>
      <td>3.0</td>
      <td>2.368510e-07</td>
      <td>0.183484</td>
      <td>0.999423</td>
    </tr>
    <tr>
      <th>2</th>
      <td>log-likelihood</td>
      <td>0.000000</td>
      <td>33.895008</td>
      <td>3.0</td>
      <td>2.084919e-07</td>
      <td>0.184198</td>
      <td>0.999466</td>
    </tr>
    <tr>
      <th>3</th>
      <td>freeman-tukey</td>
      <td>-0.500000</td>
      <td>34.349001</td>
      <td>3.0</td>
      <td>1.672011e-07</td>
      <td>0.185428</td>
      <td>0.999533</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mod-log-likelihood</td>
      <td>-1.000000</td>
      <td>35.037928</td>
      <td>3.0</td>
      <td>1.195978e-07</td>
      <td>0.187278</td>
      <td>0.999620</td>
    </tr>
    <tr>
      <th>5</th>
      <td>neyman</td>
      <td>-2.000000</td>
      <td>37.199484</td>
      <td>3.0</td>
      <td>4.175225e-08</td>
      <td>0.192968</td>
      <td>0.999802</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Finally, we reject the null hypothesis and conclude that these two variables are not independent, they are definitely associated</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="chi-squared-goodness-of-fit-tests">
<h1>Chi squared goodness of fit tests<a class="headerlink" href="#chi-squared-goodness-of-fit-tests" title="Permalink to this heading">#</a></h1>
<section id="id35">
<h2>Example 1<a class="headerlink" href="#id35" title="Permalink to this heading">#</a></h2>
<p>This test allows to check if a data proportion fits to your proportion assumption or not.</p>
<p>Example:
In the stack overflow dataset, there is a variable called <em><strong>Purple link</strong></em>, this variable measures how users felt when they noticed that clicked the purple link (purple link is literally the first link you get when you google a coding question)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">purple_link_counts</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;purple_link&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;purple_link&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;n&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;purple_link&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">purple_link_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>purple_link</th>
      <th>n</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Amused</td>
      <td>368</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Annoyed</td>
      <td>263</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Hello, old friend</td>
      <td>1225</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Indifferent</td>
      <td>405</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>that is the original distribution for that answer, which measures what the person felt when noticed that clicked in the purple_link</p>
<p><em><strong>Declaring Hypothesis</strong></em></p>
<p>let’s hypothesize that half of the users would respond “Hello, old friend” and the rest would respond the other three options with the same probability</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hypothesized</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;purple_link&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Amused&quot;</span><span class="p">,</span> <span class="s2">&quot;Annoyed&quot;</span><span class="p">,</span> <span class="s2">&quot;Hello, old friend&quot;</span><span class="p">,</span> <span class="s2">&quot;Indifferent&quot;</span><span class="p">],</span>
    <span class="s2">&quot;prop&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">]</span>
<span class="p">})</span>

<span class="n">hypothesized</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>purple_link</th>
      <th>prop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Amused</td>
      <td>0.166667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Annoyed</td>
      <td>0.166667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Hello, old friend</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Indifferent</td>
      <td>0.166667</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Like this</p>
<p>Now, our hypotheses would be</p>
<p><span class="math notranslate nohighlight">\(H_0: \)</span> the sample matches the hypothesized distribution</p>
<p><span class="math notranslate nohighlight">\(H_1: \)</span> the sample does not match the hypothesized distribution</p>
<p><span class="math notranslate nohighlight">\(\alpha = 0.01\)</span></p>
<p>let’s visualize the thing</p>
<p>first we need to know how many responses we would have gotten in our hypothetic distribution, then we will compare that with the sample</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">stack_overflow</span><span class="p">)</span>
<span class="n">hypothesized</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hypothesized</span><span class="p">[</span><span class="s2">&quot;prop&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_total</span>

<span class="n">hypothesized</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>purple_link</th>
      <th>prop</th>
      <th>n</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Amused</td>
      <td>0.166667</td>
      <td>376.833333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Annoyed</td>
      <td>0.166667</td>
      <td>376.833333</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Hello, old friend</td>
      <td>0.500000</td>
      <td>1130.500000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Indifferent</td>
      <td>0.166667</td>
      <td>376.833333</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">purple_link_counts</span><span class="p">[</span><span class="s2">&quot;purple_link&quot;</span><span class="p">],</span>
    <span class="n">purple_link_counts</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">],</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Observed&quot;</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">hypothesized</span><span class="p">[</span><span class="s2">&quot;purple_link&quot;</span><span class="p">],</span>
    <span class="n">hypothesized</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">],</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Hypothesized&quot;</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e3eadfa751753894647578ce05524499990a37142723b7e4f47ae1d5becfb710.png" src="../_images/e3eadfa751753894647578ce05524499990a37142723b7e4f47ae1d5becfb710.png" />
</div>
</div>
<p>From the chart we can see that “Amused” and “Indifferent” are similar in terms of hypothesized and observed values, but “Annoyed” and “Hello, old friend” seem different.</p>
<p>But, is that difference statistically significant?</p>
<p><em><strong>Note: this test is called goodness of fit test (PRUEBA DE BONDAD DE AJUSTE) since we are testing how well our hypothesized data fits our actual data</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chisquare</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chisquare</span><span class="p">(</span>
    <span class="n">f_obs</span><span class="o">=</span><span class="n">purple_link_counts</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">],</span>
    <span class="n">f_exp</span><span class="o">=</span><span class="n">hypothesized</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Power_divergenceResult(statistic=44.59840778416629, pvalue=1.1261810719413759e-09)
</pre></div>
</div>
</div>
</div>
<p>Since this p-value is very very small, we reject the null hypothesis and conclude that the sample and the hypothesized distribution are different</p>
</section>
<section id="id36">
<h2>Example 2<a class="headerlink" href="#id36" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove that DDU for convenience (it&#39;s only one)</span>
<span class="n">late_shipments</span> <span class="o">=</span> <span class="n">late_shipments</span><span class="p">[</span><span class="n">late_shipments</span><span class="p">[</span><span class="s2">&quot;vendor_inco_term&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;DDU&quot;</span><span class="p">]</span>

<span class="n">incoterm_counts</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">late_shipments</span><span class="p">[</span><span class="s2">&quot;vendor_inco_term&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;vendor_inco_term&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;n&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;vendor_inco_term&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">incoterm_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>vendor_inco_term</th>
      <th>n</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>CIP</td>
      <td>56</td>
    </tr>
    <tr>
      <th>2</th>
      <td>DDP</td>
      <td>100</td>
    </tr>
    <tr>
      <th>0</th>
      <td>EXW</td>
      <td>732</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FCA</td>
      <td>111</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hypothesized ditribution</span>

<span class="n">hypothesized</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;vendor_inco_term&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;CIP&quot;</span><span class="p">,</span> <span class="s2">&quot;DDP&quot;</span><span class="p">,</span> <span class="s2">&quot;EXW&quot;</span><span class="p">,</span> <span class="s2">&quot;FCA&quot;</span><span class="p">],</span>
    <span class="s2">&quot;prop&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
<span class="p">})</span>

<span class="n">hypothesized</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>vendor_inco_term</th>
      <th>prop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CIP</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>1</th>
      <td>DDP</td>
      <td>0.10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>EXW</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FCA</td>
      <td>0.10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Counts for hypothesized</span>
<span class="n">hypothesized</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hypothesized</span><span class="p">[</span><span class="s2">&quot;prop&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_total</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find the number of rows in late_shipments</span>
<span class="n">n_total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">late_shipments</span><span class="p">)</span>

<span class="c1"># Create n column that is prop column * n_total</span>
<span class="n">hypothesized</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hypothesized</span><span class="p">[</span><span class="s2">&quot;prop&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_total</span>

<span class="c1"># Plot a red bar graph of n vs. vendor_inco_term for incoterm_counts</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">incoterm_counts</span><span class="p">[</span><span class="s2">&quot;vendor_inco_term&quot;</span><span class="p">],</span>
    <span class="n">incoterm_counts</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">],</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observed&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">hypothesized</span><span class="p">[</span><span class="s1">&#39;vendor_inco_term&#39;</span><span class="p">],</span>
    <span class="n">hypothesized</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> 
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observed&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4afcda045edefecb39f9e09c85dd52157b6c461897b511db2e58e00718e7a252.png" src="../_images/4afcda045edefecb39f9e09c85dd52157b6c461897b511db2e58e00718e7a252.png" />
</div>
</div>
<p>As you can see, the distribution matches a lot with our hypothesized values, but is that similarity statistically significant?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gof_test</span> <span class="o">=</span> <span class="n">chisquare</span><span class="p">(</span>
    <span class="n">f_obs</span><span class="o">=</span><span class="n">incoterm_counts</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">],</span>
    <span class="n">f_exp</span><span class="o">=</span><span class="n">hypothesized</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">gof_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Power_divergenceResult(statistic=2.3633633633633613, pvalue=0.5004909543758689)
</pre></div>
</div>
</div>
</div>
<p>Now, note that this p value greater than our significance level, indicates that we failed to reject the null hypothesis and can conclude that the sample fits well to our hypothesized distribution.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="non-parametric-tests">
<h1>NON Parametric tests<a class="headerlink" href="#non-parametric-tests" title="Permalink to this heading">#</a></h1>
<p>What happens if the assumptions considered in the hypothesis testing are not met?</p>
<p>The tests explained before such as</p>
<ul class="simple">
<li><p>z test</p></li>
<li><p>t test</p></li>
<li><p>ANOVA</p></li>
</ul>
<p>are <em><strong>parametric tests</strong></em> and are all based on the assumption that the population is normally distributed</p>
<section id="wilcoxon-signed-rank-test-paired-data">
<h2>Wilcoxon-signed rank test  (Paired data)<a class="headerlink" href="#wilcoxon-signed-rank-test-paired-data" title="Permalink to this heading">#</a></h2>
<p>This test is used for paired data</p>
<p>Given the dataset for election results in the united states for the republicans, let’s hypothesize:</p>
<p><span class="math notranslate nohighlight">\(H_0:\)</span> Percentage of votes in 2008 is not smaller than 2012</p>
<p><span class="math notranslate nohighlight">\(H_1:\)</span> Percentage of votes in 2008 is smaller than 2012</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">repub_votes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="s2">&quot;repub_votes_potus_08_12.feather&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And let’s use a small sample</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">repub_votes_small</span> <span class="o">=</span> <span class="n">repub_votes</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="n">repub_votes_small</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>county</th>
      <th>repub_percent_08</th>
      <th>repub_percent_12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>78</th>
      <td>Texas</td>
      <td>Lampasas</td>
      <td>74.024103</td>
      <td>78.026097</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Illinois</td>
      <td>St. Clair</td>
      <td>38.139394</td>
      <td>41.957544</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Kentucky</td>
      <td>Jessamine</td>
      <td>67.829227</td>
      <td>68.981728</td>
    </tr>
    <tr>
      <th>72</th>
      <td>Tennessee</td>
      <td>Chester</td>
      <td>71.017185</td>
      <td>73.073323</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Washington</td>
      <td>San Juan</td>
      <td>28.088501</td>
      <td>29.365679</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>since this data is paired, let’s try to perform a t-test on this small sample (T TEST IS WRONG BECAUSE THERE IS NO NORMALITY, THIS IS JUST TO DO A DEMONSTRATION)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="n">pingouin</span><span class="o">.</span><span class="n">ttest</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">repub_votes_small</span><span class="p">[</span><span class="s2">&quot;repub_percent_08&quot;</span><span class="p">],</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">repub_votes_small</span><span class="p">[</span><span class="s2">&quot;repub_percent_12&quot;</span><span class="p">],</span>
    <span class="n">paired</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="s2">&quot;less&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>-4.020709</td>
      <td>4</td>
      <td>less</td>
      <td>0.007928</td>
      <td>[-inf, -1.16]</td>
      <td>0.115798</td>
      <td>10.108</td>
      <td>0.07693</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Basically t-test rejeccts the null hypothesis and suggests that</p>
<p><em><strong>vote percentages for 2008 are smaller than percentage for 2012</strong></em></p>
<section id="wicoxon-test-process">
<h3>Wicoxon test process<a class="headerlink" href="#wicoxon-test-process" title="Permalink to this heading">#</a></h3>
<p>There are many different ways to perform tests without the parametric assumptions, Wilcoxon test is one method related to <em><strong>ranks</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">rankdata</span>

<span class="c1"># Creating a list to see it&#39;s ranks</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>ranks are the orderings from smallest to largest, scipy.stats allows to access the ranks of a list</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rankdata</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1., 5., 2., 4., 3.])
</pre></div>
</div>
</div>
</div>
<p>This tests requires us to calculate the absolute differences in the pairs of data and then rank them</p>
<p>Now, let’s explain how it works…</p>
<p><em><strong>First</strong></em>, we take differences in the paired values</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">repub_votes_small</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">repub_votes_small</span><span class="p">[</span><span class="s2">&quot;repub_percent_08&quot;</span><span class="p">]</span> <span class="o">-</span>  <span class="n">repub_votes_small</span><span class="p">[</span><span class="s2">&quot;repub_percent_12&quot;</span><span class="p">]</span>

<span class="n">repub_votes_small</span><span class="p">[[</span><span class="s2">&quot;repub_percent_08&quot;</span><span class="p">,</span> <span class="s2">&quot;repub_percent_12&quot;</span><span class="p">,</span> <span class="s2">&quot;diff&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>repub_percent_08</th>
      <th>repub_percent_12</th>
      <th>diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>78</th>
      <td>74.024103</td>
      <td>78.026097</td>
      <td>-4.001994</td>
    </tr>
    <tr>
      <th>19</th>
      <td>38.139394</td>
      <td>41.957544</td>
      <td>-3.818150</td>
    </tr>
    <tr>
      <th>32</th>
      <td>67.829227</td>
      <td>68.981728</td>
      <td>-1.152501</td>
    </tr>
    <tr>
      <th>72</th>
      <td>71.017185</td>
      <td>73.073323</td>
      <td>-2.056138</td>
    </tr>
    <tr>
      <th>90</th>
      <td>28.088501</td>
      <td>29.365679</td>
      <td>-1.277178</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><em><strong>Next</strong></em>, we take the absolute value of the differences</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">repub_votes_small</span><span class="p">[</span><span class="s2">&quot;abs_diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">repub_votes_small</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>

<span class="n">repub_votes_small</span><span class="p">[[</span><span class="s2">&quot;repub_percent_08&quot;</span><span class="p">,</span> <span class="s2">&quot;repub_percent_12&quot;</span><span class="p">,</span> <span class="s2">&quot;diff&quot;</span><span class="p">,</span> <span class="s2">&quot;abs_diff&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>repub_percent_08</th>
      <th>repub_percent_12</th>
      <th>diff</th>
      <th>abs_diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>78</th>
      <td>74.024103</td>
      <td>78.026097</td>
      <td>-4.001994</td>
      <td>4.001994</td>
    </tr>
    <tr>
      <th>19</th>
      <td>38.139394</td>
      <td>41.957544</td>
      <td>-3.818150</td>
      <td>3.818150</td>
    </tr>
    <tr>
      <th>32</th>
      <td>67.829227</td>
      <td>68.981728</td>
      <td>-1.152501</td>
      <td>1.152501</td>
    </tr>
    <tr>
      <th>72</th>
      <td>71.017185</td>
      <td>73.073323</td>
      <td>-2.056138</td>
      <td>2.056138</td>
    </tr>
    <tr>
      <th>90</th>
      <td>28.088501</td>
      <td>29.365679</td>
      <td>-1.277178</td>
      <td>1.277178</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Then, we rank these absolute differences</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">repub_votes_small</span><span class="p">[</span><span class="s2">&quot;rank_abs_diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rankdata</span><span class="p">(</span><span class="n">repub_votes_small</span><span class="p">[</span><span class="s2">&quot;abs_diff&quot;</span><span class="p">])</span>

<span class="n">repub_votes_small</span><span class="p">[[</span><span class="s2">&quot;repub_percent_08&quot;</span><span class="p">,</span> <span class="s2">&quot;repub_percent_12&quot;</span><span class="p">,</span> <span class="s2">&quot;diff&quot;</span><span class="p">,</span> <span class="s2">&quot;abs_diff&quot;</span><span class="p">,</span><span class="s2">&quot;rank_abs_diff&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>repub_percent_08</th>
      <th>repub_percent_12</th>
      <th>diff</th>
      <th>abs_diff</th>
      <th>rank_abs_diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>78</th>
      <td>74.024103</td>
      <td>78.026097</td>
      <td>-4.001994</td>
      <td>4.001994</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>38.139394</td>
      <td>41.957544</td>
      <td>-3.818150</td>
      <td>3.818150</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>32</th>
      <td>67.829227</td>
      <td>68.981728</td>
      <td>-1.152501</td>
      <td>1.152501</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>72</th>
      <td>71.017185</td>
      <td>73.073323</td>
      <td>-2.056138</td>
      <td>2.056138</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>90</th>
      <td>28.088501</td>
      <td>29.365679</td>
      <td>-1.277178</td>
      <td>1.277178</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Finally, we calculate a test statistic called <strong>W</strong></p>
<p><strong>W</strong> uses the signs of the diff column to split the ranks into two groups:</p>
<ul class="simple">
<li><p>One group for rows with <em>negative differences</em></p></li>
<li><p>One group for rows with <em>positive differences</em></p></li>
</ul>
<p>T_minus is the sum of the ranks with negative differences</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">repub_votes_small</span><span class="p">[</span><span class="n">repub_votes_small</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">][</span><span class="s2">&quot;rank_abs_diff&quot;</span><span class="p">])</span>

<span class="n">T_minus</span> <span class="o">=</span> <span class="nb">sum</span> <span class="p">(</span><span class="n">repub_votes_small</span><span class="p">[</span><span class="n">repub_votes_small</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">][</span><span class="s2">&quot;rank_abs_diff&quot;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">T_minus</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>78    5.0
19    4.0
32    1.0
72    3.0
90    2.0
Name: rank_abs_diff, dtype: float64
15.0
</pre></div>
</div>
</div>
</div>
<p>T_plus is the sum of the ranks with positive differences</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">repub_votes_small</span><span class="p">[</span><span class="n">repub_votes_small</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">][</span><span class="s2">&quot;rank_abs_diff&quot;</span><span class="p">])</span>

<span class="n">T_plus</span> <span class="o">=</span> <span class="nb">sum</span> <span class="p">(</span><span class="n">repub_votes_small</span><span class="p">[</span><span class="n">repub_votes_small</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">][</span><span class="s2">&quot;rank_abs_diff&quot;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">T_plus</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Series([], Name: rank_abs_diff, dtype: float64)
0
</pre></div>
</div>
</div>
</div>
<p>IN THIS EXAMPLE, ALL THE DIFFERENCES ARE NEGATIVE, SO THE T-MINUS IS THE SUM OF ALL RANKS AND THE T-PLUS IS ZERO.</p>
<p>Now, the test statistic W is the smaller of T-minus and T-plus, <em>in this case it is zero</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">T_minus</span><span class="p">,</span> <span class="n">T_plus</span><span class="p">])</span>

<span class="n">W</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<p>Now, we can calculate W and its corresponding p-value using a pingouin method instead of manual calculation.</p>
</section>
<section id="pingouin-wilcoxon">
<h3>pingouin.wilcoxon<a class="headerlink" href="#pingouin-wilcoxon" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">pingouin</span><span class="o">.</span><span class="n">wilcoxon</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">repub_votes_small</span><span class="p">[</span><span class="s2">&quot;repub_percent_08&quot;</span><span class="p">],</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">repub_votes_small</span><span class="p">[</span><span class="s2">&quot;repub_percent_12&quot;</span><span class="p">],</span>
    <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;less&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>W-val</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>RBC</th>
      <th>CLES</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Wilcoxon</th>
      <td>0.0</td>
      <td>less</td>
      <td>0.03125</td>
      <td>-1.0</td>
      <td>0.6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that the W value returned is the same as our manual calculation</p>
<p>How do we compare this value with the obtained from the T-test?</p>
<p>Remember that <em><strong>t-test</strong></em> rejects the null hypothesis and suggests that</p>
<ul class="simple">
<li><p><em><strong>vote percentages for 2008 are not greater than percentage for 2012</strong></em></p></li>
</ul>
<p>But <em><strong>wilcoxon</strong></em> tells us</p>
<ul class="simple">
<li><p><em><strong>There is not enough evidence that vote percentages for 2008 are smaller than percentages for 2012</strong></em> using this small sample of five rows</p></li>
</ul>
</section>
</section>
<section id="wilcoxon-mann-whitney-test-independent-data">
<h2>Wilcoxon-Mann-Whitney test (Independent data)<a class="headerlink" href="#wilcoxon-mann-whitney-test-independent-data" title="Permalink to this heading">#</a></h2>
<p>This test works for independent numeric samples</p>
<p>Also known as the <em><strong>Mann Whitney U test</strong></em></p>
<p>This test also works with ranked data, and it is <em><strong>roughly speaking, a t-test on ranked data</strong></em></p>
<p>Let’s return to the <em><strong>converted compensation</strong></em> vs <em><strong>the age people began coding</strong></em></p>
<p><span class="math notranslate nohighlight">\(H_0:\)</span> Those who code first as children do not have a higher income than those who code first as adults</p>
<p><span class="math notranslate nohighlight">\(H_1:\)</span> Those who code first as children have a higher income than those who code first as adults</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;converted_comp&quot;</span><span class="p">],</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;age_first_code_cut&quot;</span><span class="p">],</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">,</span>
    <span class="n">showfliers</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># removing the outliers just for the chart to look better</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1597907ecfb7b89004cc09680f8e30ef694994b7916b4d99de21549b72cae1e9.png" src="../_images/1597907ecfb7b89004cc09680f8e30ef694994b7916b4d99de21549b72cae1e9.png" />
</div>
</div>
<p>in general, it is visible that people who started coding as childs are better compensated than those who started coding as adults, let’s perform our <em><strong>Wilcoxon-Mann-Whitney</strong></em> test</p>
<p>first, we select just the columns we need:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">age_vs_comp</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">[[</span><span class="s2">&quot;converted_comp&quot;</span><span class="p">,</span> <span class="s2">&quot;age_first_code_cut&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>now, to conduct the Wilcoxon-Mann-Whitney test, we need to convert our data from long to wide format</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">age_vs_comp_wide</span> <span class="o">=</span> <span class="n">age_vs_comp</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;age_first_code_cut&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;converted_comp&quot;</span><span class="p">)</span>

<span class="n">age_vs_comp_wide</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>age_first_code_cut</th>
      <th>adult</th>
      <th>child</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>77556.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>74970.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>594539.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000000.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>37816.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="n">pingouin</span><span class="o">.</span><span class="n">mwu</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">age_vs_comp_wide</span><span class="p">[</span><span class="s2">&quot;child&quot;</span><span class="p">],</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">age_vs_comp_wide</span><span class="p">[</span><span class="s2">&quot;adult&quot;</span><span class="p">],</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="s2">&quot;greater&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>U-val</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>RBC</th>
      <th>CLES</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MWU</th>
      <td>744365.5</td>
      <td>greater</td>
      <td>1.902723e-19</td>
      <td>-0.222516</td>
      <td>0.611258</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>With this very small p-value, we can be sure that people who started coding as childs, earn more money</p>
</section>
<section id="kruskal-wallis-test">
<h2>Kruskal-Wallis test<a class="headerlink" href="#kruskal-wallis-test" title="Permalink to this heading">#</a></h2>
<p>Kruskal-Wallist test is to Wilcoxon-Mann-Whitney test</p>
<p>as</p>
<p>ANOVA is to t-test</p>
<p>Meaning, <em><strong>this is the non parametric way to test a numeric variable across more than two groups</strong></em>.</p>
<p>That is <em><strong>The Kruskall-Wallis</strong></em> test is the non parametric version of ANOVA</p>
<p>let’s use this test to see if there is a difference in converted_comp between job satisfaction groups</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;converted_comp&quot;</span><span class="p">],</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">[</span><span class="s2">&quot;job_sat&quot;</span><span class="p">],</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">,</span>
    <span class="n">showfliers</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># removing the outliers just for the chart to look better</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8711d2325cfe3e17fbb934e587bf4d91fde46454c9852e1725b4628874d65487.png" src="../_images/8711d2325cfe3e17fbb934e587bf4d91fde46454c9852e1725b4628874d65487.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="n">pingouin</span><span class="o">.</span><span class="n">kruskal</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">stack_overflow</span><span class="p">,</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="s2">&quot;converted_comp&quot;</span><span class="p">,</span>
    <span class="n">between</span> <span class="o">=</span> <span class="s2">&quot;job_sat&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Source</th>
      <th>ddof1</th>
      <th>H</th>
      <th>p-unc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Kruskal</th>
      <td>job_sat</td>
      <td>4</td>
      <td>72.814939</td>
      <td>5.772915e-15</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The p-value is very smaller than our significance level, this provides evidence that at least one of the mean compensation totals is different than the others across these five job satisfaction groups</p>
<a style='text-decoration:none;line-height:16px;display:flex;color:#5B5B62;padding:10px;justify-content:end;' href='https://deepnote.com?utm_source=created-in-deepnote-cell&projectId=5d5a8929-1553-437b-8664-b4ebddd14d21' target="_blank">
<img alt='Created in deepnote.com' style='display:inline;max-height:16px;margin:0px;margin-right:7.5px;' src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iODBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgODAgODAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5Hcm91cCAzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkxhbmRpbmciIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJBcnRib2FyZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEyMzUuMDAwMDAwLCAtNzkuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0zIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjM1LjAwMDAwMCwgNzkuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aC0yMCIgZmlsbD0iIzAyNjVCNCIgcG9pbnRzPSIyLjM3NjIzNzYyIDgwIDM4LjA0NzY2NjcgODAgNTcuODIxNzgyMiA3My44MDU3NTkyIDU3LjgyMTc4MjIgMzIuNzU5MjczOSAzOS4xNDAyMjc4IDMxLjY4MzE2ODMiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNS4wMDc3MTgsODAgQzQyLjkwNjIwMDcsNzYuNDU0OTM1OCA0Ny41NjQ5MTY3LDcxLjU0MjI2NzEgNDguOTgzODY2LDY1LjI2MTk5MzkgQzUxLjExMjI4OTksNTUuODQxNTg0MiA0MS42NzcxNzk1LDQ5LjIxMjIyODQgMjUuNjIzOTg0Niw0OS4yMTIyMjg0IEMyNS40ODQ5Mjg5LDQ5LjEyNjg0NDggMjkuODI2MTI5Niw0My4yODM4MjQ4IDM4LjY0NzU4NjksMzEuNjgzMTY4MyBMNzIuODcxMjg3MSwzMi41NTQ0MjUgTDY1LjI4MDk3Myw2Ny42NzYzNDIxIEw1MS4xMTIyODk5LDc3LjM3NjE0NCBMMzUuMDA3NzE4LDgwIFoiIGlkPSJQYXRoLTIyIiBmaWxsPSIjMDAyODY4Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMCwzNy43MzA0NDA1IEwyNy4xMTQ1MzcsMC4yNTcxMTE0MzYgQzYyLjM3MTUxMjMsLTEuOTkwNzE3MDEgODAsMTAuNTAwMzkyNyA4MCwzNy43MzA0NDA1IEM4MCw2NC45NjA0ODgyIDY0Ljc3NjUwMzgsNzkuMDUwMzQxNCAzNC4zMjk1MTEzLDgwIEM0Ny4wNTUzNDg5LDc3LjU2NzA4MDggNTMuNDE4MjY3Nyw3MC4zMTM2MTAzIDUzLjQxODI2NzcsNTguMjM5NTg4NSBDNTMuNDE4MjY3Nyw0MC4xMjg1NTU3IDM2LjMwMzk1NDQsMzcuNzMwNDQwNSAyNS4yMjc0MTcsMzcuNzMwNDQwNSBDMTcuODQzMDU4NiwzNy43MzA0NDA1IDkuNDMzOTE5NjYsMzcuNzMwNDQwNSAwLDM3LjczMDQ0MDUgWiIgaWQ9IlBhdGgtMTkiIGZpbGw9IiMzNzkzRUYiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+' > </img>
Created in <span style='font-weight:600;margin-left:4px;'>Deepnote</span></a></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./6-3-Inferential-Statistics-and-Sampling"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../6-2-Probabilidad/Notebook%201.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Distribuciones de Probabilidad</p>
      </div>
    </a>
    <a class="right-next"
       href="../7-Exploratory-Data-Analysis-EDA/Notebook%201.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exploratory Data Analysis Basics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Inferential Statistics &amp; Sampling</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling">Sampling</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#database-to-work">Database to work</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#types-of-sampling">Types of sampling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-random-sampling">Simple random sampling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#systematic-sampling">Systematic sampling</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#samples-equally-distanced">Samples equally distanced</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stratified-sampling">Stratified sampling</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#proportional-stratified-sample">Proportional stratified sample</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#equal-count-stratified-sampling">Equal count stratified sampling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#weighted-random-sampling">Weighted random sampling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#proportional-stratified-sample-given-a-proportion">Proportional stratified sample (given a proportion)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-sampling">Cluster sampling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-calculate-mean-per-categories">Bonus: Calculate mean per categories</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relative-error">Relative error</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-relative-error">Calculate relative error</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relative-error-vs-sample-size">Relative error vs sample size</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distribution">Sampling distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#approximating-sampling-distributions">Approximating sampling distributions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapping">Bootstrapping</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concept">Concept</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#actually-bootstrapping">Actually Bootstrapping</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-statistics-to-estimate-population-parameters">Bootstrap statistics to estimate population parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mean">Mean</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-deviation">Standard Deviation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapping-vs-sampling-distribution-to-estimate-the-mean">Bootstrapping vs sampling distribution to estimate the mean</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-random-sample">simple random sample</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">sampling distribution</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-distribution">bootstrap distribution</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals">Confidence intervals</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantile-method-for-confidence-intervals">Quantile method for confidence intervals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-error-method-for-confidence-intervals">standard error method for confidence intervals</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hypotesis-testing">Hypotesis testing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Concept</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions">Assumptions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sanity-check">Sanity check</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-test-mean">Hypothesis test (mean)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-to-perform-hypothesis-testing">Steps to perform hypothesis testing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-null-hypothesis-and-alternative-hypothesis">1. Define the null hypothesis and alternative hypothesis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-z-score">2. Calculate the Z-score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-p-value">3. Calculate the P-value</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#finally-if-the-p-value-is-less-than-0-05-for-a-0-05-significance-level-you-can-reject-the-null-hypothesis-otherwise-you-fail-to-reject-the-null-hypothesis"><em><strong>Finally, if the p-value is less than 0.05 (for a 0.05 significance level), you can reject the null hypothesis. Otherwise, you fail to reject the null hypothesis</strong></em></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example1-two-tailed-test">Example1.  TWO TAILED TEST</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#context">context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-z-score">Calculating Z-score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-p-value">Calculating P-value</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example2-right-tailed-test">Example2. RIGHT TAILED TEST</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Calculating Z score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Calculating P-value</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-right-tailed-test">Example 3: RIGHT TAILED TEST</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Calculating Z score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Calculating P-value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confirming-the-results-with-a-confidence-interval">Confirming the results with a confidence interval</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-test-difference-of-means">Hypothesis test (difference of means)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-for-sample-size">Assumptions for sample size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-difference-of-means-right-tailed">Example 1. Difference of means (right tailed)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-t-statistic">Calculating T statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Calculating P value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-with-pengouin">Solving with pengouin</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-difference-of-means-left-tailed">Example 2. Difference of means (left tailed)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Calculating T statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Calculating P-value</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-testing-paired-data">Hypothesis testing (paired data)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Assumptions for sample size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-difference-of-means-left-tailed">Example 1. Difference of means (left tailed)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Calculating T statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Calculating P value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-with-pingouin">solving with pingouin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pingouin-variation-of-t-test-for-paired-data">pingouin variation of t-test for paired data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-difference-of-means-two-tailed">Example 2. Difference of means (two-tailed)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Solving with pingouin</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-test-anova">Hypothesis test (ANOVA)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Assumptions for sample size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-use-anova">When to use ANOVA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pingouin-anova-method">pingouin.anova() method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pairwise-tests">pairwise tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#false-positive-danger">false positive danger</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#p-value-adjustment-bonferroni">p -value adjustment (bonferroni)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-anova-three-categories">Example 2 ANOVA (three categories)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-sample-size-assumptions">Checking sample size assumptions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis-per-group">Exploratory Data Analysis per Group</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conducting-anova">Conducting ANOVA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Pairwise tests</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">P-value adjustment (bonferroni)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-test-tests-for-proportions">Hypothesis test (tests for proportions)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">Assumptions for sample size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-two-tailed-test">Example 1 (two-tailed test)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-z-score">Calculate z score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">Calculating p-value</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-right-tailed-test">Example 2 (right tailed test)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-for-sample-size-assumptions">Checking for sample size assumptions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">Calculating z-score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">Calculating p-value</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-test-tests-for-differences-of-proportions">Hypothesis test (tests for differences of proportions)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">Assumptions for sample size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-two-tailed">Example 1 (two-tailed)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">Context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-z-score">Calculating the Z score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">Calculating p-value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-with-statsmodels">Calculating with statsmodels</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-right-tailed">Example 2 (right tailed)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">Context</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">Calculating Z score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">Calculating p value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-with-statmodels">Calculating with statmodels</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-squared-tests-of-independance">Chi Squared Tests of independance</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id34">Assumptions for sample size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1">Example 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2">Example 2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3">Example 3</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-sample-size-assumption">Checking sample size assumption</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-variable-independance">Exploring variable independance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performing-chi-squared-test">Performing chi squared test</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-squared-goodness-of-fit-tests">Chi squared goodness of fit tests</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id35">Example 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id36">Example 2</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#non-parametric-tests">NON Parametric tests</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wilcoxon-signed-rank-test-paired-data">Wilcoxon-signed rank test  (Paired data)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wicoxon-test-process">Wicoxon test process</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pingouin-wilcoxon">pingouin.wilcoxon</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wilcoxon-mann-whitney-test-independent-data">Wilcoxon-Mann-Whitney test (Independent data)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kruskal-wallis-test">Kruskal-Wallis test</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>